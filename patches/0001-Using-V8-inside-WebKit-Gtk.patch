From 320eaa74a63fb329ea1b4a7a50a3f88f0a6232c7 Mon Sep 17 00:00:00 2001
From: Roger WANG <roger.wang@intel.com>
Date: Tue, 22 Nov 2011 13:46:54 +0800
Subject: [PATCH 1/3] Using V8 inside WebKit/Gtk

From the patch in:
https://bugs.webkit.org/show_bug.cgi?id=32452

with Roger's rework to make the patch smaller
---
 ChangeLog                                          |   16 +
 GNUmakefile.am                                     |   22 +-
 Source/JavaScriptCore/ChangeLog                    |   15 +
 Source/JavaScriptCore/GNUmakefile.v8.am            |  233 ++++
 Source/JavaScriptCore/config.h                     |    2 +
 Source/WebCore/ChangeLog                           |   65 +
 Source/WebCore/DerivedSources.make                 |   10 +
 Source/WebCore/GNUmakefile.am                      |   98 ++-
 Source/WebCore/GNUmakefile.list.am                 | 1363 +++++++++++++++++++-
 .../WebCore/accessibility/gtk/AXObjectCacheAtk.cpp |    2 +
 .../gtk/WebKitAccessibleHyperlink.cpp              |    1 +
 .../bindings/scripts/CodeGeneratorGObject.pm       |   12 +-
 .../WebCore/bindings/v8/ScriptCachedFrameData.cpp  |    4 +-
 Source/WebCore/bindings/v8/ScriptCachedFrameData.h |    2 +-
 Source/WebCore/bindings/v8/V8DOMWrapper.cpp        |   19 +-
 Source/WebCore/bindings/v8/V8GCController.cpp      |    2 +-
 Source/WebCore/bindings/v8/V8Proxy.cpp             |    5 +-
 .../bindings/v8/custom/V8DirectoryEntryCustom.cpp  |    3 +-
 .../v8/custom/V8DirectoryEntrySyncCustom.cpp       |    3 +-
 .../WebCore/bindings/v8/custom/V8EventCustom.cpp   |   10 +-
 .../v8/custom/V8HTMLAudioElementConstructor.cpp    |    5 +
 .../v8/custom/V8HTMLAudioElementConstructor.h      |    4 +
 .../v8/custom/V8InspectorFrontendHostCustom.cpp    |   10 +-
 .../bindings/v8/custom/V8ScriptProfileCustom.cpp   |    5 +
 .../v8/custom/V8ScriptProfileNodeCustom.cpp        |    4 +
 .../v8/custom/V8WebGLRenderingContextCustom.cpp    |    2 +
 .../bindings/v8/custom/V8XSLTProcessorCustom.cpp   |    5 +
 Source/WebCore/dom/CustomEvent.idl                 |    3 +-
 Source/WebCore/dom/ErrorEvent.idl                  |    3 +-
 Source/WebCore/dom/Event.idl                       |    1 -
 Source/WebCore/dom/HashChangeEvent.idl             |    3 +-
 Source/WebCore/dom/PageTransitionEvent.idl         |    3 +-
 Source/WebCore/dom/PopStateEvent.idl               |    3 +-
 Source/WebCore/dom/ProgressEvent.idl               |    3 +-
 Source/WebCore/dom/WebKitAnimationEvent.idl        |    3 +-
 Source/WebCore/editing/TextIterator.cpp            |    1 +
 Source/WebCore/editing/gtk/FrameSelectionGtk.cpp   |    1 +
 Source/WebCore/p2p/PeerConnection.cpp              |    2 +
 Source/WebCore/p2p/SignalingCallback.h             |    3 +
 .../graphics/opengl/GraphicsContext3DOpenGL.cpp    |    2 +
 Source/WebCore/platform/gtk/PlatformBridge.h       |  108 ++
 Source/WebCore/platform/gtk/PlatformBridgeGtk.cpp  |   51 +
 Source/WebCore/platform/gtk/PlatformSupport.h      |   38 +
 Source/WebCore/plugins/gtk/PluginViewGtk.cpp       |   18 +
 Source/WebCore/websockets/CloseEvent.idl           |    3 +-
 Source/WebCore/workers/WorkerMessagingProxy.cpp    |    8 +
 Source/WebKit/gtk/ChangeLog                        |   45 +
 Source/WebKit/gtk/GNUmakefile.am                   |   33 +-
 .../WebCoreSupport/DumpRenderTreeSupportGtk.cpp    |   36 +-
 .../gtk/WebCoreSupport/DumpRenderTreeSupportGtk.h  |   14 +-
 .../gtk/WebCoreSupport/FrameLoaderClientGtk.cpp    |   25 +-
 .../gtk/WebCoreSupport/FrameLoaderClientGtk.h      |    6 +
 Source/WebKit/gtk/tests/testatk.c                  |    2 +-
 Source/WebKit/gtk/tests/testcopyandpaste.c         |   10 +
 Source/WebKit/gtk/tests/testdomdomwindow.c         |    6 +-
 Source/WebKit/gtk/tests/testkeyevents.c            |    9 +
 Source/WebKit/gtk/webkit/webkitglobals.cpp         |    5 +
 .../WebKit/gtk/webkit/webkitviewportattributes.cpp |    1 +
 Source/WebKit/gtk/webkit/webkitwebframe.cpp        |   15 +-
 Source/WebKit/gtk/webkit/webkitwebframe.h          |    4 +
 Source/WebKit/gtk/webkit/webkitwebview.cpp         |    6 +
 Source/WebKit/gtk/webkit/webkitwebview.h           |    5 +
 Tools/ChangeLog                                    |   15 +
 Tools/GNUmakefile.am                               |   24 +-
 configure.ac                                       |  133 ++-
 65 files changed, 2431 insertions(+), 142 deletions(-)
 create mode 100644 Source/JavaScriptCore/GNUmakefile.v8.am
 create mode 100644 Source/WebCore/platform/gtk/PlatformBridge.h
 create mode 100644 Source/WebCore/platform/gtk/PlatformBridgeGtk.cpp
 create mode 100644 Source/WebCore/platform/gtk/PlatformSupport.h

diff --git a/ChangeLog b/ChangeLog
index d00a9e3..193efc9 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,19 @@
+2011-10-05  Rémi Duraffort  <remi.duraffort@st.com>
+
+        Port V8 to WebKit-GTK
+        https://bugs.webkit.org/show_bug.cgi?id=32452
+
+        This is first of the patches to support building of V8 with
+        WebKit GTK. With this patch configure option is provided to
+        choose to compile either enable or diable SFX.
+
+        This work is also copyrighted to Nayan Kumar Konaje <nayankk@motorola.com>
+
+        Reviewed by NOBODY (OOPS!).
+
+        * GNUmakefile.am:
+        * configure.ac:
+
 2011-10-04  Scott Graham  <scottmg@chromium.org>
 
         Add GAMEPAD feature flag
diff --git a/GNUmakefile.am b/GNUmakefile.am
index 2ce3e23..bf6dac0 100644
--- a/GNUmakefile.am
+++ b/GNUmakefile.am
@@ -192,13 +192,29 @@ global_cppflags += \
 	-DGCC_INSTRUMENT_PROGRAM_FLOW_ARCS
 endif
 
+if USE_JSC
+global_cppflags += \
+	-DWTF_USE_JSC=1
+endif
+
+if USE_V8
+global_cppflags += \
+	-DWTF_USE_V8=1
+endif
+
 EXTRA_DIST += \
 	$(srcdir)/Source/autotools/symbols.filter \
 	$(srcdir)/gtk-doc.make \
 	$(srcdir)/Source/WebKit/LICENSE
 
 # Include module makefiles
+if USE_JSC
 include Source/JavaScriptCore/GNUmakefile.am
+endif
+if USE_V8
+include Source/JavaScriptCore/GNUmakefile.v8.am
+endif
+
 include Source/WebCore/GNUmakefile.am
 include Source/WebKit/gtk/GNUmakefile.am
 include Source/WebCore/bindings/gobject/GNUmakefile.am
@@ -216,12 +232,12 @@ endif
 
 # Autogenerated sources
 BUILT_SOURCES += \
-	$(javascriptcore_built_sources) \
-	$(javascriptcore_built_nosources) \
 	$(webcore_built_sources) \
 	$(webcore_built_nosources) \
 	$(webkitgtk_built_sources) \
-	$(webkitgtk_built_nosources)
+	$(webkitgtk_built_nosources) \
+	$(javascriptcore_built_sources) \
+	$(javascriptcore_built_nosources)
 
 DISTCLEANFILES += \
 	$(CLEANFILES) \
diff --git a/Source/JavaScriptCore/ChangeLog b/Source/JavaScriptCore/ChangeLog
index ed94343..b80a143 100644
--- a/Source/JavaScriptCore/ChangeLog
+++ b/Source/JavaScriptCore/ChangeLog
@@ -1,3 +1,18 @@
+2011-10-05  Rémi Duraffort  <remi.duraffort@st.com>
+
+        Port V8 to WebKit-GTK
+        https://bugs.webkit.org/show_bug.cgi?id=32452
+
+        This is first of the patches to support building of V8 with
+        WebKit GTK. With this patch configure option is provided to
+        choose to compile either enable or diable SFX.
+
+        This work is also copyrighted to Nayan Kumar Konaje <nayankk@motorola.com>
+
+        Reviewed by NOBODY (OOPS!).
+
+        * config.h:
+
 2011-10-05  Patrick Gansterer  <paroga@webkit.org>
 
         Unreviewed WinCE build fix for r96595.
diff --git a/Source/JavaScriptCore/GNUmakefile.v8.am b/Source/JavaScriptCore/GNUmakefile.v8.am
new file mode 100644
index 0000000..79b9371
--- /dev/null
+++ b/Source/JavaScriptCore/GNUmakefile.v8.am
@@ -0,0 +1,233 @@
+javascriptcore_cppflags += \
+	-I$(srcdir)/Source \
+	-I$(srcdir)/Source/JavaScriptCore \
+	-I$(srcdir)/Source/JavaScriptCore/wtf \
+	-I$(srcdir)/Source/JavaScriptCore/wtf \
+	-I$(srcdir)/Source/JavaScriptCore/wtf/gobject \
+	-I$(srcdir)/Source/JavaScriptCore/wtf/gtk \
+	-I$(srcdir)/Source/JavaScriptCore/wtf/text \
+	-I$(srcdir)/Source/JavaScriptCore/wtf/unicode \
+	-I$(srcdir)/Source/JavaScriptCore/runtime \
+	-I$(top_builddir)/Source/JavaScriptCore
+
+javascriptcore_sources += \
+	Source/JavaScriptCore/wtf/Alignment.h \
+	Source/JavaScriptCore/wtf/AlwaysInline.h \
+	Source/JavaScriptCore/wtf/ASCIICType.h \
+	Source/JavaScriptCore/wtf/Assertions.cpp \
+	Source/JavaScriptCore/wtf/Assertions.h \
+	Source/JavaScriptCore/wtf/Atomics.h \
+	Source/JavaScriptCore/wtf/AVLTree.h \
+	Source/JavaScriptCore/wtf/Bitmap.h \
+	Source/JavaScriptCore/wtf/BlockStack.h \
+	Source/JavaScriptCore/wtf/BloomFilter.h \
+	Source/JavaScriptCore/wtf/BumpPointerAllocator.h \
+	Source/JavaScriptCore/wtf/ByteArray.cpp \
+	Source/JavaScriptCore/wtf/ByteArray.h \
+	Source/JavaScriptCore/wtf/CrossThreadRefCounted.h \
+	Source/JavaScriptCore/wtf/CryptographicallyRandomNumber.cpp \
+	Source/JavaScriptCore/wtf/CryptographicallyRandomNumber.h \
+	Source/JavaScriptCore/wtf/CurrentTime.cpp \
+	Source/JavaScriptCore/wtf/CurrentTime.h \
+	Source/JavaScriptCore/wtf/DateMath.cpp \
+	Source/JavaScriptCore/wtf/DateMath.h \
+	Source/JavaScriptCore/wtf/DecimalNumber.h \
+	Source/JavaScriptCore/wtf/DecimalNumber.cpp \
+	Source/JavaScriptCore/wtf/dtoa/bignum-dtoa.cc \
+	Source/JavaScriptCore/wtf/dtoa/bignum.cc \
+	Source/JavaScriptCore/wtf/dtoa/cached-powers.cc \
+	Source/JavaScriptCore/wtf/dtoa/diy-fp.cc \
+	Source/JavaScriptCore/wtf/dtoa/double-conversion.cc \
+	Source/JavaScriptCore/wtf/dtoa/fast-dtoa.cc \
+	Source/JavaScriptCore/wtf/dtoa/fixed-dtoa.cc \
+	Source/JavaScriptCore/wtf/dtoa/strtod.cc \
+	Source/JavaScriptCore/wtf/dtoa/bignum-dtoa.h \
+	Source/JavaScriptCore/wtf/dtoa/bignum.h \
+	Source/JavaScriptCore/wtf/dtoa/cached-powers.h \
+	Source/JavaScriptCore/wtf/dtoa/diy-fp.h \
+	Source/JavaScriptCore/wtf/dtoa/double-conversion.h \
+	Source/JavaScriptCore/wtf/dtoa/double.h \
+	Source/JavaScriptCore/wtf/dtoa/fast-dtoa.h \
+	Source/JavaScriptCore/wtf/dtoa/fixed-dtoa.h \
+	Source/JavaScriptCore/wtf/dtoa/strtod.h \
+	Source/JavaScriptCore/wtf/dtoa/utils.h \
+	Source/JavaScriptCore/wtf/Decoder.h \
+	Source/JavaScriptCore/wtf/Deque.h \
+	Source/JavaScriptCore/wtf/DisallowCType.h \
+	Source/JavaScriptCore/wtf/DoublyLinkedList.h \
+	Source/JavaScriptCore/wtf/dtoa.cpp \
+	Source/JavaScriptCore/wtf/dtoa.h \
+	Source/JavaScriptCore/wtf/DynamicAnnotations.cpp \
+	Source/JavaScriptCore/wtf/DynamicAnnotations.h \
+	Source/JavaScriptCore/wtf/Encoder.h \
+	Source/JavaScriptCore/wtf/FastAllocBase.h \
+	Source/JavaScriptCore/wtf/FastMalloc.cpp \
+	Source/JavaScriptCore/wtf/FastMalloc.h \
+	Source/JavaScriptCore/wtf/FixedArray.h \
+	Source/JavaScriptCore/wtf/Forward.h \
+	Source/JavaScriptCore/wtf/GetPtr.h \
+	Source/JavaScriptCore/wtf/gobject/GOwnPtr.cpp \
+	Source/JavaScriptCore/wtf/gobject/GOwnPtr.h \
+	Source/JavaScriptCore/wtf/gobject/GRefPtr.cpp \
+	Source/JavaScriptCore/wtf/gobject/GRefPtr.h \
+	Source/JavaScriptCore/wtf/gobject/GTypedefs.h \
+	Source/JavaScriptCore/wtf/gtk/MainThreadGtk.cpp \
+	Source/JavaScriptCore/wtf/gtk/ThreadingGtk.cpp \
+	Source/JavaScriptCore/wtf/HashCountedSet.h \
+	Source/JavaScriptCore/wtf/HashFunctions.h \
+	Source/JavaScriptCore/wtf/HashIterators.h \
+	Source/JavaScriptCore/wtf/HashMap.h \
+	Source/JavaScriptCore/wtf/HashSet.h \
+	Source/JavaScriptCore/wtf/HashTable.cpp \
+	Source/JavaScriptCore/wtf/HashTable.h \
+	Source/JavaScriptCore/wtf/HashTraits.h \
+	Source/JavaScriptCore/wtf/HexNumber.h \
+	Source/JavaScriptCore/wtf/ListHashSet.h \
+	Source/JavaScriptCore/wtf/ListRefPtr.h \
+	Source/JavaScriptCore/wtf/Locker.h \
+	Source/JavaScriptCore/wtf/MainThread.cpp \
+	Source/JavaScriptCore/wtf/MainThread.h \
+	Source/JavaScriptCore/wtf/MallocZoneSupport.h \
+	Source/JavaScriptCore/wtf/MathExtras.h \
+	Source/JavaScriptCore/wtf/MD5.cpp \
+	Source/JavaScriptCore/wtf/MD5.h \
+	Source/JavaScriptCore/wtf/MessageQueue.h \
+	Source/JavaScriptCore/wtf/NonCopyingSort.h \
+	Source/JavaScriptCore/wtf/Noncopyable.h \
+	Source/JavaScriptCore/wtf/NotFound.h \
+	Source/JavaScriptCore/wtf/NullPtr.h \
+	Source/JavaScriptCore/wtf/OSAllocator.h \
+	Source/JavaScriptCore/wtf/OSRandomSource.cpp \
+	Source/JavaScriptCore/wtf/OSRandomSource.h \
+	Source/JavaScriptCore/wtf/OwnArrayPtr.h \
+	Source/JavaScriptCore/wtf/OwnFastMallocPtr.h \
+	Source/JavaScriptCore/wtf/OwnPtrCommon.h \
+	Source/JavaScriptCore/wtf/OwnPtr.h \
+	Source/JavaScriptCore/wtf/PageAllocation.h \
+	Source/JavaScriptCore/wtf/PageAllocationAligned.cpp \
+	Source/JavaScriptCore/wtf/PageAllocationAligned.h \
+	Source/JavaScriptCore/wtf/PageReservation.h \
+	Source/JavaScriptCore/wtf/PageBlock.cpp \
+	Source/JavaScriptCore/wtf/PageBlock.h \
+	Source/JavaScriptCore/wtf/PassOwnArrayPtr.h \
+	Source/JavaScriptCore/wtf/PassOwnPtr.h \
+	Source/JavaScriptCore/wtf/PassRefPtr.h \
+	Source/JavaScriptCore/wtf/PassTraits.h \
+	Source/JavaScriptCore/wtf/ParallelJobs.h \
+	Source/JavaScriptCore/wtf/ParallelJobsGeneric.cpp \
+	Source/JavaScriptCore/wtf/ParallelJobsGeneric.h \
+	Source/JavaScriptCore/wtf/ParallelJobsLibdispatch.h \
+	Source/JavaScriptCore/wtf/ParallelJobsOpenMP.h \
+	Source/JavaScriptCore/wtf/Platform.h \
+	Source/JavaScriptCore/wtf/PossiblyNull.h \
+	Source/JavaScriptCore/wtf/RandomNumber.cpp \
+	Source/JavaScriptCore/wtf/RandomNumber.h \
+	Source/JavaScriptCore/wtf/RandomNumberSeed.h \
+	Source/JavaScriptCore/wtf/RefCounted.h \
+	Source/JavaScriptCore/wtf/RefCountedLeakCounter.cpp \
+	Source/JavaScriptCore/wtf/RefCountedLeakCounter.h \
+	Source/JavaScriptCore/wtf/RefPtr.h \
+	Source/JavaScriptCore/wtf/RefPtrHashMap.h \
+	Source/JavaScriptCore/wtf/RetainPtr.h \
+	Source/JavaScriptCore/wtf/SegmentedVector.h \
+	Source/JavaScriptCore/wtf/SentinelLinkedList.h \
+	Source/JavaScriptCore/wtf/SHA1.cpp \
+	Source/JavaScriptCore/wtf/SHA1.h \
+	Source/JavaScriptCore/wtf/SinglyLinkedList.h \
+	Source/JavaScriptCore/wtf/StackBounds.cpp \
+	Source/JavaScriptCore/wtf/StackBounds.h \
+	Source/JavaScriptCore/wtf/StaticConstructors.h \
+	Source/JavaScriptCore/wtf/StdLibExtras.h \
+	Source/JavaScriptCore/wtf/StringExtras.h \
+	Source/JavaScriptCore/wtf/StringHasher.h \
+	Source/JavaScriptCore/wtf/TCPackedCache.h \
+	Source/JavaScriptCore/wtf/TCPageMap.h \
+	Source/JavaScriptCore/wtf/TCSpinLock.h \
+	Source/JavaScriptCore/wtf/TCSystemAlloc.cpp \
+	Source/JavaScriptCore/wtf/TCSystemAlloc.h \
+	Source/JavaScriptCore/wtf/text/AtomicString.cpp \
+	Source/JavaScriptCore/wtf/text/AtomicString.h \
+	Source/JavaScriptCore/wtf/text/AtomicStringHash.h \
+	Source/JavaScriptCore/wtf/text/AtomicStringImpl.h \
+	Source/JavaScriptCore/wtf/text/CString.cpp \
+	Source/JavaScriptCore/wtf/text/CString.h \
+	Source/JavaScriptCore/wtf/text/StringBuffer.h \
+	Source/JavaScriptCore/wtf/text/StringBuilder.cpp \
+	Source/JavaScriptCore/wtf/text/StringBuilder.h \
+	Source/JavaScriptCore/wtf/text/StringConcatenate.h \
+	Source/JavaScriptCore/wtf/text/StringHash.h \
+	Source/JavaScriptCore/wtf/text/StringImplBase.h \
+	Source/JavaScriptCore/wtf/text/StringImpl.cpp \
+	Source/JavaScriptCore/wtf/text/StringImpl.h \
+	Source/JavaScriptCore/wtf/text/StringOperators.h \
+	Source/JavaScriptCore/wtf/text/StringStatics.cpp \
+	Source/JavaScriptCore/wtf/text/TextPosition.h \
+	Source/JavaScriptCore/wtf/text/WTFString.cpp \
+	Source/JavaScriptCore/wtf/text/WTFString.h \
+	Source/JavaScriptCore/wtf/ThreadIdentifierDataPthreads.cpp \
+	Source/JavaScriptCore/wtf/ThreadIdentifierDataPthreads.h \
+	Source/JavaScriptCore/wtf/Threading.cpp \
+	Source/JavaScriptCore/wtf/Threading.h \
+	Source/JavaScriptCore/wtf/ThreadingPrimitives.h \
+	Source/JavaScriptCore/wtf/ThreadingPthreads.cpp \
+	Source/JavaScriptCore/wtf/ThreadSafeRefCounted.h \
+	Source/JavaScriptCore/wtf/ThreadSpecific.h \
+	Source/JavaScriptCore/wtf/TypeTraits.cpp \
+	Source/JavaScriptCore/wtf/TypeTraits.h \
+	Source/JavaScriptCore/wtf/unicode/CharacterNames.h \
+	Source/JavaScriptCore/wtf/unicode/CollatorDefault.cpp \
+	Source/JavaScriptCore/wtf/unicode/Collator.h \
+	Source/JavaScriptCore/wtf/unicode/Unicode.h \
+	Source/JavaScriptCore/wtf/unicode/UTF8.cpp \
+	Source/JavaScriptCore/wtf/unicode/UTF8.h \
+	Source/JavaScriptCore/wtf/UnusedParam.h \
+	Source/JavaScriptCore/wtf/ValueCheck.h \
+	Source/JavaScriptCore/wtf/Vector.h \
+	Source/JavaScriptCore/wtf/VectorTraits.h \
+	Source/JavaScriptCore/wtf/VMTags.h \
+	Source/JavaScriptCore/wtf/WTFThreadData.cpp \
+	Source/JavaScriptCore/wtf/WTFThreadData.h \
+	Source/JavaScriptCore/yarr/YarrInterpreter.cpp \
+	Source/JavaScriptCore/yarr/YarrInterpreter.h \
+	Source/JavaScriptCore/yarr/YarrParser.h \
+	Source/JavaScriptCore/yarr/YarrPattern.cpp \
+	Source/JavaScriptCore/yarr/YarrPattern.h \
+	Source/JavaScriptCore/yarr/YarrSyntaxChecker.cpp \
+	Source/JavaScriptCore/yarr/YarrSyntaxChecker.h
+
+javascriptcore_built_nosources += \
+	Source/JavaScriptCore/RegExpJitTables.h
+
+if TARGET_WIN32
+javascriptcore_sources += \
+	Source/JavaScriptCore/wtf/OSAllocatorWin.cpp
+else
+javascriptcore_sources += \
+	Source/JavaScriptCore/jit/ExecutableAllocatorFixedVMPool.cpp \
+	Source/JavaScriptCore/wtf/OSAllocatorPosix.cpp
+endif
+
+# ----
+# icu unicode backend
+# ----
+if USE_ICU_UNICODE
+javascriptcore_sources += \
+	Source/JavaScriptCore/wtf/unicode/icu/CollatorICU.cpp \
+	Source/JavaScriptCore/wtf/unicode/icu/UnicodeIcu.h
+endif # USE_ICU_UNICODE
+
+# ----
+# glib unicode backend
+# ----
+if USE_GLIB_UNICODE
+javascriptcore_sources += \
+	Source/JavaScriptCore/wtf/unicode/UnicodeMacrosFromICU.h \
+	Source/JavaScriptCore/wtf/unicode/gliUnicodeGLib.h \
+	Source/JavaScriptCore/wtf/unicode/gliUnicodeGLib.cpp
+endif # USE_GLIB_UNICODE
+
+Source/JavaScriptCore/RegExpJitTables.h: $(srcdir)/Source/JavaScriptCore/create_regex_tables
+	$(AM_V_GEN)$(PYTHON) $^ > $@
+
+CLEANFILES += \
+	Source/JavaScriptCore/RegExpJitTables.h 
diff --git a/Source/JavaScriptCore/config.h b/Source/JavaScriptCore/config.h
index 8536ccc..7d70c69 100644
--- a/Source/JavaScriptCore/config.h
+++ b/Source/JavaScriptCore/config.h
@@ -131,4 +131,6 @@
 #endif /* !defined(WTF_USE_V8) */
 
 /* Using V8 implies not using JSC and vice versa */
+#ifndef WTF_USE_JSC
 #define WTF_USE_JSC !WTF_USE_V8
+#endif
diff --git a/Source/WebCore/ChangeLog b/Source/WebCore/ChangeLog
index 289bc49..5c4b5b0 100644
--- a/Source/WebCore/ChangeLog
+++ b/Source/WebCore/ChangeLog
@@ -1,3 +1,68 @@
+2011-10-05  Rémi Duraffort  <remi.duraffort@st.com>
+
+        Port V8 to WebKit-GTK
+        https://bugs.webkit.org/show_bug.cgi?id=32452
+
+        This is first of the patches to support building of V8 with
+        WebKit GTK. With this patch configure option is provided to
+        choose to compile either enable or diable SFX.
+
+        This work is also copyrighted to Nayan Kumar Konaje <nayankk@motorola.com>
+
+        Reviewed by NOBODY (OOPS!).
+
+        * DerivedSources.make:
+        * GNUmakefile.am:
+        * GNUmakefile.list.am:
+        * accessibility/gtk/AXObjectCacheAtk.cpp:
+        * accessibility/gtk/WebKitAccessibleHyperlink.cpp:
+        * bindings/scripts/CodeGeneratorGObject.pm:
+        ():
+        * bindings/v8/ScriptCachedFrameData.cpp:
+        * bindings/v8/ScriptCachedFrameData.h:
+        * bindings/v8/V8DOMWrapper.cpp:
+        * bindings/v8/V8GCController.cpp:
+        (WebCore::V8GCController::checkMemoryUsage):
+        * bindings/v8/V8Proxy.cpp:
+        * bindings/v8/custom/V8DirectoryEntryCustom.cpp:
+        * bindings/v8/custom/V8DirectoryEntrySyncCustom.cpp:
+        * bindings/v8/custom/V8EventCustom.cpp:
+        * bindings/v8/custom/V8HTMLAudioElementConstructor.cpp:
+        * bindings/v8/custom/V8HTMLAudioElementConstructor.h:
+        * bindings/v8/custom/V8InspectorFrontendHostCustom.cpp:
+        (WebCore::V8InspectorFrontendHost::recordActionTakenCallback):
+        (WebCore::V8InspectorFrontendHost::recordPanelShownCallback):
+        (WebCore::V8InspectorFrontendHost::recordSettingChangedCallback):
+        * bindings/v8/custom/V8ScriptProfileCustom.cpp:
+        * bindings/v8/custom/V8ScriptProfileNodeCustom.cpp:
+        * bindings/v8/custom/V8WebGLRenderingContextCustom.cpp:
+        * bindings/v8/custom/V8XSLTProcessorCustom.cpp:
+        * dom/CustomEvent.idl:
+        * dom/ErrorEvent.idl:
+        * dom/Event.idl:
+        * dom/HashChangeEvent.idl:
+        * dom/PageTransitionEvent.idl:
+        * dom/PopStateEvent.idl:
+        * dom/ProgressEvent.idl:
+        * dom/WebKitAnimationEvent.idl:
+        * editing/TextIterator.cpp:
+        * editing/gtk/FrameSelectionGtk.cpp:
+        * p2p/PeerConnection.cpp:
+        * p2p/SignalingCallback.h:
+        * platform/graphics/gstreamer/MediaPlayerPrivateGStreamer.cpp:
+        * platform/graphics/opengl/GraphicsContext3DOpenGL.cpp:
+        * plugins/gtk/PluginViewGtk.cpp:
+        (WebCore::PluginView::dispatchNPEvent):
+        (WebCore::PluginView::handleKeyboardEvent):
+        (WebCore::PluginView::handleMouseEvent):
+        (WebCore::PluginView::setNPWindowIfNeeded):
+        (WebCore::PluginView::platformStart):
+        * websockets/CloseEvent.idl:
+        * workers/WorkerMessagingProxy.cpp:
+        (WebCore::WorkerMessagingProxy::connectToInspector):
+        (WebCore::WorkerMessagingProxy::disconnectFromInspector):
+        (WebCore::WorkerMessagingProxy::sendMessageToInspector):
+
 2011-10-05  Pavel Feldman  <pfeldman@chromium.org>
 
         Web Inspector: add CSS model classes to the compilation.
diff --git a/Source/WebCore/DerivedSources.make b/Source/WebCore/DerivedSources.make
index 09d0703..d51c76e 100644
--- a/Source/WebCore/DerivedSources.make
+++ b/Source/WebCore/DerivedSources.make
@@ -690,6 +690,16 @@ XMLViewerJS.h : xml/XMLViewer.js
 
 # --------
 
+# V8 array buffer view
+
+
+all : V8ArrayBufferViewCustomScript.h
+
+V8ArrayBufferViewCustomScript.h: bindings/v8/custom/V8ArrayBufferViewCustomScript.js
+	perl $(WebCore)/inspector/xxd.pl V8ArrayBufferViewCustomScript_js $(WebCore)/bindings/v8/custom/V8ArrayBufferViewCustomScript.js V8ArrayBufferViewCustomScript.h
+
+# --------
+
 # HTML entity names
 
 HTMLEntityTable.cpp : html/parser/HTMLEntityNames.in $(WebCore)/html/parser/create-html-entity-table
diff --git a/Source/WebCore/GNUmakefile.am b/Source/WebCore/GNUmakefile.am
index 1444b4e..ac6dedd 100644
--- a/Source/WebCore/GNUmakefile.am
+++ b/Source/WebCore/GNUmakefile.am
@@ -2,6 +2,7 @@ include $(srcdir)/Source/WebCore/GNUmakefile.list.am
 
 SVG_FEATURES :=
 HTML_FEATURES :=
+WRAPPER_FACTORY :=
 
 WEBCORE_CSS_PROPERTY_NAMES := $(WebCore)/css/CSSPropertyNames.in
 WEBCORE_CSS_VALUE_KEYWORDS := $(WebCore)/css/CSSValueKeywords.in
@@ -13,13 +14,25 @@ webcore_cppflags += \
 	-I$(srcdir)/Source/WebCore \
 	-I$(srcdir)/Source/WebCore/accessibility \
 	-I$(srcdir)/Source/WebCore/bindings \
-	-I$(srcdir)/Source/WebCore/bindings/generic \
+	-I$(srcdir)/Source/WebCore/bindings/generic
+
+if USE_JSC
+webcore_cppflags += \
 	-I$(srcdir)/Source/WebCore/bindings/js \
-	-I$(srcdir)/Source/WebCore/bindings/js/specialization \
+	-I$(srcdir)/Source/WebCore/bindings/js/specialization
+endif # END USE_JSC
+
+webcore_cppflags += \
 	-I$(srcdir)/Source/WebCore/bridge \
-	-I$(srcdir)/Source/WebCore/bridge/c \
+	-I$(srcdir)/Source/WebCore/bridge/c
+
+if USE_JSC
+webcore_cppflags += \
 	-I$(srcdir)/Source/WebCore/bridge/jni/jsc \
-	-I$(srcdir)/Source/WebCore/bridge/jsc \
+	-I$(srcdir)/Source/WebCore/bridge/jsc
+endif # END USE_JSC
+
+webcore_cppflags += \
 	-I$(srcdir)/Source/WebCore/css \
 	-I$(srcdir)/Source/WebCore/dom \
 	-I$(srcdir)/Source/WebCore/dom/default \
@@ -84,13 +97,27 @@ webcore_cppflags += \
 	-I$(srcdir)/Source/WebCore/websockets \
 	-I$(srcdir)/Source/WebCore/workers \
 	-I$(srcdir)/Source/WebCore/xml \
-	-I$(srcdir)/Source/WebCore/xml/parser \
-	-I$(top_builddir)/WebCore/bindings/js \
+	-I$(srcdir)/Source/WebCore/xml/parser
+
+if USE_JSC
+webcore_cppflags += \
+	-I$(top_builddir)/WebCore/bindings/js
+endif # END USE_JSC
+
+webcore_cppflags += \
 	-I$(top_builddir)/DerivedSources/WebCore \
 	-I$(top_builddir)/DerivedSources \
 	-I$(top_builddir)/DerivedSources/JavaScriptCore \
 	-DDATA_DIR=\"${datadir}\"
 
+if USE_V8
+webcore_cppflags += \
+	-I$(srcdir)/Source/WebCore/bindings/v8 \
+	-I$(srcdir)/Source/WebCore/bindings/v8/specialization \
+	-I$(srcdir)/Source/WebCore/bindings/v8/custom \
+	$(V8_CPPFLAGS)
+endif # END USE_V8
+
 webcoregtk_cppflags += \
 	-DWEBKITGTK_API_VERSION_STRING=\"@WEBKITGTK_API_VERSION@\" \
 	-DWTF_USE_SOUP=1 \
@@ -165,12 +192,16 @@ endif # END ENABLE_PROGRESS_TAG
 # ----
 # JavaScript Debugger/Profiler
 # ----
+if USE_JSC
 if ENABLE_JAVASCRIPT_DEBUGGER
 FEATURE_DEFINES += ENABLE_JAVASCRIPT_DEBUGGER=1
 webcore_cppflags += -DENABLE_JAVASCRIPT_DEBUGGER=1
 else
 webcore_cppflags += -DENABLE_JAVASCRIPT_DEBUGGER=0
 endif # END ENABLE_JAVASCRIPT_DEBUGGER
+else
+webcore_cppflags += -DENABLE_JAVASCRIPT_DEBUGGER=0
+endif # END USE_JSC
 
 # ----
 # Gamepad support
@@ -458,6 +489,16 @@ webcore_cppflags += -DENABLE_GEOLOCATION=1
 endif # END ENABLE_GEOLOCATION
 
 # ----
+# JSC or V8
+# ----
+if USE_JSC
+WRAPPER_FACTORY += --wrapperFactory
+endif # END USE_JSC
+if USE_V8
+WRAPPER_FACTORY += --wrapperFactoryV8
+endif # END USE_V8
+
+# ----
 # MathML support
 # ----
 if ENABLE_MATHML
@@ -469,7 +510,7 @@ endif # END ENABLE_MATHML
 DerivedSources/WebCore/MathMLElementFactory.h: DerivedSources/WebCore/MathMLElementFactory.cpp
 DerivedSources/WebCore/MathMLNames.h: DerivedSources/WebCore/MathMLNames.cpp
 DerivedSources/WebCore/MathMLElementFactory.cpp DerivedSources/WebCore/MathMLNames.cpp: $(WebCore)/dom/make_names.pl $(WebCore)/mathml/mathtags.in $(WebCore)/mathml/mathattrs.in
-	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/mathml/mathtags.in --attrs $(WebCore)/mathml/mathattrs.in --factory --wrapperFactory --outputDir "$(GENSOURCES_WEBCORE)"
+	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/mathml/mathtags.in --attrs $(WebCore)/mathml/mathattrs.in --factory $(WRAPPER_FACTORY) --outputDir "$(GENSOURCES_WEBCORE)"
 
 # ----
 # Notifications support
@@ -505,10 +546,10 @@ DerivedSources/WebCore/JSSVGElementWrapperFactory.cpp: DerivedSources/WebCore/SV
 
 if SVG_FLAGS
 DerivedSources/WebCore/SVGElementFactory.cpp: $(WebCore)/dom/make_names.pl $(WebCore)/svg/svgtags.in $(WebCore)/svg/svgattrs.in
-	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/svg/svgtags.in --attrs $(WebCore)/svg/svgattrs.in --extraDefines "$(SVG_FEATURES)" --factory --wrapperFactory --outputDir "$(GENSOURCES_WEBCORE)"
+	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/svg/svgtags.in --attrs $(WebCore)/svg/svgattrs.in --extraDefines "$(SVG_FEATURES)" --factory $(WRAPPER_FACTORY) --outputDir "$(GENSOURCES_WEBCORE)"
 else
 DerivedSources/WebCore/SVGElementFactory.cpp: $(WebCore)/dom/make_names.pl $(WebCore)/svg/svgtags.in $(WebCore)/svg/svgattrs.in
-	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/svg/svgtags.in --attrs $(WebCore)/svg/svgattrs.in --factory --wrapperFactory --outputDir "$(GENSOURCES_WEBCORE)"
+	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/svg/svgtags.in --attrs $(WebCore)/svg/svgattrs.in --factory $(WRAPPER_FACTORY) --outputDir "$(GENSOURCES_WEBCORE)"
 endif # SVG_FLAGS
 
 # end SVG Features
@@ -620,6 +661,10 @@ DerivedSources/WebCore/XMLViewerCSS.h: $(WebCore)/xml/XMLViewer.css
 DerivedSources/WebCore/XMLViewerJS.h: $(WebCore)/xml/XMLViewer.js
 	$(PERL) $(WebCore)/inspector/xxd.pl XMLViewer_js $(WebCore)/xml/XMLViewer.js $(GENSOURCES_WEBCORE)/XMLViewerJS.h
 
+# V8 array buffer view
+DerivedSources/WebCore/V8ArrayBufferViewCustomScript.h: $(WebCore)/bindings/v8/custom/V8ArrayBufferViewCustomScript.js
+	$(PERL) $(WebCore)/inspector/xxd.pl V8ArrayBufferViewCustomScript_js $(WebCore)/bindings/v8/custom/V8ArrayBufferViewCustomScript.js $(GENSOURCES_WEBCORE)/V8ArrayBufferViewCustomScript.h
+
 # HTML entity names
 DerivedSources/WebCore/HTMLEntityTable.cpp: $(WebCore)/html/parser/HTMLEntityNames.in $(WebCore)/html/parser/create-html-entity-table
 	$(PYTHON) $(WebCore)/html/parser/create-html-entity-table -o $(GENSOURCES_WEBCORE)/HTMLEntityTable.cpp $(WebCore)/html/parser/HTMLEntityNames.in
@@ -677,16 +722,22 @@ DerivedSources/WebCore/WebKitFontFamilyNames.h: $(WebCore)/dom/make_names.pl $(W
 
 
 # HTML tag and attribute names
+if USE_JSC
 DerivedSources/WebCore/JSHTMLElementWrapperFactory.cpp: DerivedSources/WebCore/HTMLElementFactory.cpp
+endif # END USE_JSC
+if USE_V8
+DerivedSources/WebCore/V8SVGElementWrapperFactory.cpp: DerivedSources/WebCore/SVGElementFactory.cpp
+endif # END USE_V8
+
 DerivedSources/WebCore/HTMLElementFactory.cpp: DerivedSources/WebCore/HTMLElementFactory.h
 DerivedSources/WebCore/HTMLElementFactory.h: DerivedSources/WebCore/HTMLNames.cpp
 DerivedSources/WebCore/HTMLNames.cpp: DerivedSources/WebCore/HTMLNames.h
 if HTML_FLAGS
 DerivedSources/WebCore/HTMLNames.h: $(WebCore)/dom/make_names.pl $(WebCore)/html/HTMLTagNames.in $(WebCore)/html/HTMLAttributeNames.in
-	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/html/HTMLTagNames.in --attrs $(WebCore)/html/HTMLAttributeNames.in --extraDefines "$(HTML_FEATURES)" --factory --wrapperFactory --outputDir "$(GENSOURCES_WEBCORE)"
+	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/html/HTMLTagNames.in --attrs $(WebCore)/html/HTMLAttributeNames.in --extraDefines "$(HTML_FEATURES)" --factory $(WRAPPER_FACTORY) --outputDir "$(GENSOURCES_WEBCORE)"
 else
 DerivedSources/WebCore/HTMLNames.h: $(WebCore)/dom/make_names.pl $(WebCore)/html/HTMLTagNames.in $(WebCore)/html/HTMLAttributeNames.in
-	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/html/HTMLTagNames.in --attrs $(WebCore)/html/HTMLAttributeNames.in --factory --wrapperFactory --outputDir "$(GENSOURCES_WEBCORE)"
+	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --tags $(WebCore)/html/HTMLTagNames.in --attrs $(WebCore)/html/HTMLAttributeNames.in --factory $(WRAPPER_FACTORY) --outputDir "$(GENSOURCES_WEBCORE)"
 endif # HTML_FLAGS
 
 
@@ -696,6 +747,10 @@ DerivedSources/WebCore/XMLNSNames.cpp DerivedSources/WebCore/XMLNSNames.h: $(Web
 DerivedSources/WebCore/XMLNames.cpp DerivedSources/WebCore/XMLNames.h: $(WebCore)/dom/make_names.pl $(WebCore)/xml/xmlattrs.in
 	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $< --attrs $(WebCore)/xml/xmlattrs.in --outputDir "$(GENSOURCES_WEBCORE)"
 
+if USE_V8
+FEATURE_DEFINES += V8_BINDING=1
+endif
+
 # All Web Inspector generated files are created with this one call to CodeGeneratorInspector.pm
 DerivedSources/WebCore/InspectorProtocolVersion.h : $(WebCore)/inspector/Inspector.json $(WebCore)/inspector/generate-inspector-protocol-version
 	$(PYTHON) $(WebCore)/inspector/generate-inspector-protocol-version -o $(GENSOURCES_WEBCORE)/InspectorProtocolVersion.h $(WebCore)/inspector/Inspector.json
@@ -745,11 +800,21 @@ vpath %.idl $(IDL_PATH)
 
 # This does not appear to work correctly with gnumake unless
 # it includes an empty command list (the semicolon).
+if USE_JSC
 DerivedSources/WebCore/JS%.cpp: DerivedSources/WebCore/JS%.h;
 
 .SECONDARY:
 DerivedSources/WebCore/JS%.h: %.idl $(SCRIPTS_BINDINGS) $(WebCore)/bindings/scripts/CodeGeneratorJS.pm
 	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $(WebCore)/bindings/scripts/generate-bindings.pl $(IDL_PATH:%=--include "%") --outputDir "$(GENSOURCES_WEBCORE)" --defines "LANGUAGE_JAVASCRIPT=1 $(FEATURE_DEFINES)" --generator JS $<
+endif # END USE_JSC
+
+if USE_V8
+DerivedSources/WebCore/V8%.cpp: DerivedSources/WebCore/V8%.h;
+
+.SECONDARY:
+DerivedSources/WebCore/V8%.h: %.idl $(SCRIPTS_BINDINGS) $(WebCore)/bindings/scripts/CodeGeneratorV8.pm
+	$(AM_V_GEN)$(PERL) -I$(WebCore)/bindings/scripts $(WebCore)/bindings/scripts/generate-bindings.pl $(IDL_PATH:%=--include "%") --outputDir "$(GENSOURCES_WEBCORE)" --defines "LANGUAGE_JAVASCRIPT=1 $(FEATURE_DEFINES)" --generator V8 $<
+endif # END USE_V8
 
 noinst_LTLIBRARIES += \
 	libWebCore.la
@@ -863,7 +928,6 @@ EXTRA_DIST += \
 	Source/WebCore/bindings/scripts/generate-bindings.pl \
 	Source/WebCore/bindings/scripts/preprocessor.pm \
 	Source/WebCore/bindings/scripts/CodeGeneratorGObject.pm \
-	Source/WebCore/bindings/scripts/CodeGeneratorJS.pm \
 	Source/WebCore/bindings/scripts/CodeGenerator.pm \
 	Source/WebCore/bindings/scripts/generate-bindings.pl \
 	Source/WebCore/bindings/scripts/gobject-generate-headers.pl \
@@ -922,6 +986,16 @@ EXTRA_DIST += \
 	Source/WebCore/xml/XMLViewer.js \
 	Source/WebCore/xml/XPathGrammar.y
 
+if USE_JSC
+EXTRA_DIST += \
+	Source/WebCore/bindings/scripts/CodeGeneratorJS.pm
+endif # END USE_JSC
+
+if USE_V8
+EXTRA_DIST += \
+	Source/WebCore/bindings/scripts/CodeGeneratorV8.pm
+endif # END USE_V8
+
 # Installing web inspector files
 webinspectordir = ${datadir}/webkitgtk-@WEBKITGTK_API_VERSION@/webinspector
 dist_webinspector_DATA = \
diff --git a/Source/WebCore/GNUmakefile.list.am b/Source/WebCore/GNUmakefile.list.am
index 572affe..1d73119 100644
--- a/Source/WebCore/GNUmakefile.list.am
+++ b/Source/WebCore/GNUmakefile.list.am
@@ -19,7 +19,9 @@ webcore_built_sources += \
 	DerivedSources/WebCore/InspectorBackendDispatcher.h \
 	DerivedSources/WebCore/InspectorFrontend.cpp \
 	DerivedSources/WebCore/InspectorFrontend.h \
-	DerivedSources/WebCore/InspectorProtocolVersion.h \
+	DerivedSources/WebCore/InspectorProtocolVersion.h
+if USE_JSC
+webcore_built_sources += \
 	DerivedSources/WebCore/JSAbstractWorker.cpp \
 	DerivedSources/WebCore/JSAbstractWorker.h \
 	DerivedSources/WebCore/JSArrayBuffer.cpp \
@@ -574,7 +576,9 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSXMLSerializer.cpp \
 	DerivedSources/WebCore/JSXMLSerializer.h \
 	DerivedSources/WebCore/JSXSLTProcessor.cpp \
-	DerivedSources/WebCore/JSXSLTProcessor.h \
+	DerivedSources/WebCore/JSXSLTProcessor.h
+endif
+webcore_built_sources += \
 	DerivedSources/WebCore/MathMLElementFactory.cpp \
 	DerivedSources/WebCore/MathMLElementFactory.h \
 	DerivedSources/WebCore/MathMLNames.cpp \
@@ -648,7 +652,9 @@ webcore_sources += \
 	Source/WebCore/bindings/generic/EventConstructors.h \
 	Source/WebCore/bindings/generic/GenericBinding.h \
 	Source/WebCore/bindings/generic/RuntimeEnabledFeatures.cpp \
-	Source/WebCore/bindings/generic/RuntimeEnabledFeatures.h \
+	Source/WebCore/bindings/generic/RuntimeEnabledFeatures.h
+if USE_JSC
+webcore_sources += \
 	Source/WebCore/bindings/js/CachedScriptSourceProvider.h \
 	Source/WebCore/bindings/js/CallbackFunction.cpp \
 	Source/WebCore/bindings/js/CallbackFunction.h \
@@ -875,10 +881,14 @@ webcore_sources += \
 	Source/WebCore/bindings/js/WorkerScriptController.cpp \
 	Source/WebCore/bindings/js/WorkerScriptController.h \
 	Source/WebCore/bindings/js/WorkerScriptDebugServer.cpp \
-	Source/WebCore/bindings/js/WorkerScriptDebugServer.h \
+	Source/WebCore/bindings/js/WorkerScriptDebugServer.h
+endif
+webcore_sources += \
 	Source/WebCore/bindings/ScriptControllerBase.cpp \
 	Source/WebCore/bindings/ScriptControllerBase.h \
-	Source/WebCore/bridge/Bridge.h \
+	Source/WebCore/bridge/Bridge.h
+if USE_JSC
+webcore_sources += \
 	Source/WebCore/bridge/c/c_class.cpp \
 	Source/WebCore/bridge/c/c_class.h \
 	Source/WebCore/bridge/c/c_instance.cpp \
@@ -915,7 +925,9 @@ webcore_sources += \
 	Source/WebCore/bridge/runtime_object.cpp \
 	Source/WebCore/bridge/runtime_object.h \
 	Source/WebCore/bridge/runtime_root.cpp \
-	Source/WebCore/bridge/runtime_root.h \
+	Source/WebCore/bridge/runtime_root.h
+endif
+webcore_sources += \
 	Source/WebCore/config.h \
 	Source/WebCore/css/Counter.h \
 	Source/WebCore/css/CSSBorderImageSliceValue.cpp \
@@ -3951,8 +3963,12 @@ webcoregtk_sources += \
 	Source/WebCore/accessibility/gtk/AccessibilityObjectWrapperAtk.h \
 	Source/WebCore/accessibility/gtk/AXObjectCacheAtk.cpp \
 	Source/WebCore/accessibility/gtk/WebKitAccessibleHyperlink.h \
-	Source/WebCore/accessibility/gtk/WebKitAccessibleHyperlink.cpp \
-	Source/WebCore/bindings/js/ScriptControllerGtk.cpp \
+	Source/WebCore/accessibility/gtk/WebKitAccessibleHyperlink.cpp
+if USE_JSC
+webcoregtk_sources += \
+	Source/WebCore/bindings/js/ScriptControllerGtk.cpp
+endif
+webcoregtk_sources += \
 	Source/WebCore/editing/gtk/FrameSelectionGtk.cpp \
 	Source/WebCore/page/gtk/DragControllerGtk.cpp \
 	Source/WebCore/page/gtk/EventHandlerGtk.cpp \
@@ -4126,6 +4142,7 @@ endif # END USE_PANGO
 # Database Support
 # ----
 if ENABLE_SQL_DATABASE
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSDatabase.cpp \
 	DerivedSources/WebCore/JSDatabase.h \
@@ -4150,12 +4167,45 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSSQLTransactionSync.cpp \
 	DerivedSources/WebCore/JSSQLTransactionSyncCallback.cpp \
 	DerivedSources/WebCore/JSSQLTransactionSyncCallback.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8DatabaseCallback.cpp \
+	DerivedSources/WebCore/V8DatabaseCallback.h \
+	DerivedSources/WebCore/V8Database.cpp \
+	DerivedSources/WebCore/V8Database.h \
+	DerivedSources/WebCore/V8DatabaseSync.cpp \
+	DerivedSources/WebCore/V8DatabaseSync.h \
+	DerivedSources/WebCore/V8SQLError.cpp \
+	DerivedSources/WebCore/V8SQLError.h \
+	DerivedSources/WebCore/V8SQLException.cpp \
+	DerivedSources/WebCore/V8SQLException.h \
+	DerivedSources/WebCore/V8SQLResultSet.cpp \
+	DerivedSources/WebCore/V8SQLResultSet.h \
+	DerivedSources/WebCore/V8SQLResultSetRowList.cpp \
+	DerivedSources/WebCore/V8SQLResultSetRowList.h \
+	DerivedSources/WebCore/V8SQLStatementCallback.cpp \
+	DerivedSources/WebCore/V8SQLStatementCallback.h \
+	DerivedSources/WebCore/V8SQLStatementErrorCallback.cpp \
+	DerivedSources/WebCore/V8SQLStatementErrorCallback.h \
+	DerivedSources/WebCore/V8SQLTransactionCallback.cpp \
+	DerivedSources/WebCore/V8SQLTransactionCallback.h \
+	DerivedSources/WebCore/V8SQLTransaction.cpp \
+	DerivedSources/WebCore/V8SQLTransactionErrorCallback.cpp \
+	DerivedSources/WebCore/V8SQLTransactionErrorCallback.h \
+	DerivedSources/WebCore/V8SQLTransaction.h \
+	DerivedSources/WebCore/V8SQLTransactionSyncCallback.cpp \
+	DerivedSources/WebCore/V8SQLTransactionSyncCallback.h \
+	DerivedSources/WebCore/V8SQLTransactionSync.cpp \
+	DerivedSources/WebCore/V8SQLTransactionSync.h
+endif # END USE_V8
 endif # END ENABLE_SQL_DATABASE
 
 # ----
 # HTML5 data transfer items support
 # ----
 if ENABLE_DATA_TRANSFER_ITEMS
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSDataTransferItem.cpp \
 	DerivedSources/WebCore/JSDataTransferItem.h \
@@ -4163,6 +4213,17 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSDataTransferItems.h \
 	DerivedSources/WebCore/JSStringCallback.cpp \
 	DerivedSources/WebCore/JSStringCallback.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8DataTransferItem.cpp \
+	DerivedSources/WebCore/V8DataTransferItem.h \
+	DerivedSources/WebCore/V8DataTransferItems.cpp \
+	DerivedSources/WebCore/V8DataTransferItems.h \
+	DerivedSources/WebCore/V8StringCallback.cpp \
+	DerivedSources/WebCore/V8StringCallback.h
+endif # END USE_V8
+
 webcore_sources += \
 	Source/WebCore/dom/DataTransferItem.cpp \
 	Source/WebCore/dom/DataTransferItem.h \
@@ -4176,6 +4237,7 @@ endif # END ENABLE_DATA_TRANSFER_ITEMS
 # Indexed Database API support
 # ----
 if ENABLE_INDEXED_DATABASE
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSIDBAny.cpp \
 	DerivedSources/WebCore/JSIDBAny.h \
@@ -4197,22 +4259,62 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSIDBRequest.h \
 	DerivedSources/WebCore/JSIDBTransaction.cpp \
 	DerivedSources/WebCore/JSIDBTransaction.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8IDBAny.cpp \
+	DerivedSources/WebCore/V8IDBAny.h \
+	DerivedSources/WebCore/V8IDBDatabaseError.cpp \
+	DerivedSources/WebCore/V8IDBDatabaseError.h \
+	DerivedSources/WebCore/V8IDBDatabaseException.cpp \
+	DerivedSources/WebCore/V8IDBDatabaseException.h \
+	DerivedSources/WebCore/V8IDBDatabase.cpp \
+	DerivedSources/WebCore/V8IDBDatabase.h \
+	DerivedSources/WebCore/V8IDBErrorEvent.cpp \
+	DerivedSources/WebCore/V8IDBErrorEvent.h \
+	DerivedSources/WebCore/V8IDBEvent.cpp \
+	DerivedSources/WebCore/V8IDBEvent.h \
+	DerivedSources/WebCore/V8IDBFactory.cpp \
+	DerivedSources/WebCore/V8IDBFactory.h \
+	DerivedSources/WebCore/V8IDBIndex.cpp \
+	DerivedSources/WebCore/V8IDBIndex.h \
+	DerivedSources/WebCore/V8IDBKeyRange.cpp \
+	DerivedSources/WebCore/V8IDBKeyRange.h \
+	DerivedSources/WebCore/V8IDBObjectStore.cpp \
+	DerivedSources/WebCore/V8IDBObjectStore.h \
+	DerivedSources/WebCore/V8IDBRequest.cpp \
+	DerivedSources/WebCore/V8IDBRequest.h \
+	DerivedSources/WebCore/V8IDBSuccessEvent.cpp \
+	DerivedSources/WebCore/V8IDBSuccessEvent.h \
+	DerivedSources/WebCore/V8IDBTransaction.cpp \
+	DerivedSources/WebCore/V8IDBTransaction.h
+endif # END USE_V8
 endif # END ENABLE_INDEXED_DATABASE
 
 # ----
 # HTML5 client-side session and persistent storage
 # ----
 if ENABLE_DOM_STORAGE
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSStorage.cpp \
 	DerivedSources/WebCore/JSStorageEvent.cpp \
 	DerivedSources/WebCore/JSStorageEvent.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8Storage.cpp \
+	DerivedSources/WebCore/V8StorageEvent.cpp \
+	DerivedSources/WebCore/V8StorageEvent.h \
+	DerivedSources/WebCore/V8Storage.h
+endif # END USE_V8
 endif # END ENABLE_DOM_STORAGE
 
 # ----
 # FileSystem API support
 # ----
 if ENABLE_FILE_SYSTEM
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSDirectoryEntry.cpp \
 	DerivedSources/WebCore/JSDirectoryEntry.h \
@@ -4260,12 +4362,63 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSMetadata.h \
 	DerivedSources/WebCore/JSMetadataCallback.cpp \
 	DerivedSources/WebCore/JSMetadataCallback.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8DirectoryEntry.cpp \
+	DerivedSources/WebCore/V8DirectoryEntry.h \
+	DerivedSources/WebCore/V8DirectoryEntrySync.cpp \
+	DerivedSources/WebCore/V8DirectoryEntrySync.h \
+	DerivedSources/WebCore/V8DirectoryReader.cpp \
+	DerivedSources/WebCore/V8DirectoryReader.h \
+	DerivedSources/WebCore/V8DirectoryReaderSync.cpp \
+	DerivedSources/WebCore/V8DirectoryReaderSync.h \
+	DerivedSources/WebCore/V8DOMFileSystem.cpp \
+	DerivedSources/WebCore/V8DOMFileSystem.h \
+	DerivedSources/WebCore/V8DOMFileSystemSync.cpp \
+	DerivedSources/WebCore/V8DOMFileSystemSync.h \
+	DerivedSources/WebCore/V8EntriesCallback.cpp \
+	DerivedSources/WebCore/V8EntriesCallback.h \
+	DerivedSources/WebCore/V8Entry.cpp \
+	DerivedSources/WebCore/V8Entry.h \
+	DerivedSources/WebCore/V8EntryArray.cpp \
+	DerivedSources/WebCore/V8EntryArray.h \
+	DerivedSources/WebCore/V8EntryArraySync.cpp \
+	DerivedSources/WebCore/V8EntryArraySync.h \
+	DerivedSources/WebCore/V8EntryCallback.cpp \
+	DerivedSources/WebCore/V8EntryCallback.h \
+	DerivedSources/WebCore/V8EntrySync.cpp \
+	DerivedSources/WebCore/V8EntrySync.h \
+	DerivedSources/WebCore/V8ErrorCallback.cpp \
+	DerivedSources/WebCore/V8ErrorCallback.h \
+	DerivedSources/WebCore/V8FileCallback.cpp \
+	DerivedSources/WebCore/V8FileCallback.h \
+	DerivedSources/WebCore/V8FileEntry.cpp \
+	DerivedSources/WebCore/V8FileEntry.h \
+	DerivedSources/WebCore/V8FileEntrySync.cpp \
+	DerivedSources/WebCore/V8FileEntrySync.h \
+	DerivedSources/WebCore/V8FileSystemCallback.cpp \
+	DerivedSources/WebCore/V8FileSystemCallback.h \
+	DerivedSources/WebCore/V8FileWriter.cpp \
+	DerivedSources/WebCore/V8FileWriter.h \
+	DerivedSources/WebCore/V8FileWriterCallback.cpp \
+	DerivedSources/WebCore/V8FileWriterCallback.h \
+	DerivedSources/WebCore/V8FileWriterSync.cpp \
+	DerivedSources/WebCore/V8FileWriterSync.h \
+	DerivedSources/WebCore/V8WebKitFlags.cpp \
+	DerivedSources/WebCore/V8WebKitFlags.h \
+	DerivedSources/WebCore/V8Metadata.cpp \
+	DerivedSources/WebCore/V8Metadata.h \
+	DerivedSources/WebCore/V8MetadataCallback.cpp \
+	DerivedSources/WebCore/V8MetadataCallback.h
+endif # END USE_V8
 endif # END ENABLE_FILE_SYSTEM
 
 # ----
 # XPath Support
 # ----
 if ENABLE_XPATH
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSXPathEvaluator.cpp \
 	DerivedSources/WebCore/JSXPathEvaluator.h \
@@ -4276,7 +4429,22 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSXPathNSResolver.cpp \
 	DerivedSources/WebCore/JSXPathNSResolver.h \
 	DerivedSources/WebCore/JSXPathResult.cpp \
-	DerivedSources/WebCore/JSXPathResult.h \
+	DerivedSources/WebCore/JSXPathResult.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8XPathEvaluator.cpp \
+	DerivedSources/WebCore/V8XPathEvaluator.h \
+	DerivedSources/WebCore/V8XPathException.cpp \
+	DerivedSources/WebCore/V8XPathException.h \
+	DerivedSources/WebCore/V8XPathExpression.cpp \
+	DerivedSources/WebCore/V8XPathExpression.h \
+	DerivedSources/WebCore/V8XPathNSResolver.cpp \
+	DerivedSources/WebCore/V8XPathNSResolver.h \
+	DerivedSources/WebCore/V8XPathResult.cpp \
+	DerivedSources/WebCore/V8XPathResult.h
+endif # END USE_V8
+webcore_built_sources += \
 	DerivedSources/WebCore/XPathGrammar.cpp \
 	DerivedSources/WebCore/XPathGrammar.h
 endif # END ENABLE_XPATH
@@ -4287,6 +4455,7 @@ endif # END ENABLE_XPATH
 # FIXME: allow a more fine-grained inclusion/generation of sources per SVG feature
 # ----
 if ENABLE_SVG
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSElementTimeControl.h \
 	DerivedSources/WebCore/JSSVGAElement.cpp \
@@ -4581,6 +4750,304 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSSVGZoomAndPan.h \
 	DerivedSources/WebCore/JSSVGZoomEvent.cpp \
 	DerivedSources/WebCore/JSSVGZoomEvent.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8ElementTimeControl.h \
+	DerivedSources/WebCore/V8SVGAElement.cpp \
+	DerivedSources/WebCore/V8SVGAElement.h \
+	DerivedSources/WebCore/V8SVGAltGlyphElement.cpp \
+	DerivedSources/WebCore/V8SVGAltGlyphElement.h \
+	DerivedSources/WebCore/V8SVGAltGlyphDefElement.cpp \
+	DerivedSources/WebCore/V8SVGAltGlyphDefElement.h \
+	DerivedSources/WebCore/V8SVGAltGlyphItemElement.cpp \
+	DerivedSources/WebCore/V8SVGAltGlyphItemElement.h \
+	DerivedSources/WebCore/V8SVGAngle.cpp \
+	DerivedSources/WebCore/V8SVGAngle.h \
+	DerivedSources/WebCore/V8SVGAnimateColorElement.cpp \
+	DerivedSources/WebCore/V8SVGAnimateColorElement.h \
+	DerivedSources/WebCore/V8SVGAnimatedAngle.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedAngle.h \
+	DerivedSources/WebCore/V8SVGAnimatedBoolean.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedBoolean.h \
+	DerivedSources/WebCore/V8SVGAnimatedEnumeration.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedEnumeration.h \
+	DerivedSources/WebCore/V8SVGAnimatedInteger.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedInteger.h \
+	DerivedSources/WebCore/V8SVGAnimatedLength.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedLength.h \
+	DerivedSources/WebCore/V8SVGAnimatedLengthList.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedLengthList.h \
+	DerivedSources/WebCore/V8SVGAnimatedNumber.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedNumber.h \
+	DerivedSources/WebCore/V8SVGAnimatedNumberList.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedNumberList.h \
+	DerivedSources/WebCore/V8SVGAnimatedPreserveAspectRatio.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedPreserveAspectRatio.h \
+	DerivedSources/WebCore/V8SVGAnimatedRect.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedRect.h \
+	DerivedSources/WebCore/V8SVGAnimatedString.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedString.h \
+	DerivedSources/WebCore/V8SVGAnimatedTransformList.cpp \
+	DerivedSources/WebCore/V8SVGAnimatedTransformList.h \
+	DerivedSources/WebCore/V8SVGAnimateElement.cpp \
+	DerivedSources/WebCore/V8SVGAnimateElement.h \
+	DerivedSources/WebCore/V8SVGAnimateMotionElement.cpp \
+	DerivedSources/WebCore/V8SVGAnimateMotionElement.h \
+	DerivedSources/WebCore/V8SVGAnimateTransformElement.cpp \
+	DerivedSources/WebCore/V8SVGAnimateTransformElement.h \
+	DerivedSources/WebCore/V8SVGAnimationElement.cpp \
+	DerivedSources/WebCore/V8SVGAnimationElement.h \
+	DerivedSources/WebCore/V8SVGCircleElement.cpp \
+	DerivedSources/WebCore/V8SVGCircleElement.h \
+	DerivedSources/WebCore/V8SVGClipPathElement.cpp \
+	DerivedSources/WebCore/V8SVGClipPathElement.h \
+	DerivedSources/WebCore/V8SVGColor.cpp \
+	DerivedSources/WebCore/V8SVGColor.h \
+	DerivedSources/WebCore/V8SVGComponentTransferFunctionElement.cpp \
+	DerivedSources/WebCore/V8SVGComponentTransferFunctionElement.h \
+	DerivedSources/WebCore/V8SVGCursorElement.cpp \
+	DerivedSources/WebCore/V8SVGCursorElement.h \
+	DerivedSources/WebCore/V8SVGDefsElement.cpp \
+	DerivedSources/WebCore/V8SVGDefsElement.h \
+	DerivedSources/WebCore/V8SVGDescElement.cpp \
+	DerivedSources/WebCore/V8SVGDescElement.h \
+	DerivedSources/WebCore/V8SVGDocument.cpp \
+	DerivedSources/WebCore/V8SVGDocument.h \
+	DerivedSources/WebCore/V8SVGElement.cpp \
+	DerivedSources/WebCore/V8SVGElement.h \
+	DerivedSources/WebCore/V8SVGElementInstance.cpp \
+	DerivedSources/WebCore/V8SVGElementInstance.h \
+	DerivedSources/WebCore/V8SVGElementInstanceList.cpp \
+	DerivedSources/WebCore/V8SVGElementInstanceList.h \
+	DerivedSources/WebCore/V8SVGEllipseElement.cpp \
+	DerivedSources/WebCore/V8SVGEllipseElement.h \
+	DerivedSources/WebCore/V8SVGException.cpp \
+	DerivedSources/WebCore/V8SVGException.h \
+	DerivedSources/WebCore/V8SVGExternalResourcesRequired.h \
+	DerivedSources/WebCore/V8SVGFEBlendElement.cpp \
+	DerivedSources/WebCore/V8SVGFEBlendElement.h \
+	DerivedSources/WebCore/V8SVGFEColorMatrixElement.cpp \
+	DerivedSources/WebCore/V8SVGFEColorMatrixElement.h \
+	DerivedSources/WebCore/V8SVGFEComponentTransferElement.cpp \
+	DerivedSources/WebCore/V8SVGFEComponentTransferElement.h \
+	DerivedSources/WebCore/V8SVGFECompositeElement.cpp \
+	DerivedSources/WebCore/V8SVGFECompositeElement.h \
+	DerivedSources/WebCore/V8SVGFEConvolveMatrixElement.cpp \
+	DerivedSources/WebCore/V8SVGFEConvolveMatrixElement.h \
+	DerivedSources/WebCore/V8SVGFEDiffuseLightingElement.cpp \
+	DerivedSources/WebCore/V8SVGFEDiffuseLightingElement.h \
+	DerivedSources/WebCore/V8SVGFEDisplacementMapElement.cpp \
+	DerivedSources/WebCore/V8SVGFEDisplacementMapElement.h \
+	DerivedSources/WebCore/V8SVGFEDistantLightElement.cpp \
+	DerivedSources/WebCore/V8SVGFEDistantLightElement.h \
+	DerivedSources/WebCore/V8SVGFEDropShadowElement.cpp \
+	DerivedSources/WebCore/V8SVGFEDropShadowElement.h \
+	DerivedSources/WebCore/V8SVGFEFloodElement.cpp \
+	DerivedSources/WebCore/V8SVGFEFloodElement.h \
+	DerivedSources/WebCore/V8SVGFEFuncAElement.cpp \
+	DerivedSources/WebCore/V8SVGFEFuncAElement.h \
+	DerivedSources/WebCore/V8SVGFEFuncBElement.cpp \
+	DerivedSources/WebCore/V8SVGFEFuncBElement.h \
+	DerivedSources/WebCore/V8SVGFEFuncGElement.cpp \
+	DerivedSources/WebCore/V8SVGFEFuncGElement.h \
+	DerivedSources/WebCore/V8SVGFEFuncRElement.cpp \
+	DerivedSources/WebCore/V8SVGFEFuncRElement.h \
+	DerivedSources/WebCore/V8SVGFEGaussianBlurElement.cpp \
+	DerivedSources/WebCore/V8SVGFEGaussianBlurElement.h \
+	DerivedSources/WebCore/V8SVGFEImageElement.cpp \
+	DerivedSources/WebCore/V8SVGFEImageElement.h \
+	DerivedSources/WebCore/V8SVGFEMergeElement.cpp \
+	DerivedSources/WebCore/V8SVGFEMergeElement.h \
+	DerivedSources/WebCore/V8SVGFEMergeNodeElement.cpp \
+	DerivedSources/WebCore/V8SVGFEMergeNodeElement.h \
+	DerivedSources/WebCore/V8SVGFEMorphologyElement.cpp \
+	DerivedSources/WebCore/V8SVGFEMorphologyElement.h \
+	DerivedSources/WebCore/V8SVGFEOffsetElement.cpp \
+	DerivedSources/WebCore/V8SVGFEOffsetElement.h \
+	DerivedSources/WebCore/V8SVGFEPointLightElement.cpp \
+	DerivedSources/WebCore/V8SVGFEPointLightElement.h \
+	DerivedSources/WebCore/V8SVGFESpecularLightingElement.cpp \
+	DerivedSources/WebCore/V8SVGFESpecularLightingElement.h \
+	DerivedSources/WebCore/V8SVGFESpotLightElement.cpp \
+	DerivedSources/WebCore/V8SVGFESpotLightElement.h \
+	DerivedSources/WebCore/V8SVGFETileElement.cpp \
+	DerivedSources/WebCore/V8SVGFETileElement.h \
+	DerivedSources/WebCore/V8SVGFETurbulenceElement.cpp \
+	DerivedSources/WebCore/V8SVGFETurbulenceElement.h \
+	DerivedSources/WebCore/V8SVGFilterElement.cpp \
+	DerivedSources/WebCore/V8SVGFilterElement.h \
+	DerivedSources/WebCore/V8SVGFilterPrimitiveStandardAttributes.h \
+	DerivedSources/WebCore/V8SVGFitToViewBox.h \
+	DerivedSources/WebCore/V8SVGFontElement.cpp \
+	DerivedSources/WebCore/V8SVGFontElement.h \
+	DerivedSources/WebCore/V8SVGFontFaceElement.cpp \
+	DerivedSources/WebCore/V8SVGFontFaceElement.h \
+	DerivedSources/WebCore/V8SVGFontFaceFormatElement.cpp \
+	DerivedSources/WebCore/V8SVGFontFaceFormatElement.h \
+	DerivedSources/WebCore/V8SVGFontFaceNameElement.cpp \
+	DerivedSources/WebCore/V8SVGFontFaceNameElement.h \
+	DerivedSources/WebCore/V8SVGFontFaceSrcElement.cpp \
+	DerivedSources/WebCore/V8SVGFontFaceSrcElement.h \
+	DerivedSources/WebCore/V8SVGFontFaceUriElement.cpp \
+	DerivedSources/WebCore/V8SVGFontFaceUriElement.h \
+	DerivedSources/WebCore/V8SVGForeignObjectElement.cpp \
+	DerivedSources/WebCore/V8SVGForeignObjectElement.h \
+	DerivedSources/WebCore/V8SVGGElement.cpp \
+	DerivedSources/WebCore/V8SVGGElement.h \
+	DerivedSources/WebCore/V8SVGGlyphElement.cpp \
+	DerivedSources/WebCore/V8SVGGlyphElement.h \
+	DerivedSources/WebCore/V8SVGGlyphRefElement.cpp \
+	DerivedSources/WebCore/V8SVGGlyphRefElement.h \
+	DerivedSources/WebCore/V8SVGGradientElement.cpp \
+	DerivedSources/WebCore/V8SVGGradientElement.h \
+	DerivedSources/WebCore/V8SVGHKernElement.cpp \
+	DerivedSources/WebCore/V8SVGHKernElement.h \
+	DerivedSources/WebCore/V8SVGImageElement.cpp \
+	DerivedSources/WebCore/V8SVGImageElement.h \
+	DerivedSources/WebCore/V8SVGLangSpace.h \
+	DerivedSources/WebCore/V8SVGLength.cpp \
+	DerivedSources/WebCore/V8SVGLength.h \
+	DerivedSources/WebCore/V8SVGLengthList.cpp \
+	DerivedSources/WebCore/V8SVGLengthList.h \
+	DerivedSources/WebCore/V8SVGLinearGradientElement.cpp \
+	DerivedSources/WebCore/V8SVGLinearGradientElement.h \
+	DerivedSources/WebCore/V8SVGLineElement.cpp \
+	DerivedSources/WebCore/V8SVGLineElement.h \
+	DerivedSources/WebCore/V8SVGLocatable.h \
+	DerivedSources/WebCore/V8SVGMPathElement.cpp \
+	DerivedSources/WebCore/V8SVGMPathElement.h \
+	DerivedSources/WebCore/V8SVGMarkerElement.cpp \
+	DerivedSources/WebCore/V8SVGMarkerElement.h \
+	DerivedSources/WebCore/V8SVGMaskElement.cpp \
+	DerivedSources/WebCore/V8SVGMaskElement.h \
+	DerivedSources/WebCore/V8SVGMatrix.cpp \
+	DerivedSources/WebCore/V8SVGMatrix.h \
+	DerivedSources/WebCore/V8SVGMetadataElement.cpp \
+	DerivedSources/WebCore/V8SVGMetadataElement.h \
+	DerivedSources/WebCore/V8SVGMissingGlyphElement.cpp \
+	DerivedSources/WebCore/V8SVGMissingGlyphElement.h \
+	DerivedSources/WebCore/V8SVGNumber.cpp \
+	DerivedSources/WebCore/V8SVGNumber.h \
+	DerivedSources/WebCore/V8SVGNumberList.cpp \
+	DerivedSources/WebCore/V8SVGNumberList.h \
+	DerivedSources/WebCore/V8SVGPaint.cpp \
+	DerivedSources/WebCore/V8SVGPaint.h \
+	DerivedSources/WebCore/V8SVGPathElement.cpp \
+	DerivedSources/WebCore/V8SVGPathElement.h \
+	DerivedSources/WebCore/V8SVGPathSegArcAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegArcAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegArcRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegArcRel.h \
+	DerivedSources/WebCore/V8SVGPathSegClosePath.cpp \
+	DerivedSources/WebCore/V8SVGPathSegClosePath.h \
+	DerivedSources/WebCore/V8SVGPathSeg.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicRel.h \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicSmoothAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicSmoothAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicSmoothRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoCubicSmoothRel.h \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticRel.h \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticSmoothAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticSmoothAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticSmoothRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegCurvetoQuadraticSmoothRel.h \
+	DerivedSources/WebCore/V8SVGPathSeg.h \
+	DerivedSources/WebCore/V8SVGPathSegLinetoAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegLinetoAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegLinetoHorizontalAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegLinetoHorizontalAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegLinetoHorizontalRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegLinetoHorizontalRel.h \
+	DerivedSources/WebCore/V8SVGPathSegLinetoRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegLinetoRel.h \
+	DerivedSources/WebCore/V8SVGPathSegLinetoVerticalAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegLinetoVerticalAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegLinetoVerticalRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegLinetoVerticalRel.h \
+	DerivedSources/WebCore/V8SVGPathSegList.cpp \
+	DerivedSources/WebCore/V8SVGPathSegList.h \
+	DerivedSources/WebCore/V8SVGPathSegMovetoAbs.cpp \
+	DerivedSources/WebCore/V8SVGPathSegMovetoAbs.h \
+	DerivedSources/WebCore/V8SVGPathSegMovetoRel.cpp \
+	DerivedSources/WebCore/V8SVGPathSegMovetoRel.h \
+	DerivedSources/WebCore/V8SVGPatternElement.cpp \
+	DerivedSources/WebCore/V8SVGPatternElement.h \
+	DerivedSources/WebCore/V8SVGPoint.cpp \
+	DerivedSources/WebCore/V8SVGPoint.h \
+	DerivedSources/WebCore/V8SVGPointList.cpp \
+	DerivedSources/WebCore/V8SVGPointList.h \
+	DerivedSources/WebCore/V8SVGPolygonElement.cpp \
+	DerivedSources/WebCore/V8SVGPolygonElement.h \
+	DerivedSources/WebCore/V8SVGPolylineElement.cpp \
+	DerivedSources/WebCore/V8SVGPolylineElement.h \
+	DerivedSources/WebCore/V8SVGPreserveAspectRatio.cpp \
+	DerivedSources/WebCore/V8SVGPreserveAspectRatio.h \
+	DerivedSources/WebCore/V8SVGRadialGradientElement.cpp \
+	DerivedSources/WebCore/V8SVGRadialGradientElement.h \
+	DerivedSources/WebCore/V8SVGRect.cpp \
+	DerivedSources/WebCore/V8SVGRectElement.cpp \
+	DerivedSources/WebCore/V8SVGRectElement.h \
+	DerivedSources/WebCore/V8SVGRect.h \
+	DerivedSources/WebCore/V8SVGRenderingIntent.cpp \
+	DerivedSources/WebCore/V8SVGRenderingIntent.h \
+	DerivedSources/WebCore/V8SVGScriptElement.cpp \
+	DerivedSources/WebCore/V8SVGScriptElement.h \
+	DerivedSources/WebCore/V8SVGSetElement.cpp \
+	DerivedSources/WebCore/V8SVGSetElement.h \
+	DerivedSources/WebCore/V8SVGStopElement.cpp \
+	DerivedSources/WebCore/V8SVGStopElement.h \
+	DerivedSources/WebCore/V8SVGStringList.cpp \
+	DerivedSources/WebCore/V8SVGStringList.h \
+	DerivedSources/WebCore/V8SVGStylable.h \
+	DerivedSources/WebCore/V8SVGStyleElement.cpp \
+	DerivedSources/WebCore/V8SVGStyleElement.h \
+	DerivedSources/WebCore/V8SVGSVGElement.cpp \
+	DerivedSources/WebCore/V8SVGSVGElement.h \
+	DerivedSources/WebCore/V8SVGSwitchElement.cpp \
+	DerivedSources/WebCore/V8SVGSwitchElement.h \
+	DerivedSources/WebCore/V8SVGSymbolElement.cpp \
+	DerivedSources/WebCore/V8SVGSymbolElement.h \
+	DerivedSources/WebCore/V8SVGTests.h \
+	DerivedSources/WebCore/V8SVGTextContentElement.cpp \
+	DerivedSources/WebCore/V8SVGTextContentElement.h \
+	DerivedSources/WebCore/V8SVGTextElement.cpp \
+	DerivedSources/WebCore/V8SVGTextElement.h \
+	DerivedSources/WebCore/V8SVGTextPathElement.cpp \
+	DerivedSources/WebCore/V8SVGTextPathElement.h \
+	DerivedSources/WebCore/V8SVGTextPositioningElement.cpp \
+	DerivedSources/WebCore/V8SVGTextPositioningElement.h \
+	DerivedSources/WebCore/V8SVGTitleElement.cpp \
+	DerivedSources/WebCore/V8SVGTitleElement.h \
+	DerivedSources/WebCore/V8SVGTransformable.h \
+	DerivedSources/WebCore/V8SVGTransform.cpp \
+	DerivedSources/WebCore/V8SVGTransform.h \
+	DerivedSources/WebCore/V8SVGTransformList.cpp \
+	DerivedSources/WebCore/V8SVGTransformList.h \
+	DerivedSources/WebCore/V8SVGTRefElement.cpp \
+	DerivedSources/WebCore/V8SVGTRefElement.h \
+	DerivedSources/WebCore/V8SVGTSpanElement.cpp \
+	DerivedSources/WebCore/V8SVGTSpanElement.h \
+	DerivedSources/WebCore/V8SVGUnitTypes.cpp \
+	DerivedSources/WebCore/V8SVGUnitTypes.h \
+	DerivedSources/WebCore/V8SVGURIReference.h \
+	DerivedSources/WebCore/V8SVGUseElement.cpp \
+	DerivedSources/WebCore/V8SVGUseElement.h \
+	DerivedSources/WebCore/V8SVGViewElement.cpp \
+	DerivedSources/WebCore/V8SVGViewElement.h \
+	DerivedSources/WebCore/V8SVGViewSpec.h \
+	DerivedSources/WebCore/V8SVGVKernElement.cpp \
+	DerivedSources/WebCore/V8SVGVKernElement.h \
+	DerivedSources/WebCore/V8SVGZoomAndPan.h \
+	DerivedSources/WebCore/V8SVGZoomEvent.h \
+	DerivedSources/WebCore/V8SVGZoomEvent.cpp
+endif # END USE_V8
 endif # END ENABLE_SVG
 
 # ----
@@ -4616,6 +5083,8 @@ webcore_sources += \
 	Source/WebCore/webaudio/AudioPannerNode.cpp \
 	Source/WebCore/webaudio/AudioPannerNode.h \
 	Source/WebCore/webaudio/AudioParam.cpp \
+	Source/WebCore/webaudio/AudioParamTimeline.cpp \
+	Source/WebCore/webaudio/AudioParamTimeline.h \
 	Source/WebCore/webaudio/AudioParam.h \
 	Source/WebCore/webaudio/AudioProcessingEvent.cpp \
 	Source/WebCore/webaudio/AudioProcessingEvent.h \
@@ -4642,6 +5111,8 @@ webcore_sources += \
 	Source/WebCore/webaudio/RealtimeAnalyser.h \
 	Source/WebCore/webaudio/RealtimeAnalyserNode.cpp \
 	Source/WebCore/webaudio/RealtimeAnalyserNode.h
+
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSAudioBuffer.cpp \
 	DerivedSources/WebCore/JSAudioBuffer.h \
@@ -4683,17 +5154,82 @@ webcore_built_sources += \
 	DerivedSources/WebCore/JSLowPass2FilterNode.h \
 	DerivedSources/WebCore/JSRealtimeAnalyserNode.cpp \
 	DerivedSources/WebCore/JSRealtimeAnalyserNode.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8AudioBuffer.cpp \
+	DerivedSources/WebCore/V8AudioBuffer.h \
+	DerivedSources/WebCore/V8AudioBufferCallback.cpp \
+	DerivedSources/WebCore/V8AudioBufferCallback.h \
+	DerivedSources/WebCore/V8AudioBufferSourceNode.cpp \
+	DerivedSources/WebCore/V8AudioBufferSourceNode.h \
+	DerivedSources/WebCore/V8AudioChannelMerger.cpp \
+	DerivedSources/WebCore/V8AudioChannelMerger.h \
+	DerivedSources/WebCore/V8AudioChannelSplitter.cpp \
+	DerivedSources/WebCore/V8AudioChannelSplitter.h \
+	DerivedSources/WebCore/V8AudioContext.cpp \
+	DerivedSources/WebCore/V8AudioContext.h \
+	DerivedSources/WebCore/V8AudioDestinationNode.cpp \
+	DerivedSources/WebCore/V8AudioDestinationNode.h \
+	DerivedSources/WebCore/V8AudioGain.cpp \
+	DerivedSources/WebCore/V8AudioGain.h \
+	DerivedSources/WebCore/V8AudioGainNode.cpp \
+	DerivedSources/WebCore/V8AudioGainNode.h \
+	DerivedSources/WebCore/V8AudioListener.cpp \
+	DerivedSources/WebCore/V8AudioListener.h \
+	DerivedSources/WebCore/V8AudioNode.cpp \
+	DerivedSources/WebCore/V8AudioNode.h \
+	DerivedSources/WebCore/V8AudioPannerNode.cpp \
+	DerivedSources/WebCore/V8AudioPannerNode.h \
+	DerivedSources/WebCore/V8AudioParam.cpp \
+	DerivedSources/WebCore/V8AudioParam.h \
+	DerivedSources/WebCore/V8AudioProcessingEvent.cpp \
+	DerivedSources/WebCore/V8AudioProcessingEvent.h \
+	DerivedSources/WebCore/V8AudioSourceNode.cpp \
+	DerivedSources/WebCore/V8AudioSourceNode.h \
+	DerivedSources/WebCore/V8BiquadFilterNode.h \
+	DerivedSources/WebCore/V8BiquadFilterNode.cpp \
+	DerivedSources/WebCore/V8ConvolverNode.cpp \
+	DerivedSources/WebCore/V8ConvolverNode.h \
+	DerivedSources/WebCore/V8DelayNode.cpp \
+	DerivedSources/WebCore/V8DelayNode.h \
+	DerivedSources/WebCore/V8DynamicsCompressorNode.h \
+	DerivedSources/WebCore/V8DynamicsCompressorNode.cpp \
+	DerivedSources/WebCore/V8HighPass2FilterNode.cpp \
+	DerivedSources/WebCore/V8HighPass2FilterNode.h \
+	DerivedSources/WebCore/V8JavaScriptAudioNode.cpp \
+	DerivedSources/WebCore/V8JavaScriptAudioNode.h \
+	DerivedSources/WebCore/V8LowPass2FilterNode.cpp \
+	DerivedSources/WebCore/V8LowPass2FilterNode.h \
+	DerivedSources/WebCore/V8OfflineAudioCompletionEvent.h \
+	DerivedSources/WebCore/V8OfflineAudioCompletionEvent.cpp \
+	DerivedSources/WebCore/V8RealtimeAnalyserNode.cpp \
+	DerivedSources/WebCore/V8RealtimeAnalyserNode.h
+webcore_sources +=
+	Source/WebCore/bindings/v8/custom/V8AudioContextCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8AudioNodeCustom.cpp
+
+endif # END USE_V8
 endif
 
 # ----
 # Web Sockets Support
 # ----
 if ENABLE_WEB_SOCKETS
+if USE_JSC
 webcore_built_sources += \
 	DerivedSources/WebCore/JSCloseEvent.cpp \
 	DerivedSources/WebCore/JSCloseEvent.h \
 	DerivedSources/WebCore/JSWebSocket.cpp \
 	DerivedSources/WebCore/JSWebSocket.h
+endif # END USE_JSC
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8CloseEvent.cpp \
+	DerivedSources/WebCore/V8CloseEvent.h \
+	DerivedSources/WebCore/V8WebSocket.cpp \
+	DerivedSources/WebCore/V8WebSocket.h
+endif # END USE_V8
 endif  # END ENABLE_WEB_SOCKETS
 
 # ---
@@ -4704,6 +5240,7 @@ webcore_built_sources += \
 	DerivedSources/ANGLE/glslang.cpp \
 	DerivedSources/ANGLE/glslang_tab.cpp \
 	DerivedSources/ANGLE/glslang_tab.h
+
 webcore_sources += \
 	Source/ThirdParty/ANGLE/include/GLSLANG/ShaderLang.h \
 	Source/ThirdParty/ANGLE/src/compiler/BaseTypes.h \
@@ -4866,12 +5403,818 @@ endif  # END ENABLE_MHTML
 # RequestAnimationFrame support
 # ---
 if ENABLE_REQUEST_ANIMATION_FRAME
+if USE_JSC
 webcore_built_sources += \
     DerivedSources/WebCore/JSRequestAnimationFrameCallback.cpp \
     DerivedSources/WebCore/JSRequestAnimationFrameCallback.h
 webcore_sources += \
-    Source/WebCore/bindings/js/JSRequestAnimationFrameCallbackCustom.cpp \
+    Source/WebCore/bindings/js/JSRequestAnimationFrameCallbackCustom.cpp
+endif # END USE_JSC
+webcore_sources += \
     Source/WebCore/dom/RequestAnimationFrameCallback.h \
     Source/WebCore/dom/ScriptedAnimationController.cpp \
     Source/WebCore/dom/ScriptedAnimationController.h
 endif  # END ENABLE_REQUEST_ANIMATION_FRAME
+
+if USE_V8
+webcore_built_sources += \
+	DerivedSources/WebCore/V8AbstractWorker.cpp \
+	DerivedSources/WebCore/V8AbstractWorker.h \
+	DerivedSources/WebCore/V8ArrayBuffer.cpp \
+	DerivedSources/WebCore/V8ArrayBuffer.h \
+	DerivedSources/WebCore/V8ArrayBufferView.cpp \
+	DerivedSources/WebCore/V8ArrayBufferView.h \
+	DerivedSources/WebCore/V8ArrayBufferViewCustomScript.h \
+	DerivedSources/WebCore/V8Attr.cpp \
+	DerivedSources/WebCore/V8Attr.h \
+	DerivedSources/WebCore/V8BarInfo.cpp \
+	DerivedSources/WebCore/V8BarInfo.h \
+	DerivedSources/WebCore/V8BeforeLoadEvent.cpp \
+	DerivedSources/WebCore/V8BeforeLoadEvent.h \
+	DerivedSources/WebCore/V8Blob.cpp \
+	DerivedSources/WebCore/V8Blob.h \
+	DerivedSources/WebCore/V8CanvasGradient.cpp \
+	DerivedSources/WebCore/V8CanvasGradient.h \
+	DerivedSources/WebCore/V8CanvasPattern.cpp \
+	DerivedSources/WebCore/V8CanvasPattern.h \
+	DerivedSources/WebCore/V8CanvasPixelArray.cpp \
+	DerivedSources/WebCore/V8CanvasPixelArray.h \
+	DerivedSources/WebCore/V8CanvasRenderingContext2D.cpp \
+	DerivedSources/WebCore/V8CanvasRenderingContext2D.h \
+	DerivedSources/WebCore/V8CanvasRenderingContext.cpp \
+	DerivedSources/WebCore/V8CanvasRenderingContext.h \
+	DerivedSources/WebCore/V8CDATASection.cpp \
+	DerivedSources/WebCore/V8CDATASection.h \
+	DerivedSources/WebCore/V8CharacterData.cpp \
+	DerivedSources/WebCore/V8CharacterData.h \
+	DerivedSources/WebCore/V8ClientRect.cpp \
+	DerivedSources/WebCore/V8ClientRect.h \
+	DerivedSources/WebCore/V8ClientRectList.cpp \
+	DerivedSources/WebCore/V8ClientRectList.h \
+	DerivedSources/WebCore/V8Clipboard.cpp \
+	DerivedSources/WebCore/V8Clipboard.h \
+	DerivedSources/WebCore/V8Comment.cpp \
+	DerivedSources/WebCore/V8Comment.h \
+	DerivedSources/WebCore/V8CompositionEvent.cpp \
+	DerivedSources/WebCore/V8CompositionEvent.h \
+	DerivedSources/WebCore/V8Console.cpp \
+	DerivedSources/WebCore/V8Console.h \
+	DerivedSources/WebCore/V8Coordinates.cpp \
+	DerivedSources/WebCore/V8Coordinates.h \
+	DerivedSources/WebCore/V8Counter.cpp \
+	DerivedSources/WebCore/V8Counter.h \
+	DerivedSources/WebCore/V8Crypto.cpp \
+	DerivedSources/WebCore/V8Crypto.h \
+	DerivedSources/WebCore/V8CSSCharsetRule.cpp \
+	DerivedSources/WebCore/V8CSSCharsetRule.h \
+	DerivedSources/WebCore/V8CSSFontFaceRule.cpp \
+	DerivedSources/WebCore/V8CSSFontFaceRule.h \
+	DerivedSources/WebCore/V8CSSImportRule.cpp \
+	DerivedSources/WebCore/V8CSSImportRule.h \
+	DerivedSources/WebCore/V8CSSMediaRule.cpp \
+	DerivedSources/WebCore/V8CSSMediaRule.h \
+	DerivedSources/WebCore/V8CSSPageRule.cpp \
+	DerivedSources/WebCore/V8CSSPageRule.h \
+	DerivedSources/WebCore/V8CSSPrimitiveValue.cpp \
+	DerivedSources/WebCore/V8CSSPrimitiveValue.h \
+	DerivedSources/WebCore/V8CSSRule.cpp \
+	DerivedSources/WebCore/V8CSSRule.h \
+	DerivedSources/WebCore/V8CSSRuleList.cpp \
+	DerivedSources/WebCore/V8CSSRuleList.h \
+	DerivedSources/WebCore/V8CSSStyleDeclaration.cpp \
+	DerivedSources/WebCore/V8CSSStyleDeclaration.h \
+	DerivedSources/WebCore/V8CSSStyleRule.cpp \
+	DerivedSources/WebCore/V8CSSStyleRule.h \
+	DerivedSources/WebCore/V8CSSStyleSheet.cpp \
+	DerivedSources/WebCore/V8CSSStyleSheet.h \
+	DerivedSources/WebCore/V8CSSValue.cpp \
+	DerivedSources/WebCore/V8CSSValue.h \
+	DerivedSources/WebCore/V8CSSValueList.cpp \
+	DerivedSources/WebCore/V8CSSValueList.h \
+	DerivedSources/WebCore/V8CustomEvent.cpp \
+	DerivedSources/WebCore/V8CustomEvent.h \
+	DerivedSources/WebCore/V8DataTransferItems.h \
+	DerivedSources/WebCore/V8DataTransferItems.cpp \
+	DerivedSources/WebCore/V8DataView.cpp \
+	DerivedSources/WebCore/V8DataView.h \
+	DerivedSources/WebCore/V8DedicatedWorkerContext.cpp \
+	DerivedSources/WebCore/V8DedicatedWorkerContext.h \
+	DerivedSources/WebCore/V8DeviceMotionEvent.cpp \
+	DerivedSources/WebCore/V8DeviceMotionEvent.h \
+	DerivedSources/WebCore/V8DeviceOrientationEvent.cpp \
+	DerivedSources/WebCore/V8DeviceOrientationEvent.h \
+	DerivedSources/WebCore/V8Document.cpp \
+	DerivedSources/WebCore/V8DocumentFragment.cpp \
+	DerivedSources/WebCore/V8DocumentFragment.h \
+	DerivedSources/WebCore/V8Document.h \
+	DerivedSources/WebCore/V8DocumentType.cpp \
+	DerivedSources/WebCore/V8DocumentType.h \
+	DerivedSources/WebCore/V8DOMApplicationCache.cpp \
+	DerivedSources/WebCore/V8DOMApplicationCache.h \
+	DerivedSources/WebCore/V8DOMCoreException.cpp \
+	DerivedSources/WebCore/V8DOMCoreException.h \
+	DerivedSources/WebCore/V8DOMFormData.cpp \
+	DerivedSources/WebCore/V8DOMFormData.h \
+	DerivedSources/WebCore/V8DOMImplementation.cpp \
+	DerivedSources/WebCore/V8DOMImplementation.h \
+	DerivedSources/WebCore/V8DOMMimeTypeArray.cpp \
+	DerivedSources/WebCore/V8DOMMimeTypeArray.h \
+	DerivedSources/WebCore/V8DOMMimeType.cpp \
+	DerivedSources/WebCore/V8DOMMimeType.h \
+	DerivedSources/WebCore/V8DOMParser.cpp \
+	DerivedSources/WebCore/V8DOMParser.h \
+	DerivedSources/WebCore/V8DOMPluginArray.cpp \
+	DerivedSources/WebCore/V8DOMPluginArray.h \
+	DerivedSources/WebCore/V8DOMPlugin.cpp \
+	DerivedSources/WebCore/V8DOMPlugin.h \
+	DerivedSources/WebCore/V8DOMSelection.cpp \
+	DerivedSources/WebCore/V8DOMSelection.h \
+	DerivedSources/WebCore/V8DOMSettableTokenList.cpp \
+	DerivedSources/WebCore/V8DOMSettableTokenList.h \
+	DerivedSources/WebCore/V8DOMStringList.cpp \
+	DerivedSources/WebCore/V8DOMStringList.h \
+	DerivedSources/WebCore/V8DOMStringMap.cpp \
+	DerivedSources/WebCore/V8DOMStringMap.h \
+	DerivedSources/WebCore/V8DOMTokenList.cpp \
+	DerivedSources/WebCore/V8DOMTokenList.h \
+	DerivedSources/WebCore/V8DOMURL.cpp \
+	DerivedSources/WebCore/V8DOMURL.h \
+	DerivedSources/WebCore/V8DOMWindow.cpp \
+	DerivedSources/WebCore/V8DOMWindow.h \
+	DerivedSources/WebCore/V8Element.cpp \
+	DerivedSources/WebCore/V8Element.h \
+	DerivedSources/WebCore/V8Entity.cpp \
+	DerivedSources/WebCore/V8Entity.h \
+	DerivedSources/WebCore/V8EntityReference.cpp \
+	DerivedSources/WebCore/V8EntityReference.h \
+	DerivedSources/WebCore/V8ErrorEvent.cpp \
+	DerivedSources/WebCore/V8ErrorEvent.h \
+	DerivedSources/WebCore/V8Event.cpp \
+	DerivedSources/WebCore/V8EventException.cpp \
+	DerivedSources/WebCore/V8EventException.h \
+	DerivedSources/WebCore/V8Event.h \
+	DerivedSources/WebCore/V8EventSource.cpp \
+	DerivedSources/WebCore/V8EventSource.h \
+	DerivedSources/WebCore/V8File.cpp \
+	DerivedSources/WebCore/V8FileError.cpp \
+	DerivedSources/WebCore/V8FileError.h \
+	DerivedSources/WebCore/V8File.h \
+	DerivedSources/WebCore/V8FileException.cpp \
+	DerivedSources/WebCore/V8FileException.h \
+	DerivedSources/WebCore/V8FileList.cpp \
+	DerivedSources/WebCore/V8FileList.h \
+	DerivedSources/WebCore/V8FileReader.cpp \
+	DerivedSources/WebCore/V8FileReader.h \
+	DerivedSources/WebCore/V8FileReaderSync.cpp \
+	DerivedSources/WebCore/V8FileReaderSync.h \
+	DerivedSources/WebCore/V8Float32Array.cpp \
+	DerivedSources/WebCore/V8Float32Array.h \
+	DerivedSources/WebCore/V8Float64Array.cpp \
+	DerivedSources/WebCore/V8Float64Array.h \
+	DerivedSources/WebCore/V8Geolocation.cpp \
+	DerivedSources/WebCore/V8Geolocation.h \
+	DerivedSources/WebCore/V8Geoposition.cpp \
+	DerivedSources/WebCore/V8Geoposition.h \
+	DerivedSources/WebCore/V8HashChangeEvent.cpp \
+	DerivedSources/WebCore/V8HashChangeEvent.h \
+	DerivedSources/WebCore/V8History.cpp \
+	DerivedSources/WebCore/V8History.h \
+	DerivedSources/WebCore/V8HTMLAllCollection.cpp \
+	DerivedSources/WebCore/V8HTMLAllCollection.h \
+	DerivedSources/WebCore/V8HTMLAnchorElement.cpp \
+	DerivedSources/WebCore/V8HTMLAnchorElement.h \
+	DerivedSources/WebCore/V8HTMLAppletElement.cpp \
+	DerivedSources/WebCore/V8HTMLAppletElement.h \
+	DerivedSources/WebCore/V8HTMLAreaElement.cpp \
+	DerivedSources/WebCore/V8HTMLAreaElement.h \
+	DerivedSources/WebCore/V8HTMLAudioElement.cpp \
+	DerivedSources/WebCore/V8HTMLAudioElement.h \
+	DerivedSources/WebCore/V8HTMLBaseElement.cpp \
+	DerivedSources/WebCore/V8HTMLBaseElement.h \
+	DerivedSources/WebCore/V8HTMLBaseFontElement.cpp \
+	DerivedSources/WebCore/V8HTMLBaseFontElement.h \
+	DerivedSources/WebCore/V8HTMLBodyElement.cpp \
+	DerivedSources/WebCore/V8HTMLBodyElement.h \
+	DerivedSources/WebCore/V8HTMLBRElement.cpp \
+	DerivedSources/WebCore/V8HTMLBRElement.h \
+	DerivedSources/WebCore/V8HTMLButtonElement.cpp \
+	DerivedSources/WebCore/V8HTMLButtonElement.h \
+	DerivedSources/WebCore/V8HTMLCanvasElement.cpp \
+	DerivedSources/WebCore/V8HTMLCanvasElement.h \
+	DerivedSources/WebCore/V8HTMLCollection.cpp \
+	DerivedSources/WebCore/V8HTMLCollection.h \
+	DerivedSources/WebCore/V8HTMLDataListElement.cpp \
+	DerivedSources/WebCore/V8HTMLDataListElement.h \
+	DerivedSources/WebCore/V8HTMLDetailsElement.cpp \
+	DerivedSources/WebCore/V8HTMLDetailsElement.h \
+	DerivedSources/WebCore/V8HTMLDirectoryElement.cpp \
+	DerivedSources/WebCore/V8HTMLDirectoryElement.h \
+	DerivedSources/WebCore/V8HTMLDivElement.cpp \
+	DerivedSources/WebCore/V8HTMLDivElement.h \
+	DerivedSources/WebCore/V8HTMLDListElement.cpp \
+	DerivedSources/WebCore/V8HTMLDListElement.h \
+	DerivedSources/WebCore/V8HTMLDocument.cpp \
+	DerivedSources/WebCore/V8HTMLDocument.h \
+	DerivedSources/WebCore/V8HTMLElement.cpp \
+	DerivedSources/WebCore/V8HTMLElement.h \
+	DerivedSources/WebCore/V8HTMLElementWrapperFactory.cpp \
+	DerivedSources/WebCore/V8HTMLElementWrapperFactory.h \
+	DerivedSources/WebCore/V8HTMLEmbedElement.cpp \
+	DerivedSources/WebCore/V8HTMLEmbedElement.h \
+	DerivedSources/WebCore/V8HTMLFieldSetElement.cpp \
+	DerivedSources/WebCore/V8HTMLFieldSetElement.h \
+	DerivedSources/WebCore/V8HTMLFontElement.cpp \
+	DerivedSources/WebCore/V8HTMLFontElement.h \
+	DerivedSources/WebCore/V8HTMLFormElement.cpp \
+	DerivedSources/WebCore/V8HTMLFormElement.h \
+	DerivedSources/WebCore/V8HTMLFrameElement.cpp \
+	DerivedSources/WebCore/V8HTMLFrameElement.h \
+	DerivedSources/WebCore/V8HTMLFrameSetElement.cpp \
+	DerivedSources/WebCore/V8HTMLFrameSetElement.h \
+	DerivedSources/WebCore/V8HTMLHeadElement.cpp \
+	DerivedSources/WebCore/V8HTMLHeadElement.h \
+	DerivedSources/WebCore/V8HTMLHeadingElement.cpp \
+	DerivedSources/WebCore/V8HTMLHeadingElement.h \
+	DerivedSources/WebCore/V8HTMLHRElement.cpp \
+	DerivedSources/WebCore/V8HTMLHRElement.h \
+	DerivedSources/WebCore/V8HTMLHtmlElement.cpp \
+	DerivedSources/WebCore/V8HTMLHtmlElement.h \
+	DerivedSources/WebCore/V8HTMLIFrameElement.cpp \
+	DerivedSources/WebCore/V8HTMLIFrameElement.h \
+	DerivedSources/WebCore/V8HTMLImageElement.cpp \
+	DerivedSources/WebCore/V8HTMLImageElement.h \
+	DerivedSources/WebCore/V8HTMLInputElement.cpp \
+	DerivedSources/WebCore/V8HTMLInputElement.h \
+	DerivedSources/WebCore/V8HTMLIsIndexElement.cpp \
+	DerivedSources/WebCore/V8HTMLIsIndexElement.h \
+	DerivedSources/WebCore/V8HTMLKeygenElement.cpp \
+	DerivedSources/WebCore/V8HTMLKeygenElement.h \
+	DerivedSources/WebCore/V8HTMLLabelElement.cpp \
+	DerivedSources/WebCore/V8HTMLLabelElement.h \
+	DerivedSources/WebCore/V8HTMLLegendElement.cpp \
+	DerivedSources/WebCore/V8HTMLLegendElement.h \
+	DerivedSources/WebCore/V8HTMLLIElement.cpp \
+	DerivedSources/WebCore/V8HTMLLIElement.h \
+	DerivedSources/WebCore/V8HTMLLinkElement.cpp \
+	DerivedSources/WebCore/V8HTMLLinkElement.h \
+	DerivedSources/WebCore/V8HTMLMapElement.cpp \
+	DerivedSources/WebCore/V8HTMLMapElement.h \
+	DerivedSources/WebCore/V8HTMLMarqueeElement.cpp \
+	DerivedSources/WebCore/V8HTMLMarqueeElement.h \
+	DerivedSources/WebCore/V8HTMLMediaElement.cpp \
+	DerivedSources/WebCore/V8HTMLMediaElement.h \
+	DerivedSources/WebCore/V8HTMLMenuElement.cpp \
+	DerivedSources/WebCore/V8HTMLMenuElement.h \
+	DerivedSources/WebCore/V8HTMLMetaElement.cpp \
+	DerivedSources/WebCore/V8HTMLMetaElement.h \
+	DerivedSources/WebCore/V8HTMLMeterElement.cpp \
+	DerivedSources/WebCore/V8HTMLMeterElement.h \
+	DerivedSources/WebCore/V8HTMLModElement.cpp \
+	DerivedSources/WebCore/V8HTMLModElement.h \
+	DerivedSources/WebCore/V8HTMLObjectElement.cpp \
+	DerivedSources/WebCore/V8HTMLObjectElement.h \
+	DerivedSources/WebCore/V8HTMLOListElement.cpp \
+	DerivedSources/WebCore/V8HTMLOListElement.h \
+	DerivedSources/WebCore/V8HTMLOptGroupElement.cpp \
+	DerivedSources/WebCore/V8HTMLOptGroupElement.h \
+	DerivedSources/WebCore/V8HTMLOptionElement.cpp \
+	DerivedSources/WebCore/V8HTMLOptionElement.h \
+	DerivedSources/WebCore/V8HTMLOptionsCollection.cpp \
+	DerivedSources/WebCore/V8HTMLOptionsCollection.h \
+	DerivedSources/WebCore/V8HTMLOutputElement.cpp \
+	DerivedSources/WebCore/V8HTMLOutputElement.h \
+	DerivedSources/WebCore/V8HTMLParagraphElement.cpp \
+	DerivedSources/WebCore/V8HTMLParagraphElement.h \
+	DerivedSources/WebCore/V8HTMLParamElement.cpp \
+	DerivedSources/WebCore/V8HTMLParamElement.h \
+	DerivedSources/WebCore/V8HTMLPreElement.cpp \
+	DerivedSources/WebCore/V8HTMLPreElement.h \
+	DerivedSources/WebCore/V8HTMLProgressElement.cpp \
+	DerivedSources/WebCore/V8HTMLProgressElement.h \
+	DerivedSources/WebCore/V8HTMLQuoteElement.cpp \
+	DerivedSources/WebCore/V8HTMLQuoteElement.h \
+	DerivedSources/WebCore/V8HTMLScriptElement.cpp \
+	DerivedSources/WebCore/V8HTMLScriptElement.h \
+	DerivedSources/WebCore/V8HTMLSelectElement.cpp \
+	DerivedSources/WebCore/V8HTMLSelectElement.h \
+	DerivedSources/WebCore/V8HTMLSourceElement.cpp \
+	DerivedSources/WebCore/V8HTMLSourceElement.h \
+	DerivedSources/WebCore/V8HTMLSpanElement.cpp \
+	DerivedSources/WebCore/V8HTMLSpanElement.h \
+	DerivedSources/WebCore/V8HTMLStyleElement.cpp \
+	DerivedSources/WebCore/V8HTMLStyleElement.h \
+	DerivedSources/WebCore/V8HTMLTableCaptionElement.cpp \
+	DerivedSources/WebCore/V8HTMLTableCaptionElement.h \
+	DerivedSources/WebCore/V8HTMLTableCellElement.cpp \
+	DerivedSources/WebCore/V8HTMLTableCellElement.h \
+	DerivedSources/WebCore/V8HTMLTableColElement.cpp \
+	DerivedSources/WebCore/V8HTMLTableColElement.h \
+	DerivedSources/WebCore/V8HTMLTableElement.cpp \
+	DerivedSources/WebCore/V8HTMLTableElement.h \
+	DerivedSources/WebCore/V8HTMLTableRowElement.cpp \
+	DerivedSources/WebCore/V8HTMLTableRowElement.h \
+	DerivedSources/WebCore/V8HTMLTableSectionElement.cpp \
+	DerivedSources/WebCore/V8HTMLTableSectionElement.h \
+	DerivedSources/WebCore/V8HTMLTextAreaElement.cpp \
+	DerivedSources/WebCore/V8HTMLTextAreaElement.h \
+	DerivedSources/WebCore/V8HTMLTitleElement.cpp \
+	DerivedSources/WebCore/V8HTMLTitleElement.h \
+	DerivedSources/WebCore/V8HTMLTrackElement.cpp \
+	DerivedSources/WebCore/V8HTMLTrackElement.h \
+	DerivedSources/WebCore/V8HTMLUnknownElement.cpp \
+	DerivedSources/WebCore/V8HTMLUnknownElement.h \
+	DerivedSources/WebCore/V8HTMLUListElement.cpp \
+	DerivedSources/WebCore/V8HTMLUListElement.h \
+	DerivedSources/WebCore/V8HTMLVideoElement.cpp \
+	DerivedSources/WebCore/V8HTMLVideoElement.h \
+	DerivedSources/WebCore/V8ImageData.cpp \
+	DerivedSources/WebCore/V8ImageData.h \
+	DerivedSources/WebCore/V8InjectedScriptHost.cpp \
+	DerivedSources/WebCore/V8InjectedScriptHost.h \
+	DerivedSources/WebCore/V8InspectorFrontendHost.cpp \
+	DerivedSources/WebCore/V8InspectorFrontendHost.h \
+	DerivedSources/WebCore/V8Int16Array.cpp \
+	DerivedSources/WebCore/V8Int16Array.h \
+	DerivedSources/WebCore/V8Int32Array.cpp \
+	DerivedSources/WebCore/V8Int32Array.h \
+	DerivedSources/WebCore/V8Int8Array.cpp \
+	DerivedSources/WebCore/V8Int8Array.h \
+	DerivedSources/WebCore/V8JavaScriptCallFrame.cpp \
+	DerivedSources/WebCore/V8JavaScriptCallFrame.h \
+	DerivedSources/WebCore/V8KeyboardEvent.cpp \
+	DerivedSources/WebCore/V8KeyboardEvent.h \
+	DerivedSources/WebCore/V8LocalMediaStream.cpp \
+	DerivedSources/WebCore/V8LocalMediaStream.h \
+	DerivedSources/WebCore/V8Location.cpp \
+	DerivedSources/WebCore/V8Location.h \
+	DerivedSources/WebCore/V8MediaError.cpp \
+	DerivedSources/WebCore/V8MediaError.h \
+	DerivedSources/WebCore/V8MediaList.cpp \
+	DerivedSources/WebCore/V8MediaList.h \
+	DerivedSources/WebCore/V8MediaStream.cpp \
+	DerivedSources/WebCore/V8MediaStream.h \
+	DerivedSources/WebCore/V8MediaStreamEvent.cpp \
+	DerivedSources/WebCore/V8MediaStreamEvent.h \
+	DerivedSources/WebCore/V8MediaStreamList.cpp \
+	DerivedSources/WebCore/V8MediaStreamList.h \
+	DerivedSources/WebCore/V8MediaStreamTrack.cpp \
+	DerivedSources/WebCore/V8MediaStreamTrack.h \
+	DerivedSources/WebCore/V8MediaStreamTrackList.cpp \
+	DerivedSources/WebCore/V8MediaStreamTrackList.h \
+	DerivedSources/WebCore/V8MediaQueryList.cpp \
+	DerivedSources/WebCore/V8MediaQueryList.h \
+	DerivedSources/WebCore/V8MemoryInfo.cpp \
+	DerivedSources/WebCore/V8MemoryInfo.h \
+	DerivedSources/WebCore/V8MediaElementAudioSourceNode.h \
+	DerivedSources/WebCore/V8MediaElementAudioSourceNode.cpp \
+	DerivedSources/WebCore/V8MessageChannel.cpp \
+	DerivedSources/WebCore/V8MessageChannel.h \
+	DerivedSources/WebCore/V8MessageEvent.cpp \
+	DerivedSources/WebCore/V8MessageEvent.h \
+	DerivedSources/WebCore/V8MessagePort.cpp \
+	DerivedSources/WebCore/V8MessagePort.h \
+	DerivedSources/WebCore/V8MouseEvent.cpp \
+	DerivedSources/WebCore/V8MouseEvent.h \
+	DerivedSources/WebCore/V8MutationEvent.cpp \
+	DerivedSources/WebCore/V8MutationEvent.h \
+	DerivedSources/WebCore/V8NamedNodeMap.cpp \
+	DerivedSources/WebCore/V8NamedNodeMap.h \
+	DerivedSources/WebCore/V8PerformanceNavigation.cpp \
+	DerivedSources/WebCore/V8PerformanceNavigation.h \
+	DerivedSources/WebCore/V8Navigator.cpp \
+	DerivedSources/WebCore/V8Navigator.h \
+	DerivedSources/WebCore/V8NavigatorUserMediaError.cpp \
+	DerivedSources/WebCore/V8NavigatorUserMediaError.h \
+	DerivedSources/WebCore/V8NavigatorUserMediaErrorCallback.cpp \
+	DerivedSources/WebCore/V8NavigatorUserMediaErrorCallback.h \
+	DerivedSources/WebCore/V8NavigatorUserMediaSuccessCallback.cpp \
+	DerivedSources/WebCore/V8NavigatorUserMediaSuccessCallback.h \
+	DerivedSources/WebCore/V8Node.cpp \
+	DerivedSources/WebCore/V8NodeFilter.cpp \
+	DerivedSources/WebCore/V8NodeFilter.h \
+	DerivedSources/WebCore/V8Node.h \
+	DerivedSources/WebCore/V8NodeIterator.cpp \
+	DerivedSources/WebCore/V8NodeIterator.h \
+	DerivedSources/WebCore/V8NodeList.cpp \
+	DerivedSources/WebCore/V8NodeList.h \
+	DerivedSources/WebCore/V8Notation.cpp \
+	DerivedSources/WebCore/V8Notation.h \
+	DerivedSources/WebCore/V8NotificationCenter.cpp \
+	DerivedSources/WebCore/V8NotificationCenter.h \
+	DerivedSources/WebCore/V8Notification.cpp \
+	DerivedSources/WebCore/V8Notification.h \
+	DerivedSources/WebCore/V8OESStandardDerivatives.cpp \
+	DerivedSources/WebCore/V8OESStandardDerivatives.h \
+	DerivedSources/WebCore/V8OESTextureFloat.cpp \
+	DerivedSources/WebCore/V8OESTextureFloat.h \
+	DerivedSources/WebCore/V8OESVertexArrayObject.cpp \
+	DerivedSources/WebCore/V8OESVertexArrayObject.h \
+	DerivedSources/WebCore/V8OperationNotAllowedException.cpp \
+	DerivedSources/WebCore/V8OperationNotAllowedException.h \
+	DerivedSources/WebCore/V8OverflowEvent.cpp \
+	DerivedSources/WebCore/V8OverflowEvent.h \
+	DerivedSources/WebCore/V8PageTransitionEvent.cpp \
+	DerivedSources/WebCore/V8PageTransitionEvent.h \
+	DerivedSources/WebCore/V8Performance.cpp \
+	DerivedSources/WebCore/V8Performance.h \
+	DerivedSources/WebCore/V8PeerConnection.cpp \
+	DerivedSources/WebCore/V8PeerConnection.h \
+	DerivedSources/WebCore/V8PopStateEvent.cpp \
+	DerivedSources/WebCore/V8PopStateEvent.h \
+	DerivedSources/WebCore/V8PositionCallback.cpp \
+	DerivedSources/WebCore/V8PositionCallback.h \
+	DerivedSources/WebCore/V8PositionError.cpp \
+	DerivedSources/WebCore/V8PositionError.h \
+	DerivedSources/WebCore/V8PositionErrorCallback.cpp \
+	DerivedSources/WebCore/V8PositionErrorCallback.h \
+	DerivedSources/WebCore/V8ProcessingInstruction.cpp \
+	DerivedSources/WebCore/V8ProcessingInstruction.h \
+	DerivedSources/WebCore/V8ProgressEvent.cpp \
+	DerivedSources/WebCore/V8ProgressEvent.h \
+	DerivedSources/WebCore/V8Range.cpp \
+	DerivedSources/WebCore/V8RangeException.cpp \
+	DerivedSources/WebCore/V8RangeException.h \
+	DerivedSources/WebCore/V8Range.h \
+	DerivedSources/WebCore/V8Rect.cpp \
+	DerivedSources/WebCore/V8Rect.h \
+	DerivedSources/WebCore/V8RGBColor.cpp \
+	DerivedSources/WebCore/V8RGBColor.h \
+	DerivedSources/WebCore/V8Screen.cpp \
+	DerivedSources/WebCore/V8Screen.h \
+	DerivedSources/WebCore/V8ScriptProfile.cpp \
+	DerivedSources/WebCore/V8ScriptProfile.h \
+	DerivedSources/WebCore/V8ScriptProfileNode.cpp \
+	DerivedSources/WebCore/V8ScriptProfileNode.h \
+	DerivedSources/WebCore/V8SharedWorkerContext.cpp \
+	DerivedSources/WebCore/V8SharedWorkerContext.h \
+	DerivedSources/WebCore/V8SharedWorker.cpp \
+	DerivedSources/WebCore/V8SharedWorker.h \
+	DerivedSources/WebCore/V8SignalingCallback.cpp \
+	DerivedSources/WebCore/V8SignalingCallback.h \
+	DerivedSources/WebCore/V8SpeechInputEvent.cpp \
+	DerivedSources/WebCore/V8SpeechInputEvent.h \
+	DerivedSources/WebCore/V8SpeechInputResult.cpp \
+	DerivedSources/WebCore/V8SpeechInputResult.h \
+	DerivedSources/WebCore/V8SpeechInputResultList.cpp \
+	DerivedSources/WebCore/V8SpeechInputResultList.h \
+	DerivedSources/WebCore/V8SQLException.h \
+	DerivedSources/WebCore/V8SQLResultSetRowList.h \
+	DerivedSources/WebCore/V8SQLTransaction.h \
+	DerivedSources/WebCore/V8SQLTransactionSync.h \
+	DerivedSources/WebCore/V8Storage.h \
+	DerivedSources/WebCore/V8StorageInfo.h \
+	DerivedSources/WebCore/V8StorageInfoErrorCallback.h \
+	DerivedSources/WebCore/V8StorageInfoQuotaCallback.h \
+	DerivedSources/WebCore/V8StorageInfoUsageCallback.h \
+	DerivedSources/WebCore/V8StyleMedia.cpp \
+	DerivedSources/WebCore/V8StyleMedia.h \
+	DerivedSources/WebCore/V8StyleSheet.cpp \
+	DerivedSources/WebCore/V8StyleSheet.h \
+	DerivedSources/WebCore/V8StyleSheetList.cpp \
+	DerivedSources/WebCore/V8StyleSheetList.h \
+	DerivedSources/WebCore/V8SVGElementWrapperFactory.cpp \
+	DerivedSources/WebCore/V8Text.cpp \
+	DerivedSources/WebCore/V8TextEvent.cpp \
+	DerivedSources/WebCore/V8TextEvent.h \
+	DerivedSources/WebCore/V8Text.h \
+	DerivedSources/WebCore/V8TextMetrics.cpp \
+	DerivedSources/WebCore/V8TextMetrics.h \
+	DerivedSources/WebCore/V8TimeRanges.cpp \
+	DerivedSources/WebCore/V8TimeRanges.h \
+	DerivedSources/WebCore/V8PerformanceTiming.cpp \
+	DerivedSources/WebCore/V8PerformanceTiming.h \
+	DerivedSources/WebCore/V8Touch.cpp \
+	DerivedSources/WebCore/V8TouchEvent.cpp \
+	DerivedSources/WebCore/V8TouchEvent.h \
+	DerivedSources/WebCore/V8Touch.h \
+	DerivedSources/WebCore/V8TouchList.cpp \
+	DerivedSources/WebCore/V8TouchList.h \
+	DerivedSources/WebCore/V8TreeWalker.cpp \
+	DerivedSources/WebCore/V8TreeWalker.h \
+	DerivedSources/WebCore/V8UIEvent.cpp \
+	DerivedSources/WebCore/V8UIEvent.h \
+	DerivedSources/WebCore/V8Uint16Array.cpp \
+	DerivedSources/WebCore/V8Uint16Array.h \
+	DerivedSources/WebCore/V8Uint32Array.cpp \
+	DerivedSources/WebCore/V8Uint32Array.h \
+	DerivedSources/WebCore/V8Uint8Array.cpp \
+	DerivedSources/WebCore/V8Uint8Array.h \
+	DerivedSources/WebCore/V8ValidityState.cpp \
+	DerivedSources/WebCore/V8ValidityState.h \
+	DerivedSources/WebCore/V8VoidCallback.cpp \
+	DerivedSources/WebCore/V8VoidCallback.h \
+	DerivedSources/WebCore/V8WaveShaperNode.h \
+	DerivedSources/WebCore/V8WaveShaperNode.cpp \
+	DerivedSources/WebCore/V8WebGLActiveInfo.cpp \
+	DerivedSources/WebCore/V8WebGLActiveInfo.h \
+	DerivedSources/WebCore/V8WebGLBuffer.cpp \
+	DerivedSources/WebCore/V8WebGLBuffer.h \
+	DerivedSources/WebCore/V8WebGLContextAttributes.cpp \
+	DerivedSources/WebCore/V8WebGLContextAttributes.h \
+	DerivedSources/WebCore/V8WebGLContextEvent.cpp \
+	DerivedSources/WebCore/V8WebGLContextEvent.h \
+	DerivedSources/WebCore/V8WebGLFramebuffer.cpp \
+	DerivedSources/WebCore/V8WebGLFramebuffer.h \
+	DerivedSources/WebCore/V8WebGLProgram.cpp \
+	DerivedSources/WebCore/V8WebGLProgram.h \
+	DerivedSources/WebCore/V8WebGLRenderbuffer.cpp \
+	DerivedSources/WebCore/V8WebGLRenderbuffer.h \
+	DerivedSources/WebCore/V8WebGLRenderingContext.cpp \
+	DerivedSources/WebCore/V8WebGLRenderingContext.h \
+	DerivedSources/WebCore/V8WebGLShader.cpp \
+	DerivedSources/WebCore/V8WebGLShader.h \
+	DerivedSources/WebCore/V8WebGLTexture.cpp \
+	DerivedSources/WebCore/V8WebGLTexture.h \
+	DerivedSources/WebCore/V8WebGLUniformLocation.cpp \
+	DerivedSources/WebCore/V8WebGLUniformLocation.h \
+	DerivedSources/WebCore/V8WebGLVertexArrayObjectOES.cpp \
+	DerivedSources/WebCore/V8WebGLVertexArrayObjectOES.h \
+	DerivedSources/WebCore/V8WebKitAnimation.cpp \
+	DerivedSources/WebCore/V8WebKitAnimation.h \
+	DerivedSources/WebCore/V8WebKitAnimationList.h \
+	DerivedSources/WebCore/V8WebKitAnimationEvent.cpp \
+	DerivedSources/WebCore/V8WebKitAnimationEvent.h \
+	DerivedSources/WebCore/V8WebKitAnimationList.cpp \
+	DerivedSources/WebCore/V8WebKitBlobBuilder.cpp \
+	DerivedSources/WebCore/V8WebKitBlobBuilder.h \
+	DerivedSources/WebCore/V8WebKitCSSKeyframeRule.cpp \
+	DerivedSources/WebCore/V8WebKitCSSKeyframeRule.h \
+	DerivedSources/WebCore/V8WebKitCSSKeyframesRule.cpp \
+	DerivedSources/WebCore/V8WebKitCSSKeyframesRule.h \
+	DerivedSources/WebCore/V8WebKitCSSMatrix.cpp \
+	DerivedSources/WebCore/V8WebKitCSSMatrix.h \
+	DerivedSources/WebCore/V8WebKitCSSTransformValue.cpp \
+	DerivedSources/WebCore/V8WebKitCSSTransformValue.h \
+	DerivedSources/WebCore/V8WebKitLoseContext.cpp \
+	DerivedSources/WebCore/V8WebKitLoseContext.h \
+	DerivedSources/WebCore/V8WebKitPoint.cpp \
+	DerivedSources/WebCore/V8WebKitPoint.h \
+	DerivedSources/WebCore/V8WebKitTransitionEvent.cpp \
+	DerivedSources/WebCore/V8WebKitTransitionEvent.h \
+	DerivedSources/WebCore/V8WheelEvent.cpp \
+	DerivedSources/WebCore/V8WheelEvent.h \
+	DerivedSources/WebCore/V8WorkerContext.cpp \
+	DerivedSources/WebCore/V8WorkerContext.h \
+	DerivedSources/WebCore/V8Worker.cpp \
+	DerivedSources/WebCore/V8Worker.h \
+	DerivedSources/WebCore/V8WorkerLocation.cpp \
+	DerivedSources/WebCore/V8WorkerLocation.h \
+	DerivedSources/WebCore/V8WorkerNavigator.cpp \
+	DerivedSources/WebCore/V8WorkerNavigator.h \
+	DerivedSources/WebCore/V8XMLHttpRequest.cpp \
+	DerivedSources/WebCore/V8XMLHttpRequestException.cpp \
+	DerivedSources/WebCore/V8XMLHttpRequestException.h \
+	DerivedSources/WebCore/V8XMLHttpRequest.h \
+	DerivedSources/WebCore/V8XMLHttpRequestProgressEvent.cpp \
+	DerivedSources/WebCore/V8XMLHttpRequestProgressEvent.h \
+	DerivedSources/WebCore/V8XMLHttpRequestUpload.cpp \
+	DerivedSources/WebCore/V8XMLHttpRequestUpload.h \
+	DerivedSources/WebCore/V8XMLSerializer.cpp \
+	DerivedSources/WebCore/V8XMLSerializer.h \
+	DerivedSources/WebCore/V8XSLTProcessor.cpp \
+	DerivedSources/WebCore/V8XSLTProcessor.h
+endif # END USE_V8
+
+
+if USE_V8
+webcore_sources += \
+	Source/WebCore/bindings/v8/DOMData.cpp \
+	Source/WebCore/bindings/v8/DOMData.h \
+	Source/WebCore/bindings/v8/DOMDataStore.cpp \
+	Source/WebCore/bindings/v8/DOMDataStore.h \
+	Source/WebCore/bindings/v8/DOMWrapperWorld.cpp \
+	Source/WebCore/bindings/v8/DOMWrapperWorld.h \
+	Source/WebCore/bindings/v8/DateExtension.cpp \
+	Source/WebCore/bindings/v8/DateExtension.h \
+	Source/WebCore/bindings/v8/IDBBindingUtilities.cpp \
+	Source/WebCore/bindings/v8/IDBBindingUtilities.h \
+	Source/WebCore/bindings/v8/IntrusiveDOMWrapperMap.h \
+	Source/WebCore/bindings/v8/IsolatedWorld.cpp \
+	Source/WebCore/bindings/v8/IsolatedWorld.h \
+	Source/WebCore/bindings/v8/JavaScriptCallFrame.cpp \
+	Source/WebCore/bindings/v8/JavaScriptCallFrame.h \
+	Source/WebCore/bindings/v8/NPV8Object.cpp \
+	Source/WebCore/bindings/v8/NPV8Object.h \
+	Source/WebCore/bindings/v8/OptionsObject.cpp \
+	Source/WebCore/bindings/v8/OptionsObject.h \
+	Source/WebCore/bindings/v8/OwnHandle.h \
+	Source/WebCore/bindings/v8/PageScriptDebugServer.cpp \
+	Source/WebCore/bindings/v8/PageScriptDebugServer.h \
+	Source/WebCore/bindings/v8/RetainedDOMInfo.cpp \
+	Source/WebCore/bindings/v8/RetainedDOMInfo.h \
+	Source/WebCore/bindings/v8/RetainedObjectInfo.h \
+	Source/WebCore/bindings/v8/ScheduledAction.cpp \
+	Source/WebCore/bindings/v8/ScheduledAction.h \
+	Source/WebCore/bindings/v8/ScopedDOMDataStore.cpp \
+	Source/WebCore/bindings/v8/ScopedDOMDataStore.h \
+	Source/WebCore/bindings/v8/ScriptCachedFrameData.cpp \
+	Source/WebCore/bindings/v8/ScriptCachedFrameData.h \
+	Source/WebCore/bindings/v8/ScriptCallStackFactory.cpp \
+	Source/WebCore/bindings/v8/ScriptCallStackFactory.h \
+	Source/WebCore/bindings/v8/ScriptController.cpp \
+	Source/WebCore/bindings/v8/ScriptController.h \
+	Source/WebCore/bindings/v8/ScriptDebugServer.cpp \
+	Source/WebCore/bindings/v8/ScriptDebugServer.h \
+	Source/WebCore/bindings/v8/ScriptEventListener.cpp \
+	Source/WebCore/bindings/v8/ScriptEventListener.h \
+	Source/WebCore/bindings/v8/ScriptFunctionCall.cpp \
+	Source/WebCore/bindings/v8/ScriptFunctionCall.h \
+	Source/WebCore/bindings/v8/ScriptGCEvent.cpp \
+	Source/WebCore/bindings/v8/ScriptGCEvent.h \
+	Source/WebCore/bindings/v8/ScriptHeapSnapshot.cpp \
+	Source/WebCore/bindings/v8/ScriptHeapSnapshot.h \
+	Source/WebCore/bindings/v8/ScriptInstance.cpp \
+	Source/WebCore/bindings/v8/ScriptInstance.h \
+	Source/WebCore/bindings/v8/ScriptObject.cpp \
+	Source/WebCore/bindings/v8/ScriptObject.h \
+	Source/WebCore/bindings/v8/ScriptProfile.cpp \
+	Source/WebCore/bindings/v8/ScriptProfile.h \
+	Source/WebCore/bindings/v8/ScriptProfileNode.cpp \
+	Source/WebCore/bindings/v8/ScriptProfileNode.h \
+	Source/WebCore/bindings/v8/ScriptProfiler.cpp \
+	Source/WebCore/bindings/v8/ScriptProfiler.h \
+	Source/WebCore/bindings/v8/ScriptScope.cpp \
+	Source/WebCore/bindings/v8/ScriptScope.h \
+	Source/WebCore/bindings/v8/ScriptSourceCode.h \
+	Source/WebCore/bindings/v8/ScriptState.cpp \
+	Source/WebCore/bindings/v8/ScriptState.h \
+	Source/WebCore/bindings/v8/ScriptValue.cpp \
+	Source/WebCore/bindings/v8/ScriptValue.h \
+	Source/WebCore/bindings/v8/ScriptWrappable.h \
+	Source/WebCore/bindings/v8/SerializedScriptValue.cpp \
+	Source/WebCore/bindings/v8/SerializedScriptValue.h \
+	Source/WebCore/bindings/v8/SharedPersistent.h \
+	Source/WebCore/bindings/v8/StaticDOMDataStore.cpp \
+	Source/WebCore/bindings/v8/StaticDOMDataStore.h \
+	Source/WebCore/bindings/v8/V8AbstractEventListener.cpp \
+	Source/WebCore/bindings/v8/V8AbstractEventListener.h \
+	Source/WebCore/bindings/v8/V8Binding.cpp \
+	Source/WebCore/bindings/v8/V8Binding.h \
+	Source/WebCore/bindings/v8/V8Collection.cpp \
+	Source/WebCore/bindings/v8/V8Collection.h \
+	Source/WebCore/bindings/v8/V8DOMMap.cpp \
+	Source/WebCore/bindings/v8/V8DOMMap.h \
+	Source/WebCore/bindings/v8/V8DOMWindowShell.cpp \
+	Source/WebCore/bindings/v8/V8DOMWindowShell.h \
+	Source/WebCore/bindings/v8/V8DOMWrapper.cpp \
+	Source/WebCore/bindings/v8/V8DOMWrapper.h \
+	Source/WebCore/bindings/v8/V8EventListener.cpp \
+	Source/WebCore/bindings/v8/V8EventListener.h \
+	Source/WebCore/bindings/v8/V8EventListenerList.cpp \
+	Source/WebCore/bindings/v8/V8EventListenerList.h \
+	Source/WebCore/bindings/v8/V8GCController.cpp \
+	Source/WebCore/bindings/v8/V8GCController.h \
+	Source/WebCore/bindings/v8/V8GCForContextDispose.cpp \
+	Source/WebCore/bindings/v8/V8GCForContextDispose.h \
+	Source/WebCore/bindings/v8/V8Helpers.cpp \
+	Source/WebCore/bindings/v8/V8Helpers.h \
+	Source/WebCore/bindings/v8/V8HiddenPropertyName.cpp \
+	Source/WebCore/bindings/v8/V8HiddenPropertyName.h \
+	Source/WebCore/bindings/v8/V8IsolatedContext.cpp \
+	Source/WebCore/bindings/v8/V8IsolatedContext.h \
+	Source/WebCore/bindings/v8/V8LazyEventListener.cpp \
+	Source/WebCore/bindings/v8/V8LazyEventListener.h \
+	Source/WebCore/bindings/v8/V8NPObject.cpp \
+	Source/WebCore/bindings/v8/V8NPObject.h \
+	Source/WebCore/bindings/v8/V8NPUtils.cpp \
+	Source/WebCore/bindings/v8/V8NPUtils.h \
+	Source/WebCore/bindings/v8/V8NodeFilterCondition.cpp \
+	Source/WebCore/bindings/v8/V8NodeFilterCondition.h \
+	Source/WebCore/bindings/v8/V8Proxy.cpp \
+	Source/WebCore/bindings/v8/V8Proxy.h \
+	Source/WebCore/bindings/v8/V8Utilities.cpp \
+	Source/WebCore/bindings/v8/V8Utilities.h \
+	Source/WebCore/bindings/v8/V8WindowErrorHandler.cpp \
+	Source/WebCore/bindings/v8/V8WindowErrorHandler.h \
+	Source/WebCore/bindings/v8/V8WorkerContextErrorHandler.cpp \
+	Source/WebCore/bindings/v8/V8WorkerContextErrorHandler.h \
+	Source/WebCore/bindings/v8/V8WorkerContextEventListener.cpp \
+	Source/WebCore/bindings/v8/V8WorkerContextEventListener.h \
+	Source/WebCore/bindings/v8/WorkerContextExecutionProxy.cpp \
+	Source/WebCore/bindings/v8/WorkerContextExecutionProxy.h \
+	Source/WebCore/bindings/v8/WorkerScriptController.cpp \
+	Source/WebCore/bindings/v8/WorkerScriptController.h \
+	Source/WebCore/bindings/v8/WorkerScriptDebugServer.cpp \
+	Source/WebCore/bindings/v8/WorkerScriptDebugServer.h \
+	Source/WebCore/bindings/v8/WorldContextHandle.cpp \
+	Source/WebCore/bindings/v8/WorldContextHandle.h \
+	Source/WebCore/bindings/v8/WrapperTypeInfo.h \
+	Source/WebCore/bindings/v8/custom/V8ArrayBufferCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8ArrayBufferViewCustom.h \
+	Source/WebCore/bindings/v8/custom/V8ArrayBufferViewCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8BindingMacros.h \
+	Source/WebCore/bindings/v8/custom/V8CSSRuleCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8CSSStyleDeclarationCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8CSSStyleSheetCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8CSSValueCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8CanvasPixelArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8CanvasRenderingContext2DCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8ClipboardCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8ConsoleCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8CoordinatesCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8CustomSQLStatementErrorCallback.cpp \
+	Source/WebCore/bindings/v8/custom/V8CustomVoidCallback.cpp \
+	Source/WebCore/bindings/v8/custom/V8CustomVoidCallback.h \
+	Source/WebCore/bindings/v8/custom/V8CustomXPathNSResolver.cpp \
+	Source/WebCore/bindings/v8/custom/V8CustomXPathNSResolver.h \
+	Source/WebCore/bindings/v8/custom/V8DOMFormDataCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DOMSettableTokenListCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DOMStringMapCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DOMTokenListCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DOMWindowCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DataViewCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DedicatedWorkerContextCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DeviceMotionEventCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DeviceOrientationEventCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DirectoryEntryCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DirectoryEntrySyncCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DocumentCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8DocumentLocationCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8ElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8EntryCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8EntrySyncCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8EventCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8FileReaderCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Float32ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Float64ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8GeolocationCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLAllCollectionCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.h \
+	Source/WebCore/bindings/v8/custom/V8HTMLCanvasElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLCollectionCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLDocumentCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLFormElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLFrameElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLFrameSetElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLImageElementConstructor.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLImageElementConstructor.h \
+	Source/WebCore/bindings/v8/custom/V8HTMLInputElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLLinkElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLOptionElementConstructor.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLOptionElementConstructor.h \
+	Source/WebCore/bindings/v8/custom/V8HTMLOptionsCollectionCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLOutputElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLPlugInElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLSelectElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8HTMLSelectElementCustom.h \
+	Source/WebCore/bindings/v8/custom/V8HistoryCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8IDBAnyCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8IDBKeyCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8ImageDataCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8InjectedScriptHostCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8InjectedScriptManager.cpp \
+	Source/WebCore/bindings/v8/custom/V8InspectorFrontendHostCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Int16ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Int32ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Int8ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8JavaScriptCallFrameCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8LocationCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8MessageChannelConstructor.cpp \
+	Source/WebCore/bindings/v8/custom/V8MessageEventCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8MessagePortCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8MessagePortCustom.h \
+	Source/WebCore/bindings/v8/custom/V8NamedNodeMapCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8NamedNodesCollection.cpp \
+	Source/WebCore/bindings/v8/custom/V8NamedNodesCollection.h \
+	Source/WebCore/bindings/v8/custom/V8NavigatorCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8NodeCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8NodeListCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8NotificationCenterCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8PerformanceCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8PeerConnectionCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8PopStateEventCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SQLResultSetRowListCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SQLTransactionCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SQLTransactionSyncCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SVGDocumentCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SVGElementCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SVGLengthCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SVGPathSegCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8ScriptProfileCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8ScriptProfileNodeCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8SharedWorkerCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8StorageCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8StyleSheetCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8StyleSheetListCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Uint16ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Uint32ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8Uint8ArrayCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8WebGLRenderingContextCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8WebKitAnimationCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8WebKitPointConstructor.cpp \
+	Source/WebCore/bindings/v8/custom/V8WebSocketCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8WorkerContextCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8WorkerCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8XMLHttpRequestConstructor.cpp \
+	Source/WebCore/bindings/v8/custom/V8XMLHttpRequestCustom.cpp \
+	Source/WebCore/bindings/v8/custom/V8XSLTProcessorCustom.cpp \
+	Source/WebCore/bindings/v8/npruntime.cpp \
+	Source/WebCore/bindings/v8/npruntime_priv.h \
+	Source/WebCore/bindings/v8/specialization/V8BindingState.cpp \
+	Source/WebCore/bindings/v8/specialization/V8BindingState.h \
+	Source/WebCore/platform/gtk/PlatformBridge.h \
+	Source/WebCore/platform/gtk/PlatformBridgeGtk.cpp \
+        Source/WebCore/bindings/v8/npruntime_impl.h
+endif # END USE_V8
diff --git a/Source/WebCore/accessibility/gtk/AXObjectCacheAtk.cpp b/Source/WebCore/accessibility/gtk/AXObjectCacheAtk.cpp
index d154769..4d61fe1 100644
--- a/Source/WebCore/accessibility/gtk/AXObjectCacheAtk.cpp
+++ b/Source/WebCore/accessibility/gtk/AXObjectCacheAtk.cpp
@@ -29,6 +29,8 @@
 #include "SelectElement.h"
 #include "TextIterator.h"
 
+#include <wtf/text/CString.h>
+
 namespace WebCore {
 
 void AXObjectCache::detachWrapper(AccessibilityObject* obj)
diff --git a/Source/WebCore/accessibility/gtk/WebKitAccessibleHyperlink.cpp b/Source/WebCore/accessibility/gtk/WebKitAccessibleHyperlink.cpp
index 26e7d4a..ab59960 100644
--- a/Source/WebCore/accessibility/gtk/WebKitAccessibleHyperlink.cpp
+++ b/Source/WebCore/accessibility/gtk/WebKitAccessibleHyperlink.cpp
@@ -35,6 +35,7 @@
 
 #include <atk/atk.h>
 #include <glib.h>
+#include <wtf/text/CString.h>
 
 using namespace WebCore;
 
diff --git a/Source/WebCore/bindings/scripts/CodeGeneratorGObject.pm b/Source/WebCore/bindings/scripts/CodeGeneratorGObject.pm
index 743c906..9a02ca4 100644
--- a/Source/WebCore/bindings/scripts/CodeGeneratorGObject.pm
+++ b/Source/WebCore/bindings/scripts/CodeGeneratorGObject.pm
@@ -484,7 +484,9 @@ EOF
     my $txtGetProp = << "EOF";
 static void ${lowerCaseIfaceName}_get_property(GObject* object, guint prop_id, GValue* value, GParamSpec* pspec)
 {
+#if USE(JSC)
     WebCore::JSMainThreadNullState state;
+#endif // END USE_JSC
 EOF
     push(@txtGetProps, $txtGetProp);
     if (scalar @readableProperties > 0) {
@@ -505,7 +507,9 @@ EOF
     my $txtSetProps = << "EOF";
 static void ${lowerCaseIfaceName}_set_property(GObject* object, guint prop_id, const GValue* value, GParamSpec* pspec)
 {
+#if USE(JSC)
     WebCore::JSMainThreadNullState state;
+#endif // END USE(JSC)
 EOF
     push(@txtSetProps, $txtSetProps);
 
@@ -823,7 +827,9 @@ sub GenerateFunction {
         push(@cBody, "    g_return_if_fail(self);\n");
     }
 
+    push(@cBody, "#if USE(JSC)\n");
     push(@cBody, "    WebCore::JSMainThreadNullState state;\n");
+    push(@cBody, "#endif // END USE_JSC\n");
 
     # The WebKit::core implementations check for NULL already; no need to
     # duplicate effort.
@@ -1286,7 +1292,7 @@ sub Generate {
     $implIncludes{"webkit/$className.h"} = 1;
     $implIncludes{"webkit/${className}Private.h"} = 1;
     $implIncludes{"${interfaceName}.h"} = 1;
-    $implIncludes{"JSMainThreadExecState.h"} = 1;
+    $implIncludes{"WTFString.h"} = 1;
     $implIncludes{"ExceptionCode.h"} = 1;
 
     $hdrIncludes{"webkit/${parentClassName}.h"} = 1;
@@ -1352,6 +1358,10 @@ sub WriteData {
     print IMPL "#include <wtf/RefPtr.h>\n";
     print IMPL map { "#include \"$_\"\n" } sort keys(%implIncludes);
     print IMPL "\n" if keys(%implIncludes);
+    print IMPL "#if USE(JSC)\n";
+    print IMPL "#include \"JSMainThreadExecState.h\"\n";
+    print IMPL "#endif // END USE_JSC\n";
+    print IMPL "\n";
     print IMPL @cBody;
 
     print IMPL "\n";
diff --git a/Source/WebCore/bindings/v8/ScriptCachedFrameData.cpp b/Source/WebCore/bindings/v8/ScriptCachedFrameData.cpp
index 967387c..9d0f1bc 100644
--- a/Source/WebCore/bindings/v8/ScriptCachedFrameData.cpp
+++ b/Source/WebCore/bindings/v8/ScriptCachedFrameData.cpp
@@ -26,7 +26,7 @@
 #include "config.h"
 #include "ScriptCachedFrameData.h"
 
-#if PLATFORM(QT)
+#if PLATFORM(QT) || PLATFORM(GTK)
 // FIXME: the right guard should be ENABLE(PAGE_CACHE). Replace with the right guard, once
 // https://bugs.webkit.org/show_bug.cgi?id=35061 is fixed.
 
@@ -76,4 +76,4 @@ void ScriptCachedFrameData::clear()
 
 } // namespace WebCore
 
-#endif // PLATFORM(QT)
+#endif // PLATFORM(QT) || PLATFORM(GTK)
diff --git a/Source/WebCore/bindings/v8/ScriptCachedFrameData.h b/Source/WebCore/bindings/v8/ScriptCachedFrameData.h
index 1e3a2f6..c336a18 100644
--- a/Source/WebCore/bindings/v8/ScriptCachedFrameData.h
+++ b/Source/WebCore/bindings/v8/ScriptCachedFrameData.h
@@ -51,7 +51,7 @@ public:
 
 } // namespace WebCore
 
-#elif PLATFORM(QT)
+#elif PLATFORM(QT) || PLATFORM(GTK)
 // FIXME: the right guard should be ENABLE(PAGE_CACHE). Replace with the right guard, once
 // https://bugs.webkit.org/show_bug.cgi?id=35061 is fixed.
 
diff --git a/Source/WebCore/bindings/v8/V8DOMWrapper.cpp b/Source/WebCore/bindings/v8/V8DOMWrapper.cpp
index 99fb3f7..fe1aeee 100644
--- a/Source/WebCore/bindings/v8/V8DOMWrapper.cpp
+++ b/Source/WebCore/bindings/v8/V8DOMWrapper.cpp
@@ -48,13 +48,9 @@
 #include "V8EventListenerList.h"
 #include "V8EventSource.h"
 #include "V8FileReader.h"
-#include "V8FileWriter.h"
 #include "V8HTMLCollection.h"
 #include "V8HTMLDocument.h"
 #include "V8HiddenPropertyName.h"
-#include "V8IDBDatabase.h"
-#include "V8IDBRequest.h"
-#include "V8IDBTransaction.h"
 #include "V8IsolatedContext.h"
 #include "V8LocalMediaStream.h"
 #include "V8Location.h"
@@ -70,7 +66,6 @@
 #include "V8SharedWorker.h"
 #include "V8SharedWorkerContext.h"
 #include "V8StyleSheet.h"
-#include "V8WebSocket.h"
 #include "V8Worker.h"
 #include "V8WorkerContext.h"
 #include "V8WorkerContextEventListener.h"
@@ -80,6 +75,16 @@
 #include "WorkerContextExecutionProxy.h"
 #include "WrapperTypeInfo.h"
 
+#if ENABLE(FILE_SYSTEM)
+#include "V8FileWriter.h"
+#endif
+
+#if ENABLE(INDEXED_DATABASE)
+#include "V8IDBDatabase.h"
+#include "V8IDBRequest.h"
+#include "V8IDBTransaction.h"
+#endif
+
 #if ENABLE(SVG)
 #include "SVGElementInstance.h"
 #include "SVGPathSeg.h"
@@ -91,6 +96,10 @@
 #include "V8JavaScriptAudioNode.h"
 #endif
 
+#if ENABLE(WEB_SOCKETS)
+#include "V8WebSocket.h"
+#endif
+
 #include <algorithm>
 #include <utility>
 #include <v8-debug.h>
diff --git a/Source/WebCore/bindings/v8/V8GCController.cpp b/Source/WebCore/bindings/v8/V8GCController.cpp
index 1005c8c..f874bbd 100644
--- a/Source/WebCore/bindings/v8/V8GCController.cpp
+++ b/Source/WebCore/bindings/v8/V8GCController.cpp
@@ -463,7 +463,7 @@ void V8GCController::gcEpilogue()
 
 void V8GCController::checkMemoryUsage()
 {
-#if PLATFORM(CHROMIUM) || PLATFORM(QT) && !OS(SYMBIAN)
+#if PLATFORM(CHROMIUM) || PLATFORM(QT) && !OS(SYMBIAN) || PLATFORM(GTK)
     const int lowMemoryUsageMB = PlatformSupport::lowMemoryUsageMB();
     const int highMemoryUsageMB = PlatformSupport::highMemoryUsageMB();
     const int highUsageDeltaMB = PlatformSupport::highUsageDeltaMB();
diff --git a/Source/WebCore/bindings/v8/V8Proxy.cpp b/Source/WebCore/bindings/v8/V8Proxy.cpp
index ab1df4f..4ec85bc 100644
--- a/Source/WebCore/bindings/v8/V8Proxy.cpp
+++ b/Source/WebCore/bindings/v8/V8Proxy.cpp
@@ -57,7 +57,6 @@
 #include "V8DOMMap.h"
 #include "V8DOMWindow.h"
 #include "V8EventException.h"
-#include "V8FileException.h"
 #include "V8HiddenPropertyName.h"
 #include "V8IsolatedContext.h"
 #include "V8OperationNotAllowedException.h"
@@ -68,6 +67,10 @@
 #include "WorkerContext.h"
 #include "WorkerContextExecutionProxy.h"
 
+#if ENABLE(BLOB) || ENABLE(FILE_SYSTEM)
+#include "V8FileException.h"
+#endif
+
 #if ENABLE(INDEXED_DATABASE)
 #include "V8IDBDatabaseException.h"
 #endif
diff --git a/Source/WebCore/bindings/v8/custom/V8DirectoryEntryCustom.cpp b/Source/WebCore/bindings/v8/custom/V8DirectoryEntryCustom.cpp
index 0889451..d0428fe 100644
--- a/Source/WebCore/bindings/v8/custom/V8DirectoryEntryCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8DirectoryEntryCustom.cpp
@@ -29,10 +29,11 @@
  */
 
 #include "config.h"
-#include "V8DirectoryEntry.h"
 
 #if ENABLE(FILE_SYSTEM)
 
+#include "V8DirectoryEntry.h"
+
 #include "DirectoryEntry.h"
 #include "ExceptionCode.h"
 #include "V8Binding.h"
diff --git a/Source/WebCore/bindings/v8/custom/V8DirectoryEntrySyncCustom.cpp b/Source/WebCore/bindings/v8/custom/V8DirectoryEntrySyncCustom.cpp
index cd38ca4..b27a11a 100644
--- a/Source/WebCore/bindings/v8/custom/V8DirectoryEntrySyncCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8DirectoryEntrySyncCustom.cpp
@@ -29,10 +29,11 @@
  */
 
 #include "config.h"
-#include "V8DirectoryEntrySync.h"
 
 #if ENABLE(FILE_SYSTEM)
 
+#include "V8DirectoryEntrySync.h"
+
 #include "DirectoryEntrySync.h"
 #include "ExceptionCode.h"
 #include "V8Binding.h"
diff --git a/Source/WebCore/bindings/v8/custom/V8EventCustom.cpp b/Source/WebCore/bindings/v8/custom/V8EventCustom.cpp
index ec3aae0..a1cdc1e 100644
--- a/Source/WebCore/bindings/v8/custom/V8EventCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8EventCustom.cpp
@@ -45,7 +45,6 @@
 #include "V8DeviceOrientationEvent.h"
 #include "V8ErrorEvent.h"
 #include "V8HashChangeEvent.h"
-#include "V8IDBVersionChangeEvent.h"
 #include "V8KeyboardEvent.h"
 #include "V8MessageEvent.h"
 #include "V8MouseEvent.h"
@@ -55,7 +54,6 @@
 #include "V8PopStateEvent.h"
 #include "V8ProgressEvent.h"
 #include "V8Proxy.h"
-#include "V8SpeechInputEvent.h"
 #include "V8StorageEvent.h"
 #include "V8TextEvent.h"
 #include "V8TouchEvent.h"
@@ -65,6 +63,10 @@
 #include "V8WheelEvent.h"
 #include "V8XMLHttpRequestProgressEvent.h"
 
+#if ENABLE(INDEXED_DATABASE)
+#include "V8IDBVersionChangeEvent.h"
+#endif
+
 #if ENABLE(SVG)
 #include "V8SVGZoomEvent.h"
 #endif
@@ -78,6 +80,10 @@
 #include "V8MediaStreamEvent.h"
 #endif
 
+#if ENABLE(INPUT_SPEECH)
+#include "V8SpeechInputEvent.h"
+#endif
+
 namespace WebCore {
 
 void V8Event::valueAccessorSetter(v8::Local<v8::String> name, v8::Local<v8::Value> value, const v8::AccessorInfo& info)
diff --git a/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.cpp b/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.cpp
index 7ed7cba..956fc64 100644
--- a/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.cpp
@@ -29,6 +29,9 @@
  */
 
 #include "config.h"
+
+#if ENABLE(VIDEO)
+
 #include "V8HTMLAudioElementConstructor.h"
 
 #include "HTMLAudioElement.h"
@@ -96,3 +99,5 @@ v8::Persistent<v8::FunctionTemplate> V8HTMLAudioElementConstructor::GetTemplate(
 }
 
 } // namespace WebCore
+
+#endif // ENABLE(VIDEO)
diff --git a/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.h b/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.h
index 8bc5f2c..8c0397a 100644
--- a/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.h
+++ b/Source/WebCore/bindings/v8/custom/V8HTMLAudioElementConstructor.h
@@ -31,6 +31,8 @@
 #ifndef V8HTMLAudioElementConstructor_h
 #define V8HTMLAudioElementConstructor_h
 
+#if ENABLE(VIDEO)
+
 #include "WrapperTypeInfo.h"
 
 #include <v8.h>
@@ -45,4 +47,6 @@ public:
 
 }
 
+#endif // ENABLE(VIDEO)
+
 #endif // V8HTMLAudioElementConstructor_h
diff --git a/Source/WebCore/bindings/v8/custom/V8InspectorFrontendHostCustom.cpp b/Source/WebCore/bindings/v8/custom/V8InspectorFrontendHostCustom.cpp
index 431e4e5..097d7d6 100644
--- a/Source/WebCore/bindings/v8/custom/V8InspectorFrontendHostCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8InspectorFrontendHostCustom.cpp
@@ -35,7 +35,7 @@
 #include "InspectorController.h"
 #include "InspectorFrontendClient.h"
 #include "InspectorFrontendHost.h"
-#if !PLATFORM(QT)
+#if !PLATFORM(QT) && !PLATFORM(GTK)
 #include "PlatformSupport.h"
 #endif
 #include "PlatformString.h"
@@ -117,7 +117,7 @@ v8::Handle<v8::Value> V8InspectorFrontendHost::showContextMenuCallback(const v8:
     return v8::Undefined();
 }
 
-#if !PLATFORM(QT)
+#if !PLATFORM(QT) && !PLATFORM(GTK)
 static v8::Handle<v8::Value> histogramEnumeration(const char* name, const v8::Arguments& args, int boundaryValue)
 {
     if (args.Length() < 1 || !args[0]->IsInt32())
@@ -133,7 +133,7 @@ static v8::Handle<v8::Value> histogramEnumeration(const char* name, const v8::Ar
 
 v8::Handle<v8::Value> V8InspectorFrontendHost::recordActionTakenCallback(const v8::Arguments& args)
 {
-#if !PLATFORM(QT)
+#if !PLATFORM(QT) && !PLATFORM(GTK)
     return histogramEnumeration("DevTools.ActionTaken", args, 100);
 #else
     return v8::Undefined();
@@ -142,7 +142,7 @@ v8::Handle<v8::Value> V8InspectorFrontendHost::recordActionTakenCallback(const v
 
 v8::Handle<v8::Value> V8InspectorFrontendHost::recordPanelShownCallback(const v8::Arguments& args)
 {
-#if !PLATFORM(QT)
+#if !PLATFORM(QT) && !PLATFORM(GTK)
     return histogramEnumeration("DevTools.PanelShown", args, 20);
 #else
     return v8::Undefined();
@@ -151,7 +151,7 @@ v8::Handle<v8::Value> V8InspectorFrontendHost::recordPanelShownCallback(const v8
 
 v8::Handle<v8::Value> V8InspectorFrontendHost::recordSettingChangedCallback(const v8::Arguments& args)
 {
-#if !PLATFORM(QT)
+#if !PLATFORM(QT) && !PLATFORM(GTK)
     return histogramEnumeration("DevTools.SettingChanged", args, 100);
 #else
     return v8::Undefined();
diff --git a/Source/WebCore/bindings/v8/custom/V8ScriptProfileCustom.cpp b/Source/WebCore/bindings/v8/custom/V8ScriptProfileCustom.cpp
index ddaabb0..51aa9ac 100644
--- a/Source/WebCore/bindings/v8/custom/V8ScriptProfileCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8ScriptProfileCustom.cpp
@@ -29,6 +29,9 @@
  */
 
 #include "config.h"
+
+#if ENABLE(JAVASCRIPT_DEBUGGER)
+
 #include "V8ScriptProfile.h"
 
 #include "ScriptProfile.h"
@@ -59,3 +62,5 @@ v8::Handle<v8::Value> toV8(ScriptProfile* impl)
 }
 
 } // namespace WebCore
+
+#endif
diff --git a/Source/WebCore/bindings/v8/custom/V8ScriptProfileNodeCustom.cpp b/Source/WebCore/bindings/v8/custom/V8ScriptProfileNodeCustom.cpp
index a4deeeb..d289222 100644
--- a/Source/WebCore/bindings/v8/custom/V8ScriptProfileNodeCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8ScriptProfileNodeCustom.cpp
@@ -29,6 +29,8 @@
  */
 
 #include "config.h"
+
+#if ENABLE(JAVASCRIPT_DEBUGGER)
 #include "V8ScriptProfileNode.h"
 
 #include "ScriptProfileNode.h"
@@ -79,3 +81,5 @@ v8::Handle<v8::Value> toV8(ScriptProfileNode* impl)
 }
 
 } // namespace WebCore
+
+#endif
diff --git a/Source/WebCore/bindings/v8/custom/V8WebGLRenderingContextCustom.cpp b/Source/WebCore/bindings/v8/custom/V8WebGLRenderingContextCustom.cpp
index d9e1fd9..6001d22 100644
--- a/Source/WebCore/bindings/v8/custom/V8WebGLRenderingContextCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8WebGLRenderingContextCustom.cpp
@@ -34,6 +34,8 @@
 
 #include "V8WebGLRenderingContext.h"
 
+#include "WebGLExtension.h"
+
 #include "ExceptionCode.h"
 #include "NotImplemented.h"
 #include "V8ArrayBufferView.h"
diff --git a/Source/WebCore/bindings/v8/custom/V8XSLTProcessorCustom.cpp b/Source/WebCore/bindings/v8/custom/V8XSLTProcessorCustom.cpp
index 1ad52d1..680c7a1 100644
--- a/Source/WebCore/bindings/v8/custom/V8XSLTProcessorCustom.cpp
+++ b/Source/WebCore/bindings/v8/custom/V8XSLTProcessorCustom.cpp
@@ -29,6 +29,9 @@
  */
 
 #include "config.h"
+
+#if ENABLE(XSLT)
+
 #include "V8XSLTProcessor.h"
 
 #include "Document.h"
@@ -145,3 +148,5 @@ v8::Handle<v8::Value> V8XSLTProcessor::removeParameterCallback(const v8::Argumen
 }
 
 } // namespace WebCore
+
+#endif // ENABLE(XSLT)
diff --git a/Source/WebCore/dom/CustomEvent.idl b/Source/WebCore/dom/CustomEvent.idl
index 3152a36..7d2c7a4 100644
--- a/Source/WebCore/dom/CustomEvent.idl
+++ b/Source/WebCore/dom/CustomEvent.idl
@@ -29,8 +29,7 @@ module events {
     // Introduced in DOM Level 3:
     interface [
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] CustomEvent : Event {
 
        readonly attribute DOMObject detail;
diff --git a/Source/WebCore/dom/ErrorEvent.idl b/Source/WebCore/dom/ErrorEvent.idl
index 24ae602..384decd 100644
--- a/Source/WebCore/dom/ErrorEvent.idl
+++ b/Source/WebCore/dom/ErrorEvent.idl
@@ -33,8 +33,7 @@ module events {
     interface [
         NoStaticTables,
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] ErrorEvent : Event {
 
         readonly attribute DOMString message;
diff --git a/Source/WebCore/dom/Event.idl b/Source/WebCore/dom/Event.idl
index ec91a15..c67e596 100644
--- a/Source/WebCore/dom/Event.idl
+++ b/Source/WebCore/dom/Event.idl
@@ -25,7 +25,6 @@ module events {
         CustomToJS,
         CanBeConstructed,
         CustomConstructFunction,
-        V8CustomConstructor,
         NoStaticTables,
         Polymorphic
     ] Event {
diff --git a/Source/WebCore/dom/HashChangeEvent.idl b/Source/WebCore/dom/HashChangeEvent.idl
index 13069ec..8a14ec8 100644
--- a/Source/WebCore/dom/HashChangeEvent.idl
+++ b/Source/WebCore/dom/HashChangeEvent.idl
@@ -22,8 +22,7 @@ module events {
     // Introduced in http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html#event-hashchange
     interface [
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] HashChangeEvent : Event {
         void initHashChangeEvent(in [Optional=CallWithDefaultValue] DOMString type, 
                                  in [Optional=CallWithDefaultValue] boolean canBubble, 
diff --git a/Source/WebCore/dom/PageTransitionEvent.idl b/Source/WebCore/dom/PageTransitionEvent.idl
index 90f31e5..dab23ae 100644
--- a/Source/WebCore/dom/PageTransitionEvent.idl
+++ b/Source/WebCore/dom/PageTransitionEvent.idl
@@ -27,8 +27,7 @@ module events {
 
     interface [
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] PageTransitionEvent : Event {
 
         readonly attribute boolean persisted;
diff --git a/Source/WebCore/dom/PopStateEvent.idl b/Source/WebCore/dom/PopStateEvent.idl
index bfeda46..f288bcb 100644
--- a/Source/WebCore/dom/PopStateEvent.idl
+++ b/Source/WebCore/dom/PopStateEvent.idl
@@ -29,8 +29,7 @@ module events {
 #if !defined(LANGUAGE_CPP) || !LANGUAGE_CPP
     interface [
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] PopStateEvent : Event {
         void initPopStateEvent(in [Optional=CallWithDefaultValue] DOMString typeArg, 
                                in [Optional=CallWithDefaultValue] boolean canBubbleArg, 
diff --git a/Source/WebCore/dom/ProgressEvent.idl b/Source/WebCore/dom/ProgressEvent.idl
index b00d036..5937832 100644
--- a/Source/WebCore/dom/ProgressEvent.idl
+++ b/Source/WebCore/dom/ProgressEvent.idl
@@ -27,8 +27,7 @@ module events {
 
     interface [
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] ProgressEvent : Event {
         readonly attribute boolean lengthComputable;
         readonly attribute unsigned long long loaded;
diff --git a/Source/WebCore/dom/WebKitAnimationEvent.idl b/Source/WebCore/dom/WebKitAnimationEvent.idl
index 16d062f..496acf2 100644
--- a/Source/WebCore/dom/WebKitAnimationEvent.idl
+++ b/Source/WebCore/dom/WebKitAnimationEvent.idl
@@ -27,8 +27,7 @@ module events {
 
     interface [
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] WebKitAnimationEvent : Event {
      readonly attribute DOMString          animationName;
      readonly attribute double             elapsedTime;
diff --git a/Source/WebCore/editing/TextIterator.cpp b/Source/WebCore/editing/TextIterator.cpp
index c4542b0..865d4ff 100644
--- a/Source/WebCore/editing/TextIterator.cpp
+++ b/Source/WebCore/editing/TextIterator.cpp
@@ -48,6 +48,7 @@
 #if USE(ICU_UNICODE) && !UCONFIG_NO_COLLATION
 #include "TextBreakIteratorInternalICU.h"
 #include <unicode/usearch.h>
+#include <wtf/text/CString.h>
 #endif
 
 using namespace WTF::Unicode;
diff --git a/Source/WebCore/editing/gtk/FrameSelectionGtk.cpp b/Source/WebCore/editing/gtk/FrameSelectionGtk.cpp
index a327e06..d72e9a0 100644
--- a/Source/WebCore/editing/gtk/FrameSelectionGtk.cpp
+++ b/Source/WebCore/editing/gtk/FrameSelectionGtk.cpp
@@ -22,6 +22,7 @@
 
 #include "AccessibilityObjectWrapperAtk.h"
 #include "AXObjectCache.h"
+#include "Document.h"
 #include "Frame.h"
 #include "RefPtr.h"
 
diff --git a/Source/WebCore/p2p/PeerConnection.cpp b/Source/WebCore/p2p/PeerConnection.cpp
index bda3ee3..cda0e20 100644
--- a/Source/WebCore/p2p/PeerConnection.cpp
+++ b/Source/WebCore/p2p/PeerConnection.cpp
@@ -38,6 +38,8 @@
 #include "ScriptExecutionContext.h"
 #include "SignalingCallback.h"
 
+#include <wtf/text/CString.h>
+
 namespace WebCore {
 
 PassRefPtr<PeerConnection> PeerConnection::create(MediaStreamFrameController* frameController, int id, const String& configuration, PassRefPtr<SignalingCallback> signalingCallback)
diff --git a/Source/WebCore/p2p/SignalingCallback.h b/Source/WebCore/p2p/SignalingCallback.h
index a4a30e7..8f99461 100644
--- a/Source/WebCore/p2p/SignalingCallback.h
+++ b/Source/WebCore/p2p/SignalingCallback.h
@@ -27,6 +27,9 @@
 
 #if ENABLE(MEDIA_STREAM)
 
+#include "EventTarget.h"
+#include "MediaStreamFrameController.h"
+#include <wtf/PassRefPtr.h>
 #include <wtf/RefCounted.h>
 
 namespace WebCore {
diff --git a/Source/WebCore/platform/graphics/opengl/GraphicsContext3DOpenGL.cpp b/Source/WebCore/platform/graphics/opengl/GraphicsContext3DOpenGL.cpp
index e4b338a..20ebf6e 100644
--- a/Source/WebCore/platform/graphics/opengl/GraphicsContext3DOpenGL.cpp
+++ b/Source/WebCore/platform/graphics/opengl/GraphicsContext3DOpenGL.cpp
@@ -47,6 +47,8 @@
 #include "NotImplemented.h"
 #include "Uint8Array.h"
 #include <cstring>
+#include <wtf/OwnArrayPtr.h>
+#include <wtf/PassOwnArrayPtr.h>
 #include <wtf/UnusedParam.h>
 #include <wtf/text/CString.h>
 
diff --git a/Source/WebCore/platform/gtk/PlatformBridge.h b/Source/WebCore/platform/gtk/PlatformBridge.h
new file mode 100644
index 0000000..f850fa0
--- /dev/null
+++ b/Source/WebCore/platform/gtk/PlatformBridge.h
@@ -0,0 +1,108 @@
+/*
+ * Copyright 2009, 2010, The Android Open Source Project
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *  * Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ *  * Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
+ * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
+ * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
+ * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
+ * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+ * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
+
+#ifndef PlatformBridge_h
+#define PlatformBridge_h
+
+#include "KURL.h"
+#include "PlatformString.h"
+
+#include <wtf/Vector.h>
+
+// V8 bindings use the ARRAYSIZE_UNSAFE macro. This macro was copied
+// from http://src.chromium.org/viewvc/chrome/trunk/src/base/basictypes.h
+//
+// ARRAYSIZE_UNSAFE performs essentially the same calculation as arraysize,
+// but can be used on anonymous types or types defined inside
+// functions. It's less safe than arraysize as it accepts some
+// (although not all) pointers. Therefore, you should use arraysize
+// whenever possible.
+//
+// The expression ARRAYSIZE_UNSAFE(a) is a compile-time constant of type
+// size_t.
+//
+// ARRAYSIZE_UNSAFE catches a few type errors. If you see a compiler error
+//
+//   "warning: division by zero in ..."
+//
+// when using ARRAYSIZE_UNSAFE, you are (wrongfully) giving it a pointer.
+// You should only use ARRAYSIZE_UNSAFE on statically allocated arrays.
+//
+// The following comments are on the implementation details, and can
+// be ignored by the users.
+//
+// ARRAYSIZE_UNSAFE(arr) works by inspecting sizeof(arr) (the # of bytes in
+// the array) and sizeof(*(arr)) (the # of bytes in one array
+// element). If the former is divisible by the latter, perhaps arr is
+// indeed an array, in which case the division result is the # of
+// elements in the array. Otherwise, arr cannot possibly be an array,
+// and we generate a compiler error to prevent the code from
+// compiling.
+//
+// Since the size of bool is implementation-defined, we need to cast
+// !(sizeof(a) & sizeof(*(a))) to size_t in order to ensure the final
+// result has type size_t.
+//
+// This macro is not perfect as it wrongfully accepts certain
+// pointers, namely where the pointer size is divisible by the pointee
+// size. Since all our code has to go through a 32-bit compiler,
+// where a pointer is 4 bytes, this means all pointers to a type whose
+// size is 3 or greater than 4 will be (righteously) rejected.
+
+#define ARRAYSIZE_UNSAFE(a) \
+    ((sizeof(a) / sizeof(*(a))) / \
+    static_cast<size_t>(!(sizeof(a) % sizeof(*(a)))))
+
+
+typedef struct NPObject NPObject;
+typedef struct _NPP NPP_t;
+typedef NPP_t* NPP;
+
+namespace WebCore {
+
+class Widget;
+
+// An interface to the embedding layer, which has the ability to answer
+// questions about the system and so on...
+// This is very similar to chromium/PlatformBridge and the two are likely to converge
+// in the future.
+class PlatformBridge {
+public:
+    static bool popupsAllowed(NPP);
+    // Plugin
+    static NPObject* pluginScriptableObject(Widget*);
+
+    // If memory usage is below this threshold, do not bother forcing GC.
+    static int lowMemoryUsageMB() { return 256; }
+
+    // If memory usage is above this threshold, force GC more aggressively.
+    static int highMemoryUsageMB() { return 1024; }
+
+    // Delta of memory usage growth (vs. last actualMemoryUsageMB()) to force GC when memory usage is high.
+    static int highUsageDeltaMB() { return 128; }
+};
+
+}
+#endif // PlatformBridge_h
diff --git a/Source/WebCore/platform/gtk/PlatformBridgeGtk.cpp b/Source/WebCore/platform/gtk/PlatformBridgeGtk.cpp
new file mode 100644
index 0000000..62065d7
--- /dev/null
+++ b/Source/WebCore/platform/gtk/PlatformBridgeGtk.cpp
@@ -0,0 +1,51 @@
+/*
+ * This file is part of the WebKit project.
+ *
+ * Copyright (C) 2010 Nokia Corporation and/or its subsidiary(-ies)
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Library General Public
+ * License as published by the Free Software Foundation; either
+ * version 2 of the License, or (at your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Library General Public License for more details.
+ *
+ * You should have received a copy of the GNU Library General Public License
+ * along with this library; see the file COPYING.LIB.  If not, write to
+ * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+ * Boston, MA 02110-1301, USA.
+ *
+ */
+#include "config.h"
+#include "PlatformBridge.h"
+
+#include "Frame.h"
+#include "PluginView.h"
+#include "Widget.h"
+
+namespace WebCore {
+
+bool PlatformBridge::popupsAllowed(NPP npp)
+{
+    if (npp && npp->ndata)
+        return static_cast<PluginView*>(npp->ndata)->arePopupsAllowed();
+
+    return false;
+}
+
+NPObject* PlatformBridge::pluginScriptableObject(Widget* widget)
+{
+    if (!widget)
+        return 0;
+
+    if (!widget->isPluginView())
+        return 0;
+
+    PluginView* pluginView = static_cast<PluginView*>(widget);
+    return pluginView->npObject();
+}
+
+}
diff --git a/Source/WebCore/platform/gtk/PlatformSupport.h b/Source/WebCore/platform/gtk/PlatformSupport.h
new file mode 100644
index 0000000..3fdacfe
--- /dev/null
+++ b/Source/WebCore/platform/gtk/PlatformSupport.h
@@ -0,0 +1,38 @@
+/*
+ * Copyright 2009, 2010, The Android Open Source Project
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *  * Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ *  * Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
+ * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
+ * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
+ * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
+ * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
+ * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+ * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
+
+#ifndef PlatformSupport_h
+#define PlatformSupport_h
+
+#include "PlatformBridge.h"
+
+namespace WebCore {
+
+typedef PlatformBridge PlatformSupport;
+
+}
+
+
+#endif
diff --git a/Source/WebCore/plugins/gtk/PluginViewGtk.cpp b/Source/WebCore/plugins/gtk/PluginViewGtk.cpp
index dbc374a..4173422 100644
--- a/Source/WebCore/plugins/gtk/PluginViewGtk.cpp
+++ b/Source/WebCore/plugins/gtk/PluginViewGtk.cpp
@@ -29,7 +29,10 @@
 #include "config.h"
 #include "PluginView.h"
 
+#if USE(JSC)
 #include "BridgeJSC.h"
+#endif
+
 #include "Document.h"
 #include "DocumentLoader.h"
 #include "Element.h"
@@ -59,11 +62,14 @@
 #include "RenderLayer.h"
 #include "Settings.h"
 #include "SpatialNavigation.h"
+
+#if USE(JSC)
 #include "JSDOMBinding.h"
 #include "npruntime_impl.h"
 #include "runtime_root.h"
 #include <runtime/JSLock.h>
 #include <runtime/JSValue.h>
+#endif
 
 #ifdef GTK_API_VERSION_2
 #include <gdkconfig.h>
@@ -83,11 +89,13 @@
 #include <gdk/gdkwin32.h>
 #endif
 
+#if USE(JSC)
 using JSC::ExecState;
 using JSC::Interpreter;
 using JSC::JSLock;
 using JSC::JSObject;
 using JSC::UString;
+#endif
 
 using std::min;
 
@@ -104,7 +112,9 @@ bool PluginView::dispatchNPEvent(NPEvent& event)
         return false;
 
     PluginView::setCurrentPluginView(this);
+#if USE(JSC)
     JSC::JSLock::DropAllLocks dropAllLocks(JSC::SilenceAssertionsOnly);
+#endif
     setCallingPlugin(true);
 
     bool accepted = !m_plugin->pluginFuncs()->event(m_instance, &event);
@@ -272,7 +282,9 @@ void PluginView::paint(GraphicsContext* context, const IntRect& rect)
 
 void PluginView::handleKeyboardEvent(KeyboardEvent* event)
 {
+#if USE(JSC)
     JSC::JSLock::DropAllLocks dropAllLocks(JSC::SilenceAssertionsOnly);
+#endif
 
     if (!m_isStarted || m_status != PluginStatusLoadedSuccessfully)
         return;
@@ -402,7 +414,9 @@ static void setXCrossingEventSpecificFields(XEvent* xEvent, MouseEvent* event, c
 
 void PluginView::handleMouseEvent(MouseEvent* event)
 {
+#if USE(JSC)
     JSC::JSLock::DropAllLocks dropAllLocks(JSC::SilenceAssertionsOnly);
+#endif
 
     if (!m_isStarted || m_status != PluginStatusLoadedSuccessfully)
         return;
@@ -528,7 +542,9 @@ void PluginView::setNPWindowIfNeeded()
     }
 
     PluginView::setCurrentPluginView(this);
+#if USE(JSC)
     JSC::JSLock::DropAllLocks dropAllLocks(JSC::SilenceAssertionsOnly);
+#endif
     setCallingPlugin(true);
     m_plugin->pluginFuncs()->setwindow(m_instance, &m_npWindow);
     setCallingPlugin(false);
@@ -831,7 +847,9 @@ bool PluginView::platformStart()
 #if defined(XP_UNIX)
     if (m_plugin->pluginFuncs()->getvalue) {
         PluginView::setCurrentPluginView(this);
+#if USE(JSC)
         JSC::JSLock::DropAllLocks dropAllLocks(JSC::SilenceAssertionsOnly);
+#endif
         setCallingPlugin(true);
         m_plugin->pluginFuncs()->getvalue(m_instance, NPPVpluginNeedsXEmbed, &m_needsXEmbed);
         setCallingPlugin(false);
diff --git a/Source/WebCore/websockets/CloseEvent.idl b/Source/WebCore/websockets/CloseEvent.idl
index 7ebca34..e8d6c93 100644
--- a/Source/WebCore/websockets/CloseEvent.idl
+++ b/Source/WebCore/websockets/CloseEvent.idl
@@ -33,8 +33,7 @@ module events {
     interface [
         NoStaticTables,
         CanBeConstructed,
-        CustomConstructFunction,
-        V8CustomConstructor
+        CustomConstructFunction
     ] CloseEvent : Event {
         readonly attribute boolean wasClean;
         readonly attribute unsigned short code;
diff --git a/Source/WebCore/workers/WorkerMessagingProxy.cpp b/Source/WebCore/workers/WorkerMessagingProxy.cpp
index ddb0619..a1447ed 100644
--- a/Source/WebCore/workers/WorkerMessagingProxy.cpp
+++ b/Source/WebCore/workers/WorkerMessagingProxy.cpp
@@ -353,19 +353,23 @@ void WorkerMessagingProxy::workerObjectDestroyed()
 }
 
 #if ENABLE(INSPECTOR)
+#if ENABLE(JAVASCRIPT_DEBUGGER)
 static void connectToWorkerContextInspectorTask(ScriptExecutionContext* context, bool)
 {
     ASSERT(context->isWorkerContext());
     static_cast<WorkerContext*>(context)->workerInspectorController()->connectFrontend();
 }
+#endif
 
 void WorkerMessagingProxy::connectToInspector(WorkerContextProxy::PageInspector* pageInspector)
 {
+#if ENABLE(JAVASCRIPT_DEBUGGER)
     if (m_askedToTerminate)
         return;
     ASSERT(!m_pageInspector);
     m_pageInspector = pageInspector;
     m_workerThread->runLoop().postTask(createCallbackTask(connectToWorkerContextInspectorTask, true));
+#endif
 }
 
 static void disconnectFromWorkerContextInspectorTask(ScriptExecutionContext* context, bool)
@@ -376,10 +380,12 @@ static void disconnectFromWorkerContextInspectorTask(ScriptExecutionContext* con
 
 void WorkerMessagingProxy::disconnectFromInspector()
 {
+#if ENABLE(JAVASCRIPT_DEBUGGER)
     m_pageInspector = 0;
     if (m_askedToTerminate)
         return;
     m_workerThread->runLoop().postTaskForMode(createCallbackTask(disconnectFromWorkerContextInspectorTask, true), WorkerScriptDebugServer::debuggerTaskMode);
+#endif
 }
 
 static void dispatchOnInspectorBackendTask(ScriptExecutionContext* context, const String& message)
@@ -390,9 +396,11 @@ static void dispatchOnInspectorBackendTask(ScriptExecutionContext* context, cons
 
 void WorkerMessagingProxy::sendMessageToInspector(const String& message)
 {
+#if ENABLE(JAVASCRIPT_DEBUGGER)
     if (m_askedToTerminate)
         return;
     m_workerThread->runLoop().postTaskForMode(createCallbackTask(dispatchOnInspectorBackendTask, String(message)), WorkerScriptDebugServer::debuggerTaskMode);
+#endif
 }
 #endif
 
diff --git a/Source/WebKit/gtk/ChangeLog b/Source/WebKit/gtk/ChangeLog
index 2ad4e2d..9a46165 100644
--- a/Source/WebKit/gtk/ChangeLog
+++ b/Source/WebKit/gtk/ChangeLog
@@ -1,3 +1,48 @@
+2011-10-03  Rémi Duraffort  <remi.duraffort@st.com>
+
+        Port V8 to WebKit-GTK
+        https://bugs.webkit.org/show_bug.cgi?id=32452
+
+        This is first of the patches to support building of V8 with
+        WebKit GTK. With this patch configure option is provided to
+        choose to compile either enable or diable SFX.
+
+        This work is also copyrighted to Nayan Kumar Konaje <nayankk@motorola.com>
+
+        Reviewed by NOBODY (OOPS!).
+
+        * GNUmakefile.am:
+        * WebCoreSupport/DumpRenderTreeSupportGtk.cpp:
+        (DumpRenderTreeSupportGtk::gcCollectJavascriptObjects):
+        (DumpRenderTreeSupportGtk::gcCollectJavascriptObjectsOnAlternateThread):
+        (DumpRenderTreeSupportGtk::gcCountJavascriptObjects):
+        * WebCoreSupport/DumpRenderTreeSupportGtk.h:
+        * WebCoreSupport/FrameLoaderClientGtk.cpp:
+        (WebKit::FrameLoaderClient::dispatchDidClearWindowObjectInWorld):
+        (WebKit::FrameLoaderClient::didCreateScriptContext):
+        (WebKit::FrameLoaderClient::willReleaseScriptContext):
+        (WebKit::FrameLoaderClient::allowScriptExtension):
+        * WebCoreSupport/FrameLoaderClientGtk.h:
+        * tests/testatk.c:
+        (atkAttributeSetContainsAttributeName):
+        * tests/testcopyandpaste.c:
+        (test_pasting_markup):
+        * tests/testdomdomwindow.c:
+        (load_event_callback):
+        (test_dom_domview_signals):
+        (load_status_callback):
+        * tests/testkeyevents.c:
+        (test_ime_load_status_cb):
+        (verify_contents):
+        * webkit/webkitglobals.cpp:
+        (webkitInit):
+        * webkit/webkitviewportattributes.cpp:
+        * webkit/webkitwebframe.cpp:
+        * webkit/webkitwebframe.h:
+        * webkit/webkitwebview.cpp:
+        (webkit_web_view_class_init):
+        * webkit/webkitwebview.h:
+
 2011-09-28  Martin Robinson  <mrobinson@igalia.com>
 
         [GTK] Move drag-and-drop code which can be shared with WebKit2 to WebCore
diff --git a/Source/WebKit/gtk/GNUmakefile.am b/Source/WebKit/gtk/GNUmakefile.am
index de0e860..ccb7a62 100644
--- a/Source/WebKit/gtk/GNUmakefile.am
+++ b/Source/WebKit/gtk/GNUmakefile.am
@@ -20,6 +20,11 @@ nodist_libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_
 libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_SOURCES = \
 	$(webkitgtk_sources)
 
+if USE_V8
+libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_SOURCES += \
+	$(javascriptcore_sources)
+endif
+
 libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_CXXFLAGS = \
 	$(SYMBOL_VISIBILITY_INLINES) \
 	$(global_cxxflags)
@@ -79,11 +84,18 @@ libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_LDFL
 	$(version_script) \
 	$(no_undefined)
 
+
 libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_LIBADD = \
 	-lpthread \
 	libWebCore.la \
-	libWebCoreGtk.la \
-	libjavascriptcoregtk-@WEBKITGTK_API_MAJOR_VERSION@.@WEBKITGTK_API_MINOR_VERSION@.la \
+	libWebCoreGtk.la
+
+if USE_JSC
+libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_LIBADD += \
+	libjavascriptcoregtk-@WEBKITGTK_API_MAJOR_VERSION@.@WEBKITGTK_API_MINOR_VERSION@.la
+endif # END USE_JSC
+
+libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_LIBADD += \
 	$(webcore_ldflags) \
 	$(CAIRO_LIBS) \
 	$(COVERAGE_LDFLAGS) \
@@ -111,6 +123,11 @@ libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_LIBA
 	$(OLE32_LIBS) \
 	$(ZLIB_LIBS)
 
+if USE_V8
+libwebkitgtk_@WEBKITGTK_API_MAJOR_VERSION@_@WEBKITGTK_API_MINOR_VERSION@_la_LIBADD += \
+	$(V8_LIBS)
+endif # END USE_V8
+
 webkitgtk_static_h_api += \
 	$(srcdir)/Source/WebKit/gtk/webkit/webkit.h \
 	$(srcdir)/Source/WebKit/gtk/webkit/webkitapplicationcache.h \
@@ -414,13 +431,23 @@ webkit_tests_cflags = \
 	$(GTK_CFLAGS) \
 	$(LIBSOUP_CFLAGS)
 
+#	libjavascriptcoregtk-@WEBKITGTK_API_MAJOR_VERSION@.@WEBKITGTK_API_MINOR_VERSION@.la
 webkit_tests_ldadd = \
-	libjavascriptcoregtk-@WEBKITGTK_API_MAJOR_VERSION@.@WEBKITGTK_API_MINOR_VERSION@.la \
 	libwebkitgtk-@WEBKITGTK_API_MAJOR_VERSION@.@WEBKITGTK_API_MINOR_VERSION@.la \
 	$(GTK_LIBS) \
 	$(GLIB_LIBS) \
 	$(LIBSOUP_LIBS)
 
+if USE_JSC
+webkit_tests_ldadd += \
+	libjavascriptcoregtk-@WEBKITGTK_API_MAJOR_VERSION@.@WEBKITGTK_API_MINOR_VERSION@.la
+endif # END USE_JSC
+
+if USE_V8
+webkit_tests_ldadd += \
+	$(V8_LIBS)
+endif # USE_V8
+
 webkit_tests_ldflags = \
 	-no-install \
 	-no-fast-install
diff --git a/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.cpp b/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.cpp
index a7fd85b..a6452f7 100644
--- a/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.cpp
+++ b/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.cpp
@@ -22,10 +22,10 @@
 #include "config.h"
 #include "DumpRenderTreeSupportGtk.h"
 
-#include "APICast.h"
 #include "AXObjectCache.h"
 #include "AccessibilityObjectWrapperAtk.h"
 #include "AnimationController.h"
+#include "DOMWindow.h"
 #include "DOMWrapperWorld.h"
 #include "Document.h"
 #include "EditorClientGtk.h"
@@ -34,16 +34,8 @@
 #include "FrameLoaderClientGtk.h"
 #include "FrameTree.h"
 #include "FrameView.h"
-#include "GCController.h"
 #include "GraphicsContext.h"
 #include "HTMLInputElement.h"
-#include "JSDOMWindow.h"
-#include "JSDocument.h"
-#include "JSElement.h"
-#include "JSLock.h"
-#include "JSNodeList.h"
-#include "JSRange.h"
-#include "JSValue.h"
 #include "NodeList.h"
 #include "PageGroup.h"
 #include "PlatformString.h"
@@ -61,14 +53,28 @@
 #include "webkitwebframeprivate.h"
 #include "webkitwebview.h"
 #include "webkitwebviewprivate.h"
+
+#if USE(JSC)
+#include "APICast.h"
+#include "GCController.h"
+#include "JSDOMWindow.h"
+#include "JSDocument.h"
+#include "JSElement.h"
+#include "JSLock.h"
+#include "JSNodeList.h"
+#include "JSRange.h"
+#include "JSValue.h"
 #include <JavaScriptCore/APICast.h>
+#endif // END USE_JSC
 
 #if ENABLE(SVG)
 #include "SVGDocumentExtensions.h"
 #include "SVGSMILElement.h"
 #endif
 
+#if USE(JSC)
 using namespace JSC;
+#endif // END USE_JSC
 using namespace WebCore;
 using namespace WebKit;
 
@@ -113,6 +119,7 @@ bool DumpRenderTreeSupportGtk::selectTrailingWhitespaceEnabled()
     return s_selectTrailingWhitespaceEnabled;
 }
 
+#if USE(JSC)
 JSValueRef DumpRenderTreeSupportGtk::nodesFromRect(JSContextRef context, JSValueRef value, int x, int y, unsigned top, unsigned right, unsigned bottom, unsigned left, bool ignoreClipping)
 {
     JSLock lock(SilenceAssertionsOnly);
@@ -142,6 +149,7 @@ WebKitDOMRange* DumpRenderTreeSupportGtk::jsValueToDOMRange(JSContextRef context
         return 0;
     return kit(range);
 }
+#endif
 
 /**
  * getFrameChildren:
@@ -405,6 +413,7 @@ bool DumpRenderTreeSupportGtk::pauseSVGAnimation(WebKitWebFrame* frame, const ch
 #endif
 }
 
+#if USE(JSC)
 CString DumpRenderTreeSupportGtk::markerTextForListItem(WebKitWebFrame* frame, JSContextRef context, JSValueRef nodeObject)
 {
     JSC::ExecState* exec = toJS(context);
@@ -414,6 +423,7 @@ CString DumpRenderTreeSupportGtk::markerTextForListItem(WebKitWebFrame* frame, J
 
     return WebCore::markerTextForListItem(element).utf8();
 }
+#endif
 
 unsigned int DumpRenderTreeSupportGtk::numberOfActiveAnimations(WebKitWebFrame* frame)
 {
@@ -675,18 +685,24 @@ void DumpRenderTreeSupportGtk::resetOriginAccessWhiteLists()
 
 void DumpRenderTreeSupportGtk::gcCollectJavascriptObjects()
 {
+#if USE(JSC)
     gcController().garbageCollectNow();
+#endif
 }
 
 void DumpRenderTreeSupportGtk::gcCollectJavascriptObjectsOnAlternateThread(bool waitUntilDone)
 {
+#if USE(JSC)
     gcController().garbageCollectOnAlternateThreadForDebugging(waitUntilDone);
+#endif
 }
 
 unsigned long DumpRenderTreeSupportGtk::gcCountJavascriptObjects()
 {
+#if USE(JSC)
     JSC::JSLock lock(JSC::SilenceAssertionsOnly);
     return JSDOMWindow::commonJSGlobalData()->heap.objectCount();
+#endif
 }
 
 void DumpRenderTreeSupportGtk::layoutFrame(WebKitWebFrame* frame)
@@ -776,6 +792,7 @@ void DumpRenderTreeSupportGtk::decrementAccessibilityValue(AtkObject* axObject)
     modifyAccessibilityValue(axObject, false);
 }
 
+#if USE(JSC)
 void DumpRenderTreeSupportGtk::setAutofilled(JSContextRef context, JSValueRef nodeObject, bool autofilled)
 {
     JSC::ExecState* exec = toJS(context);
@@ -804,6 +821,7 @@ void DumpRenderTreeSupportGtk::setValueForUser(JSContextRef context, JSValueRef
     JSStringGetUTF8CString(value, valueBuffer.get(), bufferSize);
     inputElement->setValueForUser(String::fromUTF8(valueBuffer.get()));
 }
+#endif
 
 void DumpRenderTreeSupportGtk::rectangleForSelection(WebKitWebFrame* frame, cairo_rectangle_int_t* rectangle)
 {
diff --git a/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.h b/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.h
index 1a203d5..228a42c 100644
--- a/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.h
+++ b/Source/WebKit/gtk/WebCoreSupport/DumpRenderTreeSupportGtk.h
@@ -19,7 +19,9 @@
 #ifndef DumpRenderTreeSupportGtk_h
 #define DumpRenderTreeSupportGtk_h
 
+#if USE(JSC)
 #include "JSStringRef.h"
+#endif
 #include <atk/atk.h>
 #include <glib.h>
 #include <webkit/webkitdefines.h>
@@ -54,13 +56,10 @@ public:
     static void setSelectTrailingWhitespaceEnabled(bool);
     static bool selectTrailingWhitespaceEnabled();
 
-    static JSValueRef nodesFromRect(JSContextRef context, JSValueRef value, int x, int y, unsigned top, unsigned right, unsigned bottom, unsigned left, bool ignoreClipping);
     static void dumpConfigurationForViewport(WebKitWebView* webView, gint deviceDPI, gint deviceWidth, gint deviceHeight, gint availableWidth, gint availableHeight);
 
     static void clearOpener(WebKitWebFrame*);
 
-    static WebKitDOMRange* jsValueToDOMRange(JSContextRef, JSValueRef);
-
     // FIXME: Move these to webkitwebframe.h once their API has been discussed.
     static GSList* getFrameChildren(WebKitWebFrame*);
     static WTF::CString getInnerText(WebKitWebFrame*);
@@ -76,7 +75,6 @@ public:
     static bool pauseAnimation(WebKitWebFrame*, const char* name, double time, const char* element);
     static bool pauseTransition(WebKitWebFrame*, const char* name, double time, const char* element);
     static bool pauseSVGAnimation(WebKitWebFrame*, const char* animationId, double time, const char* elementId);
-    static WTF::CString markerTextForListItem(WebKitWebFrame*, JSContextRef, JSValueRef nodeObject);
     static unsigned int numberOfActiveAnimations(WebKitWebFrame*);
     static void suspendAnimations(WebKitWebFrame*);
     static void resumeAnimations(WebKitWebFrame*);
@@ -84,9 +82,15 @@ public:
     static AtkObject* getFocusedAccessibleElement(WebKitWebFrame*);
     static AtkObject* getRootAccessibleElement(WebKitWebFrame*);
     static void layoutFrame(WebKitWebFrame*);
+    static bool shouldClose(WebKitWebFrame*);
+
+#if USE(JSC)
+    static JSValueRef nodesFromRect(JSContextRef, JSValueRef, int x, int y, unsigned top, unsigned right, unsigned bottom, unsigned left, bool ignoreClipping);
+    static WebKitDOMRange* jsValueToDOMRange(JSContextRef, JSValueRef);
+    static WTF::CString markerTextForListItem(WebKitWebFrame*, JSContextRef, JSValueRef nodeObject);
     static void setAutofilled(JSContextRef, JSValueRef, bool);
     static void setValueForUser(JSContextRef, JSValueRef, JSStringRef);
-    static bool shouldClose(WebKitWebFrame*);
+#endif
 
     // WebKitWebView
     static void executeCoreCommandByName(WebKitWebView*, const gchar* name, const gchar* value);
diff --git a/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.cpp b/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.cpp
index e9dc122..2204e41 100644
--- a/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.cpp
+++ b/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.cpp
@@ -49,8 +49,6 @@
 #include "HTMLFrameOwnerElement.h"
 #include "HTMLNames.h"
 #include "HTMLPlugInElement.h"
-#include "JSDOMBinding.h"
-#include "JSDOMWindow.h"
 #include "Language.h"
 #include "MIMETypeRegistry.h"
 #include "MouseEvent.h"
@@ -87,7 +85,6 @@
 #include "webkitwebsettingsprivate.h"
 #include "webkitwebview.h"
 #include "webkitwebviewprivate.h"
-#include <JavaScriptCore/APICast.h>
 #include <gio/gio.h>
 #include <glib.h>
 #include <glib/gi18n-lib.h>
@@ -95,6 +92,12 @@
 #include <wtf/text/CString.h>
 #include <wtf/text/StringConcatenate.h>
 
+#if USE(JSC)
+#include "JSDOMBinding.h"
+#include "JSDOMWindow.h"
+#include <JavaScriptCore/APICast.h>
+#endif // END USE_JSC
+
 using namespace WebCore;
 
 namespace WebKit {
@@ -637,12 +640,14 @@ void FrameLoaderClient::dispatchDidClearWindowObjectInWorld(DOMWrapperWorld* wor
 
     // TODO: Consider using g_signal_has_handler_pending() to avoid the overhead
     // when there are no handlers.
+#if USE(JSC)
     JSGlobalContextRef context = toGlobalRef(coreFrame->script()->globalObject(mainThreadNormalWorld())->globalExec());
     JSObjectRef windowObject = toRef(coreFrame->script()->globalObject(mainThreadNormalWorld()));
     ASSERT(windowObject);
 
     WebKitWebView* webView = getViewFromFrame(m_frame);
     g_signal_emit_by_name(webView, "window-object-cleared", m_frame, context, windowObject);
+#endif // USE_JSC
 
     // TODO: Re-attach debug clients if present.
     // The Win port has an example of how we might do this.
@@ -1299,4 +1304,18 @@ PassRefPtr<FrameNetworkingContext> FrameLoaderClient::createNetworkingContext()
     return FrameNetworkingContextGtk::create(core(m_frame));
 }
 
+#if USE(V8)
+void FrameLoaderClient::didCreateScriptContext(v8::Handle<v8::Context>, int worldId)
+{
+}
+
+void FrameLoaderClient::willReleaseScriptContext(v8::Handle<v8::Context>, int worldId)
+{
+}
+
+bool FrameLoaderClient::allowScriptExtension(const String& extensionName, int extensionGroup)
+{
+}
+#endif // END USE_V8
+
 }
diff --git a/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.h b/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.h
index 446f8ba..3922aa1 100644
--- a/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.h
+++ b/Source/WebKit/gtk/WebCoreSupport/FrameLoaderClientGtk.h
@@ -189,6 +189,12 @@ namespace WebKit {
 
         virtual PassRefPtr<WebCore::FrameNetworkingContext> createNetworkingContext();
 
+#if USE(V8)
+        virtual void didCreateScriptContext(v8::Handle<v8::Context>, int worldId);
+        virtual void willReleaseScriptContext(v8::Handle<v8::Context>, int worldId);
+        virtual bool allowScriptExtension(const String& extensionName, int extensionGroup);
+#endif
+
     private:
         WebKitWebFrame* m_frame;
         WebCore::ResourceResponse m_response;
diff --git a/Source/WebKit/gtk/tests/testatk.c b/Source/WebKit/gtk/tests/testatk.c
index 603c6c8..ab98bd0 100644
--- a/Source/WebKit/gtk/tests/testatk.c
+++ b/Source/WebKit/gtk/tests/testatk.c
@@ -931,7 +931,7 @@ static gboolean atkAttributeSetContainsAttributeName(AtkAttributeSet* set, const
 {
     AtkAttribute at;
     at.name = (gchar*)attributeName;
-    return g_slist_find_custom(set, &at, (GCompareFunc)compAtkAttributeName) ? true : false;
+    return g_slist_find_custom(set, &at, (GCompareFunc)compAtkAttributeName) ? TRUE : FALSE;
 }
 
 static gboolean atkAttributeSetAttributeHasValue(AtkAttributeSet* set, AtkTextAttribute attribute, const gchar* value)
diff --git a/Source/WebKit/gtk/tests/testcopyandpaste.c b/Source/WebKit/gtk/tests/testcopyandpaste.c
index 1b5fb7b..c6114c6 100644
--- a/Source/WebKit/gtk/tests/testcopyandpaste.c
+++ b/Source/WebKit/gtk/tests/testcopyandpaste.c
@@ -22,8 +22,11 @@
 #include <string.h>
 #include <glib/gstdio.h>
 #include <webkit/webkit.h>
+
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 #include <JavaScriptCore/JSStringRef.h>
 #include <JavaScriptCore/JSContextRef.h>
+#endif
 
 #if GTK_CHECK_VERSION(2, 14, 0)
 
@@ -134,7 +137,9 @@ static void test_copy_and_paste(CopyAndPasteFixture* fixture, gconstpointer data
     g_main_loop_run(fixture->loop);
 }
 
+
 static CopyAndPasteFixture* currentFixture;
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 static JSValueRef runPasteTestCallback(JSContextRef context, JSObjectRef function, JSObjectRef thisObject, size_t argumentCount, const JSValueRef arguments[], JSValueRef* exception)
 {
     // Simulate a paste keyboard sequence.
@@ -176,7 +181,9 @@ static JSValueRef runPasteTestCallback(JSContextRef context, JSObjectRef functio
     g_main_loop_quit(currentFixture->loop);
     return JSValueMakeUndefined(context);
 }
+#endif
 
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 static void window_object_cleared_callback(WebKitWebView* web_view, WebKitWebFrame* web_frame, JSGlobalContextRef context, JSObjectRef window_object, gpointer data)
 {
     JSStringRef name = JSStringCreateWithUTF8CString("runTest");
@@ -184,6 +191,7 @@ static void window_object_cleared_callback(WebKitWebView* web_view, WebKitWebFra
     JSObjectSetProperty(context, window_object, name, testComplete, kJSPropertyAttributeNone, 0);
     JSStringRelease(name);
 }
+#endif
 
 static void pasting_test_get_data_callback(GtkClipboard* clipboard, GtkSelectionData* selection_data, guint info, gpointer data)
 {
@@ -197,6 +205,7 @@ static void pasting_test_clear_data_callback(GtkClipboard* clipboard, gpointer d
 
 static void test_pasting_markup(CopyAndPasteFixture* fixture, gconstpointer data)
 {
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
     fixture->info = (TestInfo*)data;
     currentFixture = fixture;
 
@@ -223,6 +232,7 @@ static void test_pasting_markup(CopyAndPasteFixture* fixture, gconstpointer data
     gtk_window_present(GTK_WINDOW(fixture->window));
 
     g_main_loop_run(fixture->loop);
+#endif
 }
 
 
diff --git a/Source/WebKit/gtk/tests/testdomdomwindow.c b/Source/WebKit/gtk/tests/testdomdomwindow.c
index 0d93408..72b33d4 100644
--- a/Source/WebKit/gtk/tests/testdomdomwindow.c
+++ b/Source/WebKit/gtk/tests/testdomdomwindow.c
@@ -105,7 +105,7 @@ static void load_event_callback(WebKitWebView* webView, GParamSpec* spec, DomDom
 {
     WebKitLoadStatus status = webkit_web_view_get_load_status(webView);
     if (status == WEBKIT_LOAD_FINISHED) {
-        webkit_dom_event_target_add_event_listener(WEBKIT_DOM_EVENT_TARGET(fixture->domWindow), "click", G_CALLBACK(clickedCallback), false, fixture);
+        webkit_dom_event_target_add_event_listener(WEBKIT_DOM_EVENT_TARGET(fixture->domWindow), "click", G_CALLBACK(clickedCallback), FALSE, fixture);
 
         g_assert(fixture->clicked == FALSE);
         gtk_test_widget_click(GTK_WIDGET(fixture->webView), 1, 0);
@@ -125,7 +125,7 @@ static void test_dom_domview_signals(DomDomviewFixture* fixture, gconstpointer d
 
     fixture->domWindow = domWindow;
 
-    webkit_dom_event_target_add_event_listener(WEBKIT_DOM_EVENT_TARGET(fixture->domWindow), "load", G_CALLBACK(loadedCallback), false, fixture);
+    webkit_dom_event_target_add_event_listener(WEBKIT_DOM_EVENT_TARGET(fixture->domWindow), "load", G_CALLBACK(loadedCallback), FALSE, fixture);
     g_signal_connect(fixture->window, "map-event", G_CALLBACK(map_event_cb), fixture);
     g_signal_connect(fixture->webView, "notify::load-status", G_CALLBACK(load_event_callback), fixture);
 
@@ -176,7 +176,7 @@ static void load_status_callback(WebKitWebView* webView, GParamSpec* spec, DomDo
                                                 fixture->domWindow, 0, 0, 0, clientX, clientY,
                                                 FALSE, FALSE, FALSE, FALSE,
                                                 1, WEBKIT_DOM_EVENT_TARGET(element));
-        webkit_dom_event_target_add_event_listener(WEBKIT_DOM_EVENT_TARGET(element), "click", G_CALLBACK(clicked_cb), false, fixture);
+        webkit_dom_event_target_add_event_listener(WEBKIT_DOM_EVENT_TARGET(element), "click", G_CALLBACK(clicked_cb), FALSE, fixture);
         g_assert(fixture->clicked == FALSE);
         webkit_dom_event_target_dispatch_event(WEBKIT_DOM_EVENT_TARGET(element), event, NULL);
     }
diff --git a/Source/WebKit/gtk/tests/testkeyevents.c b/Source/WebKit/gtk/tests/testkeyevents.c
index b41a032..d0c0688 100644
--- a/Source/WebKit/gtk/tests/testkeyevents.c
+++ b/Source/WebKit/gtk/tests/testkeyevents.c
@@ -22,8 +22,11 @@
 #include <string.h>
 #include <glib/gstdio.h>
 #include <webkit/webkit.h>
+
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 #include <JavaScriptCore/JSStringRef.h>
 #include <JavaScriptCore/JSContextRef.h>
+#endif
 
 
 #if GTK_CHECK_VERSION(2, 14, 0)
@@ -146,6 +149,7 @@ static void test_keypress_events(KeyEventFixture* fixture, gconstpointer data)
     setup_keyevent_test(fixture, data, G_CALLBACK(test_keypress_events_load_status_cb));
 }
 
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 static gboolean element_text_equal_to(JSContextRef context, const gchar* text)
 {
     JSStringRef scriptString = JSStringCreateWithUTF8CString(
@@ -175,9 +179,11 @@ static gboolean element_text_equal_to(JSContextRef context, const gchar* text)
     g_free(cString);
     return result;
 }
+#endif
 
 static void test_ime_load_status_cb(WebKitWebView* webView, GParamSpec* spec, gpointer data)
 {
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
     KeyEventFixture* fixture = (KeyEventFixture*)data;
     WebKitLoadStatus status = webkit_web_view_get_load_status(webView);
     if (status != WEBKIT_LOAD_FINISHED)
@@ -204,6 +210,7 @@ static void test_ime_load_status_cb(WebKitWebView* webView, GParamSpec* spec, gp
 
     g_object_unref(imContext);
     g_main_loop_quit(fixture->loop);
+#endif
 }
 
 static void test_ime(KeyEventFixture* fixture, gconstpointer data)
@@ -213,6 +220,7 @@ static void test_ime(KeyEventFixture* fixture, gconstpointer data)
 
 static gboolean verify_contents(gpointer data)
 {
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
     KeyEventFixture* fixture = (KeyEventFixture*)data;
     JSGlobalContextRef context = webkit_web_frame_get_global_context(
         webkit_web_view_get_main_frame(fixture->webView));
@@ -221,6 +229,7 @@ static gboolean verify_contents(gpointer data)
     g_assert(element_text_equal_to(context, fixture->info->text));
     g_main_loop_quit(fixture->loop);
     return FALSE;
+#endif
 }
 
 static void test_blocking_load_status_cb(WebKitWebView* webView, GParamSpec* spec, gpointer data)
diff --git a/Source/WebKit/gtk/webkit/webkitglobals.cpp b/Source/WebKit/gtk/webkit/webkitglobals.cpp
index 439c23c..1ceb99a 100644
--- a/Source/WebKit/gtk/webkit/webkitglobals.cpp
+++ b/Source/WebKit/gtk/webkit/webkitglobals.cpp
@@ -307,7 +307,12 @@ void webkitInit()
     bindtextdomain(GETTEXT_PACKAGE, PACKAGE_LOCALE_DIR);
     bind_textdomain_codeset(GETTEXT_PACKAGE, "UTF-8");
 
+#if USE(JSC)
     JSC::initializeThreading();
+#endif
+#if USE(V8)
+    WTF::initializeThreading();
+#endif
     WTF::initializeMainThread();
 
     WebCore::InitializeLoggingChannelsIfNecessary();
diff --git a/Source/WebKit/gtk/webkit/webkitviewportattributes.cpp b/Source/WebKit/gtk/webkit/webkitviewportattributes.cpp
index 742cddd..db5ceac 100644
--- a/Source/WebKit/gtk/webkit/webkitviewportattributes.cpp
+++ b/Source/WebKit/gtk/webkit/webkitviewportattributes.cpp
@@ -22,6 +22,7 @@
 #include "webkitviewportattributes.h"
 
 #include "Chrome.h"
+#include "Document.h"
 #include "Frame.h"
 #include "Page.h"
 #include "webkitglobalsprivate.h"
diff --git a/Source/WebKit/gtk/webkit/webkitwebframe.cpp b/Source/WebKit/gtk/webkit/webkitwebframe.cpp
index cb6667a..a449e73 100644
--- a/Source/WebKit/gtk/webkit/webkitwebframe.cpp
+++ b/Source/WebKit/gtk/webkit/webkitwebframe.cpp
@@ -39,13 +39,9 @@
 #include "FrameSelection.h"
 #include "FrameTree.h"
 #include "FrameView.h"
-#include "GCController.h"
 #include "GraphicsContext.h"
 #include "GtkVersioning.h"
 #include "HTMLFrameOwnerElement.h"
-#include "JSDOMBinding.h"
-#include "JSDOMWindow.h"
-#include "JSElement.h"
 #include "PlatformContextCairo.h"
 #include "PrintContext.h"
 #include "RenderListItem.h"
@@ -66,11 +62,18 @@
 #include "webkitwebframeprivate.h"
 #include "webkitwebview.h"
 #include "webkitwebviewprivate.h"
-#include <JavaScriptCore/APICast.h>
 #include <atk/atk.h>
 #include <glib/gi18n-lib.h>
 #include <wtf/text/CString.h>
 
+#if USE(JSC)
+#include "GCController.h"
+#include "JSDOMBinding.h"
+#include "JSDOMWindow.h"
+#include "JSElement.h"
+#include <JavaScriptCore/APICast.h>
+#endif // END USE_JSC
+
 #if ENABLE(SVG)
 #include "SVGSMILElement.h"
 #endif
@@ -694,6 +697,7 @@ WebKitWebFrame* webkit_web_frame_find_frame(WebKitWebFrame* frame, const gchar*
     return kit(coreFrame->tree()->find(AtomicString(nameString)));
 }
 
+#if USE(JSC)
 /**
  * webkit_web_frame_get_global_context:
  * @frame: a #WebKitWebFrame
@@ -713,6 +717,7 @@ JSGlobalContextRef webkit_web_frame_get_global_context(WebKitWebFrame* frame)
 
     return toGlobalRef(coreFrame->script()->globalObject(mainThreadNormalWorld())->globalExec());
 }
+#endif // END USE_JSC
 
 /**
  * webkit_web_frame_get_data_source:
diff --git a/Source/WebKit/gtk/webkit/webkitwebframe.h b/Source/WebKit/gtk/webkit/webkitwebframe.h
index 012f8a8..a46203d 100644
--- a/Source/WebKit/gtk/webkit/webkitwebframe.h
+++ b/Source/WebKit/gtk/webkit/webkitwebframe.h
@@ -24,7 +24,9 @@
 #include <glib-object.h>
 #include <gtk/gtk.h>
 
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 #include <JavaScriptCore/JSBase.h>
+#endif
 
 #include <webkit/webkitdefines.h>
 #include <webkit/webkitdomdefines.h>
@@ -143,8 +145,10 @@ WEBKIT_API WebKitWebFrame *
 webkit_web_frame_find_frame         (WebKitWebFrame       *frame,
                                      const gchar          *name);
 
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 WEBKIT_API JSGlobalContextRef
 webkit_web_frame_get_global_context (WebKitWebFrame       *frame);
+#endif
 
 WEBKIT_API GtkPrintOperationResult
 webkit_web_frame_print_full         (WebKitWebFrame       *frame,
diff --git a/Source/WebKit/gtk/webkit/webkitwebview.cpp b/Source/WebKit/gtk/webkit/webkitwebview.cpp
index e0456f3..ed5947e 100644
--- a/Source/WebKit/gtk/webkit/webkitwebview.cpp
+++ b/Source/WebKit/gtk/webkit/webkitwebview.cpp
@@ -1096,10 +1096,12 @@ static WebKitNavigationResponse webkit_web_view_real_navigation_requested(WebKit
     return WEBKIT_NAVIGATION_RESPONSE_ACCEPT;
 }
 
+#if USE(JSC)
 static void webkit_web_view_real_window_object_cleared(WebKitWebView*, WebKitWebFrame*, JSGlobalContextRef context, JSObjectRef window_object)
 {
     notImplemented();
 }
+#endif // END USE_JSC
 
 static gchar* webkit_web_view_real_choose_file(WebKitWebView*, WebKitWebFrame*, const gchar* old_name)
 {
@@ -1840,6 +1842,7 @@ static void webkit_web_view_class_init(WebKitWebViewClass* webViewClass)
             G_TYPE_STRING,
             WEBKIT_TYPE_WEB_POLICY_DECISION);
 
+#if USE(JSC)
     /**
      * WebKitWebView::window-object-cleared:
      * @webView: the object on which the signal is emitted
@@ -1865,6 +1868,7 @@ static void webkit_web_view_class_init(WebKitWebViewClass* webViewClass)
             WEBKIT_TYPE_WEB_FRAME,
             G_TYPE_POINTER,
             G_TYPE_POINTER);
+#endif // END USE_JSC
 
     /**
      * WebKitWebView::download-requested:
@@ -2659,7 +2663,9 @@ static void webkit_web_view_class_init(WebKitWebViewClass* webViewClass)
     webViewClass->web_view_ready = webkit_web_view_real_web_view_ready;
     webViewClass->close_web_view = webkit_web_view_real_close_web_view;
     webViewClass->navigation_requested = webkit_web_view_real_navigation_requested;
+#if USE(JSC)
     webViewClass->window_object_cleared = webkit_web_view_real_window_object_cleared;
+#endif // END USE_JSC
     webViewClass->choose_file = webkit_web_view_real_choose_file;
     webViewClass->script_alert = webkit_web_view_real_script_alert;
     webViewClass->script_confirm = webkit_web_view_real_script_confirm;
diff --git a/Source/WebKit/gtk/webkit/webkitwebview.h b/Source/WebKit/gtk/webkit/webkitwebview.h
index 9bb80e8..efdd01f 100644
--- a/Source/WebKit/gtk/webkit/webkitwebview.h
+++ b/Source/WebKit/gtk/webkit/webkitwebview.h
@@ -24,7 +24,10 @@
 
 #include <gtk/gtk.h>
 #include <libsoup/soup.h>
+
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
 #include <JavaScriptCore/JSBase.h>
+#endif
 
 #include <webkit/webkitdefines.h>
 #include <webkit/webkitdom.h>
@@ -105,10 +108,12 @@ struct _WebKitWebViewClass {
     WebKitNavigationResponse   (* navigation_requested)   (WebKitWebView        *web_view,
                                                            WebKitWebFrame       *frame,
                                                            WebKitNetworkRequest *request);
+#if defined(WTF_USE_JSC) && WTF_USE_JSC == 1
     void                       (* window_object_cleared)  (WebKitWebView        *web_view,
                                                            WebKitWebFrame       *frame,
                                                            JSGlobalContextRef    context,
                                                            JSObjectRef           window_object);
+#endif
     gchar                    * (* choose_file)            (WebKitWebView        *web_view,
                                                            WebKitWebFrame       *frame,
                                                            const gchar          *old_file);
diff --git a/Tools/ChangeLog b/Tools/ChangeLog
index 98c48b2..b7e4c9c 100644
--- a/Tools/ChangeLog
+++ b/Tools/ChangeLog
@@ -1,3 +1,18 @@
+2011-10-05  Rémi Duraffort  <remi.duraffort@st.com>
+
+        Port V8 to WebKit-GTK
+        https://bugs.webkit.org/show_bug.cgi?id=32452
+
+        This is first of the patches to support building of V8 with
+        WebKit GTK. With this patch configure option is provided to
+        choose to compile either enable or diable SFX.
+
+        This work is also copyrighted to Nayan Kumar Konaje <nayankk@motorola.com>
+
+        Reviewed by NOBODY (OOPS!).
+
+        * GNUmakefile.am:
+
 2011-10-05  David Levin  <levin@chromium.org>
 
         watchlist: Add more rules for chromium public api and sort the file.
diff --git a/Tools/GNUmakefile.am b/Tools/GNUmakefile.am
index 0c22006..a8bfc96 100644
--- a/Tools/GNUmakefile.am
+++ b/Tools/GNUmakefile.am
@@ -1,7 +1,11 @@
 noinst_PROGRAMS += \
-	Programs/DumpRenderTree \
 	Programs/GtkLauncher
 
+if USE_JSC
+noinst_PROGRAMS += \
+	Programs/DumpRenderTree
+endif # END USE_JSC
+
 if ENABLE_WEBKIT2
 noinst_PROGRAMS += \
 	Programs/GtkLauncher2
@@ -28,6 +32,11 @@ gtklauncher_ldadd = \
 	$(LIBSOUP_LIBS) \
 	$(WINMM_LIBS)
 
+if USE_V8
+gtklauncher_ldadd += \
+	$(V8_LIBS)
+endif # END USE_V8
+
 gtklauncher_ldflags = \
 	-no-fast-install \
 	-no-install
@@ -90,16 +99,23 @@ endif
 # to prefer the WebCore config.h over the DumpRenderTree config.h
 noinst_LTLIBRARIES += libWebCoreInternals.la
 libWebCoreInternals_la_SOURCES = \
+	Source/WebCore/testing/Internals.cpp \
+	Source/WebCore/testing/Internals.h
+
+if USE_JSC
+libWebCoreInternals_la_SOURCES += \
 	Source/WebCore/bindings/js/JSDOMWrapper.cpp \
 	Source/WebCore/bindings/js/JSDOMWrapper.h \
-	Source/WebCore/testing/Internals.cpp \
-	Source/WebCore/testing/Internals.h \
 	Source/WebCore/testing/js/WebCoreTestSupport.cpp \
 	Source/WebCore/testing/js/WebCoreTestSupport.h
+endif # END USE_JSC
 
+if USE_JSC
 libwebcoreinternals_built_sources += \
 	DerivedSources/WebCore/JSInternals.cpp \
 	DerivedSources/WebCore/JSInternals.h
+endif # END USE_JSC
+
 nodist_libWebCoreInternals_la_SOURCES = $(libwebcoreinternals_built_sources)
 BUILT_SOURCES += $(libwebcoreinternals_built_sources)
 
@@ -122,6 +138,7 @@ libWebCoreInternals_la_CFLAGS = \
 	$(javascriptcore_cflags)
 
 # DumpRenderTree
+if USE_JSC
 Programs_DumpRenderTree_CPPFLAGS = \
 	$(global_cppflags) \
 	-I$(srcdir)/Tools/DumpRenderTree \
@@ -213,6 +230,7 @@ Programs_DumpRenderTree_LDADD = \
 Programs_DumpRenderTree_LDFLAGS = \
 	-no-fast-install \
 	-no-install
+endif # END USE_JSC
 
 # clean target
 CLEANFILES += \
diff --git a/configure.ac b/configure.ac
index c0eb29e..657aca2 100644
--- a/configure.ac
+++ b/configure.ac
@@ -430,14 +430,6 @@ AC_ARG_ENABLE(progress_tag,
               [],[enable_progress_tag="yes"])
 AC_MSG_RESULT([$enable_progress_tag])
 
-# check whether to enable JavaScript debugger/profiler support
-AC_MSG_CHECKING([whether to enable JavaScript debugger/profiler support])
-AC_ARG_ENABLE(javascript_debugger,
-              AC_HELP_STRING([--enable-javascript-debugger],
-                             [enable JavaScript debugger/profiler support [default=yes]]),
-              [],[enable_javascript_debugger="yes"])
-AC_MSG_RESULT([$enable_javascript_debugger])
-
 # check whether to enable Gamepad support
 AC_MSG_CHECKING([whether to enable Gamepad support])
 AC_ARG_ENABLE(gamepad,
@@ -793,50 +785,89 @@ AC_ARG_ENABLE(debug_features,
               [],[if test "$enable_debug" = "yes"; then enable_debug_features="yes"; else enable_debug_features="no"; fi])
 AC_MSG_RESULT([$enable_debug_features])
 
-AC_MSG_CHECKING([whether to enable JIT compilation])
-AC_ARG_ENABLE([jit],
-              AC_HELP_STRING([--enable-jit],
-                             [Enable JIT compilation default=yes]),
-              [],[enable_jit="yes"])
-if test "$enable_jit" = "yes"; then
-    case "$host_cpu" in
-        arm*)
-            AC_DEFINE([ENABLE_JIT], [1], [Define to enable JIT])
-            AC_DEFINE([ENABLE_YARR], [1], [Define to enable YARR])
-            AC_DEFINE([ENABLE_YARR_JIT], [1], [Define to enable YARR JIT])
-        ;;
-        i*86|x86_64)
-            AC_DEFINE([ENABLE_JIT], [1], [Define to enable JIT])
-            AC_DEFINE([ENABLE_YARR], [1], [Define to enable YARR])
-            AC_DEFINE([ENABLE_YARR_JIT], [1], [Define to enable YARR JIT])
-            AC_DEFINE([ENABLE_JIT_OPTIMIZE_CALL], [1], [Define to enable optimizing calls])
-            AC_DEFINE([ENABLE_JIT_OPTIMIZE_PROPERTY_ACCESS], [1], [Define to enable optimized property access])
-            AC_DEFINE([ENABLE_JIT_OPTIMIZE_ARITHMETIC], [1], [Define to enable optimized arithmetic])
-            case "$host_cpu" in
-                i*86)
-                    AC_DEFINE([WTF_USE_JIT_STUB_ARGUMENT_VA_LIST], [1], [Use stub va_list])
-                ;;
-                x86_64)
-                    AC_DEFINE([WTF_USE_JIT_STUB_ARGUMENT_REGISTER], [1], [Use stub register])
-                    AC_DEFINE([WTF_USE_ALTERNATE_JSIMMEDIATE], [1], [Use alternate JSImmediate])
-                ;;
-            esac
-        ;;
-        sh4)
-            AC_DEFINE([ENABLE_YARR], [1], [Define to enable YARR])
-            AC_DEFINE([ENABLE_YARR_JIT], [1], [Define to enable YARR JIT])
-            AC_DEFINE([ENABLE_JIT], [1], [Define to enable JIT])
-            AC_DEFINE([WTF_USE_JIT_STUB_ARGUMENT_REGISTER], [1], [Use stub register])
-        ;;
-        *)
-            enable_jit="no (CPU '$host_cpu' not supported)"
-        ;;
-    esac
+# Determine JavaScript engine to use.
+AC_MSG_CHECKING([JavaScript engine])
+AC_ARG_WITH(jsengine,
+            AC_HELP_STRING([--with-jsengine=@<:@jsc/v8@:>@],
+                           [Select Javascript engine [default=jsc]]),
+            [],[with_jsengine="jsc"])
+
+case "$with_jsengine" in
+    jsc|v8);;
+    *) AC_MSG_ERROR([Invalid JS engine: Muist be jsc or v8]) ;;
+esac
+AC_MSG_RESULT([$with_jsengine])
+
+# check whether to enable JavaScript debugger/profiler support
+if test "$with_jsengine" = "jsc"; then
+AC_MSG_CHECKING([whether to enable JavaScript debugger/profiler support])
+AC_ARG_ENABLE(javascript_debugger,
+              AC_HELP_STRING([--enable-javascript-debugger],
+                             [enable JavaScript debugger/profiler support [default=yes]]),
+              [],[enable_javascript_debugger="yes"])
+AC_MSG_RESULT([$enable_javascript_debugger])
 else
-        AC_DEFINE([ENABLE_JIT], [0], [Define to enable JIT])
+    enable_javascript_debugger="no"
+fi
+
+
+if test "$with_jsengine" = "jsc"; then
+    AC_MSG_CHECKING([whether to enable JIT compilation])
+    AC_ARG_ENABLE([jit],
+                  AC_HELP_STRING([--enable-jit],
+                                 [Enable JIT compilation default=yes]),
+                  [],[enable_jit="yes"])
+    if test "$enable_jit" = "yes"; then
+        case "$host_cpu" in
+            arm*)
+                AC_DEFINE([ENABLE_JIT], [1], [Define to enable JIT])
+                AC_DEFINE([ENABLE_YARR], [1], [Define to enable YARR])
+                AC_DEFINE([ENABLE_YARR_JIT], [1], [Define to enable YARR JIT])
+            ;;
+            i*86|x86_64)
+                AC_DEFINE([ENABLE_JIT], [1], [Define to enable JIT])
+                AC_DEFINE([ENABLE_YARR], [1], [Define to enable YARR])
+                AC_DEFINE([ENABLE_YARR_JIT], [1], [Define to enable YARR JIT])
+                AC_DEFINE([ENABLE_JIT_OPTIMIZE_CALL], [1], [Define to enable optimizing calls])
+                AC_DEFINE([ENABLE_JIT_OPTIMIZE_PROPERTY_ACCESS], [1], [Define to enable optimized property access])
+                AC_DEFINE([ENABLE_JIT_OPTIMIZE_ARITHMETIC], [1], [Define to enable optimized arithmetic])
+                case "$host_cpu" in
+                    i*86)
+                        AC_DEFINE([WTF_USE_JIT_STUB_ARGUMENT_VA_LIST], [1], [Use stub va_list])
+                    ;;
+                    x86_64)
+                        AC_DEFINE([WTF_USE_JIT_STUB_ARGUMENT_REGISTER], [1], [Use stub register])
+                        AC_DEFINE([WTF_USE_ALTERNATE_JSIMMEDIATE], [1], [Use alternate JSImmediate])
+                    ;;
+                esac
+            ;;
+            sh4)
+                AC_DEFINE([ENABLE_YARR], [1], [Define to enable YARR])
+                AC_DEFINE([ENABLE_YARR_JIT], [1], [Define to enable YARR JIT])
+                AC_DEFINE([ENABLE_JIT], [1], [Define to enable JIT])
+                AC_DEFINE([WTF_USE_JIT_STUB_ARGUMENT_REGISTER], [1], [Use stub register])
+            ;;
+            *)
+                enable_jit="no (CPU '$host_cpu' not supported)"
+            ;;
+        esac
+    else
+            AC_DEFINE([ENABLE_JIT], [0], [Define to enable JIT])
+    fi
+else
+    AC_DEFINE([ENABLE_JIT], [0], [Define to enable JIT])
+    enable_jit="no"
 fi
 AC_MSG_RESULT([$enable_jit])
 
+# Add V8 compiler flags and linker flags
+if test "$with_jsengine" = "v8"; then
+  V8_CPPFLAGS="-I\$(top_srcdir)/v8/include"
+  V8_LIBS="-L\$(top_srcdir)/v8/usr/lib -lv8"
+  AC_SUBST([V8_CPPFLAGS])
+  AC_SUBST([V8_LIBS])
+fi
+
 # Opcode stats
 AC_MSG_CHECKING([whether to enable opcode stats])
 AC_ARG_ENABLE([opcode-stats],
@@ -1063,6 +1094,7 @@ AC_ARG_ENABLE(webkit2,
     AC_HELP_STRING([--enable-webkit2], [build webkit2 [default=no]]),
     [], [enable_webkit2="no"])
 AC_MSG_RESULT([$enable_webkit2])
+enable_webkit2='no'
 if test "$enable_webkit2" = "yes"; then
    if test "$GTK_API_VERSION" = "2.0"; then
       AC_MSG_ERROR([WebKit2 requires GTK+ 3.x, use --with-gtk=3.0])
@@ -1103,6 +1135,10 @@ AM_CONDITIONAL([TARGET_WIN32], [test "$with_target" = "win32"])
 AM_CONDITIONAL([TARGET_QUARTZ], [test "$with_target" = "quartz"])
 AM_CONDITIONAL([TARGET_DIRECTFB], [test "$with_target" = "directfb"])
 
+# JS engine conditionals
+AM_CONDITIONAL([USE_JSC], [test "$with_jsengine" = "jsc"])
+AM_CONDITIONAL([USE_V8], [test "$with_jsengine" = "v8"])
+
 # Unicode backend conditionals
 AM_CONDITIONAL([USE_ICU_UNICODE], [test "$with_unicode_backend" = "icu"])
 AM_CONDITIONAL([USE_GLIB_UNICODE], [test "$with_unicode_backend" = "glib"])
@@ -1226,6 +1262,7 @@ Build configuration:
  Unicode backend                                          : $with_unicode_backend
  Font backend                                             : $with_font_backend
  Optimized memory allocator                               : $enable_fast_malloc
+ JavaScript Engine                                        : $with_jsengine
 Features:
  3D Rendering                                             : $enable_3d_rendering
  WebGL                                                    : $enable_webgl
-- 
1.7.8.2

